<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Brand Health Tracker 2024 - Tracking Report</title>
  <meta name="turas-report-type" content="tracker"/>
  <meta name="turas-generated" content="2026-02-26T17:45:11"/>
  <meta name="turas-metrics" content="18"/>
  <meta name="turas-waves" content="4"/>
  <meta name="turas-segments" content="4"/>
  <meta name="turas-baseline-label" content="Jan 2024"/>
  <meta name="turas-latest-label" content="Oct 2024"/>
  <style>:root{--brand:#323367;--accent:#CC9900;--ct-brand:#323367;--ct-accent:#CC9900;--ct-text-primary:#1e293b;--ct-text-secondary:#64748b;--ct-bg-surface:#ffffff;--ct-bg-muted:#f8f9fa;--ct-border:#e2e8f0;--bg:#f8f7f5;--card:#ffffff;--text:#1e293b;--text-muted:#64748b;--border:#e2e8f0;--section-bg:#f8f9fa;--change-bg:#fafafa;--sidebar-w:280px}*{box-sizing:border-box;margin:0;padding:0}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text);font-size:14px;line-height:1.5}.tk-header{background:linear-gradient(135deg,#1a2744 0%,#2a3f5f 100%);padding:24px 32px;border-bottom:3px solid var(--brand);color:#fff}.tk-header-inner{max-width:1400px;margin:0 auto}.tk-header-top{display:flex;align-items:center;justify-content:space-between}.tk-header-brand{display:flex;align-items:center;gap:16px}.tk-header-logo-wrap{width:72px;height:72px;border-radius:12px;background:transparent;display:flex;align-items:center;justify-content:center;flex-shrink:0}.tk-header-logo{height:56px;width:56px;object-fit:contain}.tk-brand-name{color:#fff;font-size:28px;font-weight:700;line-height:1.2;letter-spacing:-0.3px}.tk-brand-subtitle{color:rgba(255,255,255,0.50);font-size:12px;font-weight:400;margin-top:2px}.tk-help-btn{width:28px;height:28px;border-radius:50%;border:1.5px solid rgba(255,255,255,0.5);background:transparent;color:rgba(255,255,255,0.8);font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center}.tk-help-btn:hover{border-color:#fff;color:#fff}.tk-header-project{color:#fff;font-size:22px;font-weight:700;letter-spacing:-0.3px;margin-top:16px;line-height:1.2}.tk-header-prepared{color:rgba(255,255,255,0.65);font-size:13px;font-weight:400;margin-top:4px}.tk-header-prepared strong{font-weight:600}.tk-badge-bar{display:inline-flex;align-items:center;margin-top:12px;border:1px solid rgba(255,255,255,0.15);border-radius:6px;background:rgba(255,255,255,0.05)}.tk-badge-item{display:inline-flex;align-items:center;padding:4px 12px;font-size:12px;font-weight:600;color:rgba(255,255,255,0.85)}.tk-badge-item strong{color:#fff;font-weight:700;margin-right:4px}.tk-badge-sep{width:1px;height:16px;background:rgba(255,255,255,0.20);flex-shrink:0}.report-tabs{display:flex;align-items:center;gap:0;background:var(--card);border-bottom:2px solid var(--border);padding:0 24px}.report-tab{padding:12px 24px;border:none;background:transparent;color:var(--text);font-size:14px;font-weight:600;cursor:pointer;font-family:inherit;border-bottom:3px solid transparent;transition:all 0.15s}.report-tab:hover:not(.active){background:#f8f8f8;color:var(--brand)}.report-tab.active{color:var(--brand);border-bottom-color:var(--brand)}.pin-count-badge{display:inline-block;margin-left:6px;padding:1px 7px;border-radius:10px;background:var(--brand);color:#fff;font-size:11px;font-weight:700}.tk-tab-actions{display:flex;gap:8px;align-items:center;padding:6px 0}.tk-tab-panels{min-height:calc(100vh - 180px)}.tab-panel{display:none}.tab-panel.active{display:block}.summary-tab-content{max-width:900px;margin:0 auto;padding:32px 24px}.summary-stats-row{display:flex;gap:16px;margin-bottom:32px;flex-wrap:wrap}.summary-stat-card{flex:1;min-width:140px;background:var(--card);border:1px solid var(--border);border-radius:8px;padding:20px 16px;text-align:center}.stat-number{font-size:28px;font-weight:700;color:var(--brand)}.stat-label{font-size:13px;color:var(--text-muted);margin-top:4px}.summary-insight-box{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:20px 24px;margin-bottom:20px;position:relative}.summary-insight-title{font-size:16px;font-weight:700;color:var(--brand);margin-bottom:12px}.summary-editor{min-height:80px}.summary-section-controls{float:right;display:flex;gap:6px}.dash-section{margin-bottom:24px}.dash-section-title{font-size:16px;font-weight:700;color:var(--brand);margin-bottom:4px}.dash-section-sub{font-size:12px;color:#64748b;margin-bottom:12px}.dash-sig-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}.dash-sig-card{background:#fff;border-radius:8px;border:1px solid #e2e8f0;padding:12px 16px;border-left:3px solid #059669}.dash-sig-badges{display:flex;gap:6px;margin-bottom:4px;flex-wrap:wrap}.dash-sig-metric-badge{font-size:9px;font-weight:700;padding:2px 6px;border-radius:3px;background:rgba(26,39,68,0.06);color:#1a2744;letter-spacing:0.5px}.dash-sig-group-badge{font-size:9px;font-weight:600;padding:2px 6px;border-radius:3px;background:rgba(13,138,138,0.08);color:var(--brand)}.dash-sig-segment-badge{font-size:9px;font-weight:600;padding:2px 6px;border-radius:3px;background:rgba(100,116,139,0.08);color:#64748b}.dash-sig-text{font-size:12px;color:#1e293b;line-height:1.4}.dash-sig-empty{padding:16px 20px;font-size:13px;color:#94a3b8;font-style:italic;text-align:center;background:#f8fafc;border-radius:8px;border:1px dashed #e2e8f0}@media (max-width:768px){.dash-sig-grid{grid-template-columns:1fr}}.turas-action-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;font-size:12px;font-weight:600;color:var(--brand);background:rgba(13,138,138,0.06);border:1px solid rgba(13,138,138,0.2);border-radius:6px;cursor:pointer;transition:all 0.15s;font-family:inherit;white-space:nowrap}.turas-action-btn:hover{background:rgba(13,138,138,0.12);border-color:var(--brand)}.metrics-tab-layout{display:flex;min-height:calc(100vh - 180px)}.mv-sidebar{width:var(--sidebar-w);flex-shrink:0;padding:16px 0 0 0}.mv-sidebar-inner{position:sticky;top:20px}.mv-sidebar-search{padding:0 14px 12px}.tk-search-input{width:100%;padding:10px 14px;border:1px solid var(--border);border-radius:6px;font-size:13px;background:var(--card);outline:none;transition:border-color 0.15s;font-family:inherit}.tk-search-input:focus{border-color:var(--brand)}.mv-sidebar-nav-wrap{background:var(--card);border-radius:8px;border:1px solid var(--border);overflow:hidden}.mv-sidebar-nav-header{padding:10px 14px;border-bottom:1px solid var(--border);font-size:11px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px}.mv-sidebar-nav-scroll{max-height:500px;overflow-y:auto}.mv-sidebar-nav{padding:0}.mv-nav-section{padding:10px 14px 4px;font-size:11px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px}.tk-metric-nav-item{display:block;padding:10px 14px;font-size:12px;color:var(--text);text-decoration:none;cursor:pointer;border-left:3px solid transparent;border-bottom:1px solid var(--border);transition:all 0.15s ease;line-height:1.35}.tk-metric-nav-item:last-child{border-bottom:none}.tk-metric-nav-item:hover{background:#f8fafc}.tk-metric-nav-item.active{border-left-color:var(--brand);background:#e6f5f5;font-weight:600;color:#1a2744}.mv-type-filter{display:flex;gap:4px;padding:8px 12px;border-bottom:1px solid var(--border);flex-wrap:wrap}.mv-type-chip{padding:3px 10px;border:1.5px solid var(--border);background:var(--card);border-radius:12px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.15s;color:var(--text-muted);font-family:inherit}.mv-type-chip:hover{border-color:var(--brand)}.mv-type-chip.active{border-color:var(--brand);color:var(--brand);background:#e6f5f5}.mv-global-controls{padding:10px 16px;border-bottom:1px solid var(--border)}.mv-content{flex:1;padding:24px;overflow-x:auto}.tk-metric-panel{display:none}.tk-metric-panel.active{display:block}.mv-metric-title{font-size:16px;font-weight:700;color:var(--text);margin-bottom:4px}.mv-metric-subtitle{font-size:13px;font-weight:400;color:var(--text-muted)}.mv-segment-chips{display:flex;align-items:center;gap:6px;padding:8px 12px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;margin:12px 0 8px;flex-wrap:wrap}.mv-segment-chips-label{font-size:11px;font-weight:600;color:#64748b;margin-right:4px;white-space:nowrap}.tk-segment-chip{padding:4px 10px;border:1px solid #e2e8f0;border-radius:16px;background:#f0fafa;color:#1e293b;font-size:11px;font-weight:500;cursor:pointer;transition:all 0.15s;font-family:inherit}.tk-segment-chip.active{border-color:var(--chip-color,var(--brand));color:var(--chip-color,var(--brand));background:#f0fafa;font-weight:600}.tk-segment-chip:not(.active){background:#f1f5f9;color:#94a3b8;text-decoration:line-through;opacity:0.6}.tk-segment-chip:not(.active):hover{opacity:0.8}.tk-segment-chip:hover{border-color:var(--chip-color,var(--brand))}.mv-segment-grouped{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.mv-segment-group{display:none;align-items:center;gap:4px}.mv-segment-chips.groups-visible .mv-segment-group{display:flex}.mv-groups-toggle{padding:4px 10px;border:1px dashed #cbd5e1;border-radius:16px;background:transparent;color:#94a3b8;font-size:11px;font-weight:500;cursor:pointer;transition:all 0.15s;font-family:inherit}.mv-groups-toggle:hover{border-color:var(--brand);color:var(--brand)}.mv-groups-toggle.open{border-style:solid;border-color:var(--brand);color:var(--brand);background:#f0fafa}.mv-segment-group-header{padding:4px 10px;border:1px solid #e2e8f0;background:var(--ct-bg-muted);border-radius:6px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-muted);cursor:pointer;transition:all 0.15s;font-family:inherit}.mv-segment-group-header:hover{border-color:var(--brand);color:var(--brand)}.mv-segment-group-header.active{background:#e6f5f5;border-color:var(--brand);color:var(--brand)}.mv-segment-group-header .chevron{display:inline-block;font-size:8px;margin-left:3px;transition:transform 0.15s}.mv-segment-group.expanded .mv-segment-group-header .chevron{transform:rotate(90deg)}.mv-segment-group-chips{display:none;gap:6px;flex-wrap:wrap}.mv-segment-group.expanded .mv-segment-group-chips{display:flex}.mv-wave-chips{display:flex;align-items:center;gap:6px;padding:8px 12px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;margin:0 0 12px;flex-wrap:wrap}.mv-wave-chips-label{font-size:11px;font-weight:600;color:#64748b;margin-right:4px;white-space:nowrap}.tk-wave-chip{padding:4px 10px;border:1px solid #e2e8f0;border-radius:16px;background:#f0f6ff;color:#1e293b;font-size:11px;font-weight:500;cursor:pointer;transition:all 0.15s;font-family:inherit}.tk-wave-chip.active{border-color:#4682B4;color:#4682B4;background:#f0f6ff;font-weight:600}.tk-wave-chip:not(.active){background:#f1f5f9;color:#94a3b8;text-decoration:line-through;opacity:0.6}.tk-wave-chip:not(.active):hover{opacity:0.8}.tk-wave-chip:hover{border-color:#4682B4}.mv-chart-segment-chips{display:flex;align-items:center;gap:6px;padding:8px 12px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;margin:0 0 12px;flex-wrap:wrap}.mv-chart-segment-chips .mv-wave-chips-label{color:var(--brand);font-size:11px;font-weight:600}.tk-sig{display:inline-block;font-size:9px;font-weight:700;border-radius:3px;padding:0 3px;margin-left:3px;vertical-align:middle;font-family:ui-monospace,Consolas,monospace}.tk-sig-up{color:#059669 !important;background:rgba(5,150,105,0.08)}.tk-sig-down{color:#c0392b !important;background:rgba(192,57,43,0.08)}.tk-legend{font-size:11px;color:#64748b;padding:8px 0;display:flex;gap:16px;flex-wrap:wrap}.tk-legend-item{display:inline-flex;align-items:center;gap:4px}.legend-box{margin-top:16px;background:#ffffff;border-radius:8px;border:1px solid #e2e8f0;padding:14px}.legend-title{font-size:11px;font-weight:600;color:#64748b;letter-spacing:1px;text-transform:uppercase;margin-bottom:10px}.legend-item{display:flex;align-items:center;gap:8px;font-size:12px;margin-bottom:6px}.mv-controls{display:flex;align-items:center;gap:16px;flex-wrap:wrap;margin-bottom:16px}.mv-control-group{display:flex;align-items:center;gap:8px}.mv-pin-btn{margin-left:auto}.mv-pin-btn.pinned{background:var(--brand);color:#fff;border-color:var(--brand)}.mv-table-area{margin-bottom:16px}.mv-chart-area{margin-top:12px;margin-bottom:16px;width:100%}.tk-layout{display:flex;min-height:calc(100vh - 180px)}.tk-sidebar{width:var(--sidebar-w);flex-shrink:0;padding:16px 0 0 14px}.tk-sidebar-inner{position:sticky;top:20px}.tk-sidebar-nav-card{background:var(--card);border-radius:8px;border:1px solid var(--border);overflow:hidden}.tk-sidebar-nav-scroll{max-height:500px;overflow-y:auto}.tk-sidebar-nav{padding:0}.tk-sidebar-section{padding:10px 14px 4px;font-size:11px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px;cursor:pointer;transition:color 0.15s ease}.tk-sidebar-section:hover{color:var(--brand)}.tk-sidebar-section.active{color:var(--brand)}.tk-sidebar-item{display:block;padding:10px 14px;font-size:12px;color:var(--text);text-decoration:none;cursor:pointer;border-left:3px solid transparent;border-bottom:1px solid var(--border);transition:all 0.15s ease}.tk-sidebar-item:last-child{border-bottom:none}.tk-sidebar-item:hover{background:#f8fafc}.tk-sidebar-item.active{border-left-color:var(--brand);background:#e6f5f5;font-weight:600;color:#1a2744}.tk-sidebar-item.hidden{display:none}.tk-content{flex:1;padding:20px 24px;overflow-x:auto}.tk-segment-selector{display:none}.tk-seg-sidebar-item{display:flex;align-items:center;gap:8px}.overview-actions-bar{display:flex;gap:8px;margin-bottom:12px;padding:10px 0}.tk-sidebar-header{padding:10px 14px;font-size:11px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px;border-bottom:1px solid var(--border)}.summary-metrics-table-wrap{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:24px;margin-bottom:20px;overflow-x:auto}.summary-metrics-table{font-size:13px;color:#1e293b}.summary-metrics-table .tk-section-cell{font-size:11px;text-transform:uppercase;letter-spacing:0.5px;color:#888;padding:12px 16px 4px;border:none;background:none}.summary-type-filter{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px}.summary-type-chip{padding:5px 14px;border-radius:16px;border:1px solid var(--border);background:var(--card);font-size:12px;cursor:pointer;color:var(--text-muted);transition:all 0.15s}.summary-type-chip:hover{border-color:var(--brand);color:var(--brand)}.summary-type-chip.active{background:var(--brand);color:#fff;border-color:var(--brand)}.summary-actions{display:flex;gap:8px;margin-bottom:12px}.tk-controls{display:flex;align-items:center;gap:16px;flex-wrap:wrap;margin-bottom:16px;padding:10px 16px;background:var(--card);border-radius:8px;border:1px solid var(--border)}.tk-control-group{display:flex;align-items:center;gap:8px}.tk-control-label{font-size:12px;color:var(--text-muted);font-weight:600}.tk-toggle{display:flex;align-items:center;gap:6px;cursor:pointer;font-size:12px;color:var(--text-muted)}.tk-toggle input[type="checkbox"]{width:16px;height:16px;accent-color:var(--brand)}.tk-toggle-label{user-select:none}.tk-btn{padding:6px 14px;border:1px solid var(--border);background:var(--card);border-radius:6px;font-size:12px;cursor:pointer;transition:all 0.15s;font-family:inherit}.tk-btn:hover{background:#f0f0f0}.tk-btn-view{border-radius:0}.tk-btn-view:first-child{border-radius:6px 0 0 6px}.tk-btn-view:last-child{border-radius:0 6px 6px 0}.tk-btn-active{background:var(--brand);color:#fff;border-color:var(--brand)}.tk-btn-sm{padding:4px 10px;font-size:11px}.tk-btn-export{background:#f8f8f8}.tk-select{padding:6px 10px;border:1px solid var(--border);border-radius:6px;font-size:12px;background:var(--card)}.tk-export-group{margin-left:auto}.export-btn{display:inline-flex;align-items:center;gap:4px;padding:6px 14px;border:1px solid var(--border);border-radius:4px;background:#ffffff;color:var(--text-muted);font-size:11px;font-weight:600;cursor:pointer;font-family:inherit;transition:all 0.15s;white-space:nowrap}.export-btn:hover{background:#f8fafc;color:var(--text)}.tk-header-actions{display:flex;align-items:center;gap:8px}.tk-header .export-btn{border-color:rgba(255,255,255,0.3);color:rgba(255,255,255,0.85);background:rgba(255,255,255,0.08)}.tk-header .export-btn:hover{border-color:rgba(255,255,255,0.6);color:#fff;background:rgba(255,255,255,0.15)}.tk-low-base{color:#dc2626;font-weight:700}.tk-low-base-dim{color:#94a3b8 !important}.tk-low-base-dim .tk-val{color:#94a3b8 !important}.tk-segment-showing{font-size:14px;color:var(--text);margin-bottom:8px;padding:4px 0}.tk-segment-showing strong{color:var(--brand)}.tk-segment-indicator-row{}.tk-segment-indicator{padding:4px 8px;border:none}.tk-table-wrapper{overflow-x:auto;border-radius:8px;border:1px solid var(--border);background:var(--card)}.tk-table{width:100%;border-collapse:collapse;color:#1e293b;font-size:13px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.tk-table td,.tk-table th{font-family:inherit}.tk-th{padding:8px 10px;text-align:center;font-size:11px;font-weight:600;color:#64748b;border-bottom:2px solid var(--border);white-space:normal;min-width:80px;max-width:160px;vertical-align:bottom;background:var(--ct-bg-muted)}.tk-td{padding:6px 10px;text-align:center;border-bottom:1px solid #f0f0f0;font-size:13px;color:#1e293b;transition:background-color 0.15s}.tk-label-col{text-align:left;min-width:180px;max-width:320px;white-space:normal;word-wrap:break-word}.tk-td.tk-label-col{font-weight:500;color:#1e293b}.tk-sticky-col{position:sticky;left:0;z-index:2;background:var(--card)}.tk-segment-header{font-size:12px;letter-spacing:0.3px}.tk-wave-header{font-size:12px;color:#64748b;background:var(--ct-bg-muted)}.tk-value-cell{font-variant-numeric:tabular-nums;color:#1e293b;font-size:13px}.tk-val{font-variant-numeric:tabular-nums;color:#1e293b;font-size:13px}.tk-section-row{background:none}.tk-section-cell{padding:14px 16px 8px;font-size:13px;font-weight:700;color:var(--brand);text-transform:uppercase;letter-spacing:0.5px;background:var(--section-bg);border-bottom:2px solid var(--border);cursor:pointer;user-select:none}.tk-section-cell:hover{background:#eef0f2}.section-chevron{display:inline-block;font-size:10px;transition:transform 0.15s;margin-right:4px}.section-collapsed .section-chevron{transform:rotate(-90deg)}tr.section-hidden{display:none !important}.tk-metric-row{transition:background 0.15s}.tk-metric-row:hover{background:#f8fafa}.tk-metric-label{font-weight:600;margin-right:8px}.tk-sparkline-wrap{display:inline-block;vertical-align:middle;margin-left:4px}.tk-change-row{display:none;background:var(--change-bg)}.tk-change-row.visible{display:table-row}.tk-change-label{font-size:11px;color:#64748b;font-style:italic;padding-left:24px}.tk-change-cell{font-size:12px;color:#1e293b}.change-val{font-size:12px;white-space:nowrap;color:#1e293b}.sig-up{color:#1e293b}.sig-down{color:#1e293b}.not-sig{color:#1e293b}.sig-flat{color:#1e293b}.sig-na{color:#1e293b}.sig-arrow{display:inline-block;font-size:9px;font-weight:700;border-radius:3px;padding:0 3px;margin-left:3px;vertical-align:middle;font-family:ui-monospace,Consolas,monospace}.sig-up .sig-arrow{color:#059669;background:rgba(5,150,105,0.08)}.sig-down .sig-arrow{color:#c0392b;background:rgba(192,57,43,0.08)}.not-sig .sig-arrow{color:#94a3b8;background:rgba(148,163,184,0.08)}.sig-flat .sig-arrow{color:#94a3b8;background:rgba(148,163,184,0.08)}.sig-na .sig-arrow{color:#cbd5e1;background:rgba(203,213,225,0.08)}body.hide-significance .sig-arrow{display:none}.tk-base-row{border-top:2px solid var(--border);background:#fafbfc}.tk-table .tk-base-row td{font-weight:600;color:#64748b;font-size:11px;border-bottom:2px solid var(--border)}.tk-base-label{font-size:11px;color:#64748b;font-weight:600}.tk-base-cell{font-size:11px;color:#64748b}.tk-table tbody tr:last-child td{border-bottom:2px solid #e2e8f0;padding-bottom:8px}.tk-freq{display:none;font-size:10px;color:#94a3b8;margin-top:1px}.show-freq .tk-freq{display:block}.tk-seg-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px;vertical-align:middle}.tk-sortable{cursor:pointer;user-select:none}.tk-sortable:hover{background:#f0fafa}.tk-sortable.sort-asc::after{content:" \25B2";font-size:9px;color:var(--brand)}.tk-sortable.sort-desc::after{content:" \25BC";font-size:9px;color:var(--brand)}.wave-hidden{display:none !important}.tk-sparkline{vertical-align:middle}body.hide-sparklines .tk-sparkline-wrap{display:none}.tk-chart-panel{padding:16px 0}.tk-chart-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;padding:8px 0}.tk-chart-count{font-size:14px;font-weight:600;color:var(--text)}.tk-chart-header-actions{display:flex;gap:8px}.tk-chart-container{margin-bottom:32px;padding:20px;background:var(--card);border-radius:8px;border:1px solid var(--border)}.tk-chart-title{font-size:15px;font-weight:600;margin-bottom:12px;color:var(--text);display:flex;align-items:center;gap:8px}.tk-chart-remove-btn{background:none;border:1px solid var(--border);border-radius:50%;width:22px;height:22px;font-size:14px;cursor:pointer;color:var(--text-muted);line-height:1}.tk-chart-remove-btn:hover{background:#fee;color:#dc2626;border-color:#dc2626}.tk-chart-actions{margin-top:12px;text-align:right}.tk-line-chart{width:100%;height:auto;display:block}.tk-chart-point{cursor:pointer}.tk-add-chart-btn{background:none;border:1px solid var(--border);border-radius:4px;padding:2px 6px;font-size:11px;cursor:pointer;color:var(--text-muted);margin-left:6px;transition:all 0.15s}.tk-add-chart-btn:hover{border-color:var(--brand);color:var(--brand)}.tk-add-chart-btn.in-chart{background:var(--brand);color:#fff;border-color:var(--brand)}.row-filtered{display:none !important}.tk-latest-wave{background:rgba(30,41,59,0.03)}.tk-table thead{position:sticky;top:0;z-index:10}.tk-table thead th{background:var(--card)}.tk-overview-search{width:140px;padding:5px 10px;border:1px solid var(--border);border-radius:6px;font-size:12px;font-family:inherit}.tk-overview-type-filter{display:flex;gap:4px}.segment-hidden{display:none !important}.tk-segment-chip.selected{box-shadow:0 0 0 2px var(--chip-color,var(--brand))}.tk-row-hide-btn{background:none;border:none;cursor:pointer;font-size:14px;padding:0 4px;opacity:0.3;transition:opacity 0.15s;line-height:1}.tk-row-hide-btn:hover{opacity:1}.tk-row-hide-btn.row-greyed{opacity:1;color:#c0392b}.tk-metric-row.row-hidden-user{opacity:0.25}.tk-metric-row.row-hidden-user td{background:#f5f5f5 !important}.tk-change-row.row-hidden-user{opacity:0.25}.tk-change-row.row-hidden-user td{background:#f5f5f5 !important}.pinned-toolbar{display:flex;gap:8px;padding:16px 0;margin-bottom:16px;border-bottom:1px solid var(--border);flex-wrap:wrap}.pinned-toolbar .tk-btn{font-size:13px;padding:8px 16px}.insight-area{margin-top:16px}.insight-toggle{padding:6px 14px;border:1px dashed #cbd5e1;border-radius:6px;background:transparent;color:#94a3b8;font-size:12px;font-weight:500;cursor:pointer;width:100%;text-align:left;font-family:inherit}.insight-toggle:hover{border-color:var(--brand);color:var(--brand)}.insight-container{border:1px solid var(--border);border-radius:8px;background:#f8fafa;padding:12px 16px;position:relative}.insight-editor{border-left:3px solid var(--brand);background:#fefefe;padding:12px 16px;font-size:13px;line-height:1.6;border-radius:0 6px 6px 0;min-height:50px;outline:none;color:var(--text)}.insight-editor:empty::before{content:attr(data-placeholder);color:#aab;font-style:italic}.insight-dismiss{position:absolute;top:8px;right:8px;background:none;border:none;font-size:20px;cursor:pointer;color:var(--text-muted);line-height:1}.insight-dismiss:hover{color:#c0392b}.section-divider{display:flex;align-items:center;gap:12px;padding:12px 0;margin:8px 0;border-bottom:2px solid var(--brand)}.section-divider-title{font-size:16px;font-weight:600;color:var(--brand);flex:1;outline:none;min-width:100px}.section-divider-title:focus{border-bottom:1px dashed var(--border)}.section-divider-actions{display:flex;gap:4px}.pinned-tab-content{padding:24px;max-width:1000px;margin:0 auto}.pinned-empty-state{text-align:center;padding:60px 20px;color:var(--text-muted);font-size:15px}.pinned-card{background:var(--card);border:1px solid var(--border);border-radius:8px;margin-bottom:20px;overflow:hidden}.pinned-card-header{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;border-bottom:1px solid var(--border);background:var(--ct-bg-muted)}.pinned-card-title{font-size:15px;font-weight:700;color:var(--text);margin:0}.pinned-card-actions{display:flex;gap:6px}.pinned-card-chart{padding:16px 20px;border-bottom:1px solid var(--border);text-align:center}.pinned-card-chart svg{max-width:100%;height:auto}.pinned-card-body{padding:24px 28px;overflow-x:auto}.pinned-card-body .tk-table-wrapper{border:none;margin:8px 0}.pinned-card-png{max-width:100%;height:auto;border-radius:4px}.pinned-card-insight{padding:16px 24px;border-bottom:1px solid var(--border);background:linear-gradient(135deg,#f0f5f5 0%,#f8fafa 100%);border-left:4px solid var(--brand);font-size:15px;font-weight:600;color:#1a2744;line-height:1.5}.pinned-card-insight-area{padding:0;border-bottom:1px solid var(--border);background:linear-gradient(135deg,#f0f5f5 0%,#f8fafa 100%);border-left:4px solid var(--brand)}.pinned-card-insight-editor{background:transparent;padding:16px 24px;font-size:15px;font-weight:600;line-height:1.5;border-radius:0;border-left:none;min-height:36px;outline:none;color:#1a2744}.pinned-card-insight-editor:empty::before{content:attr(data-placeholder);color:#aab;font-style:italic}.pinned-insight-toggle{padding:4px 10px;border:1px dashed #cbd5e1;border-radius:4px;background:transparent;color:#94a3b8;font-size:11px;cursor:pointer;width:100%;text-align:left;font-family:inherit}.pinned-insight-toggle:hover{border-color:var(--brand);color:var(--brand)}.pinned-card-meta{padding:8px 20px;font-size:11px;color:var(--text-muted);border-top:1px solid #f0f0f0}.tk-help-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;display:flex;align-items:center;justify-content:center}.tk-help-content{background:var(--card);border-radius:12px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto;padding:32px;position:relative}.tk-help-close{position:absolute;top:12px;right:16px;background:none;border:none;font-size:24px;cursor:pointer;color:var(--text-muted)}.tk-help-body h3{margin:16px 0 6px;font-size:14px;color:var(--brand)}.tk-help-body p{color:var(--text-muted);font-size:13px}.tk-help-body ul{margin-left:20px;color:var(--text-muted);font-size:13px}.tk-footer{padding:16px 24px;border-top:1px solid var(--border);background:var(--card);display:flex;flex-direction:column;align-items:center;gap:6px;font-size:12px;color:var(--text-muted)}.tk-footer-sig-info{font-size:10px;color:#94a3b8;text-align:center}.tk-footer-info{display:flex;align-items:center;flex-wrap:wrap;justify-content:center}.tk-footer-sep{margin:0 6px;opacity:0.4}.tk-footer-credit{font-style:italic;font-size:11px}@media print{.tk-sidebar,.mv-sidebar,.tk-controls,.mv-controls,.tk-segment-tabs,.tk-chart-actions,.tk-help-overlay,.report-tabs,.mv-segment-chips,.insight-toggle,.insight-dismiss,.mv-pin-btn,.pinned-card-actions,.pinned-toolbar,.tk-segment-selector,.tk-row-hide-btn,.tk-tab-actions,.export-btn,.turas-action-btn{display:none !important}.tk-layout,.metrics-tab-layout{display:block}.tk-content,.mv-content{padding:0}.tk-table-wrapper{border:none;overflow:visible}.tk-sticky-col{position:static}.tk-change-row.visible{display:table-row !important}.tab-panel{display:block !important;page-break-before:always}.tab-panel:first-child{page-break-before:auto}.tk-header{padding:8px 16px;-webkit-print-color-adjust:exact;print-color-adjust:exact}.tk-footer{position:fixed;bottom:0}}@media print{body.print-pinned-only .tk-header,body.print-pinned-only .report-tabs,body.print-pinned-only .tab-panel:not(#tab-pinned),body.print-pinned-only .tk-footer{display:none !important}body.print-pinned-only #tab-pinned{display:block !important;page-break-before:auto}body.print-pinned-only .pinned-card{page-break-inside:avoid;margin-bottom:24px}body.print-pinned-only .pinned-card-chart svg{max-width:100%;height:auto}}</style>
</head>
<body style="background:#f8f7f5">
<header class="tk-header">
  <div class="tk-header-inner">
    <div class="tk-header-top">
      <div class="tk-header-brand">
        
        <div>
          <div class="tk-brand-name">Turas Tracker</div>
          <div class="tk-brand-subtitle">Interactive Tracking Report</div>
        </div>
      </div>
      <div class="tk-header-actions">
        <button class="tk-help-btn" onclick="toggleHelpOverlay()">?</button>
      </div>
    </div>
    <div class="tk-header-project">Brand Health Tracker 2024</div>
    <div class="tk-header-prepared">Prepared by <strong>The Research LampPost</strong> for <strong>Test Client Ltd</strong></div>
    <div class="tk-badge-bar"> <span class="tk-badge-item"><strong>18</strong> Metrics</span><span class="tk-badge-sep"></span><span class="tk-badge-item"><strong>4</strong> Waves</span><span class="tk-badge-sep"></span><span class="tk-badge-item"><strong>4</strong> Segments</span><span class="tk-badge-sep"></span><span class="tk-badge-item" id="header-date-badge">Created Feb 2026</span> </div>
  </div>
</header>
<div class="report-tabs">
  <button class="report-tab active" onclick="switchReportTab(&#39;summary&#39;)" data-tab="summary">Summary</button>
  <button class="report-tab" onclick="switchReportTab(&#39;metrics&#39;)" data-tab="metrics">Metrics by Segment</button>
  <button class="report-tab" onclick="switchReportTab(&#39;overview&#39;)" data-tab="overview">Segment Overview</button>
  <button class="report-tab" onclick="switchReportTab(&#39;pinned&#39;)" data-tab="pinned">
    Pinned Views
    <span class="pin-count-badge" id="pin-count-badge" style="display:none">0</span>
  </button>
  <div style="flex:1"></div>
  <div class="tk-tab-actions">
    <button class="export-btn" onclick="saveReportHTML()">ðŸ’¾ Save Report</button>
    <button class="export-btn" onclick="printReport()">ðŸ–¨ Print</button>
  </div>
</div>
<div class="tk-tab-panels" data-report-module="tracker">
  <div id="tab-summary" class="tab-panel active">
    <div class="summary-tab-content">
      <div class="summary-stats-row">
        <div class="summary-stat-card">
          <div class="stat-number">18</div>
          <div class="stat-label">Metrics</div>
        </div>
        <div class="summary-stat-card">
          <div class="stat-number">4</div>
          <div class="stat-label">Waves</div>
        </div>
        <div class="summary-stat-card">
          <div class="stat-number">4</div>
          <div class="stat-label">Segments</div>
        </div>
        <div class="summary-stat-card">
          <div class="stat-number">Jan 2024</div>
          <div class="stat-label">Baseline</div>
        </div>
        <div class="summary-stat-card">
          <div class="stat-number">Oct 2024</div>
          <div class="stat-label">Latest Wave</div>
        </div>
      </div>
      <div class="summary-insight-box" id="summary-section-background">
        <div class="summary-section-controls">
          <button class="turas-action-btn" onclick="pinSummarySection(&#39;background&#39;)">&#x1F4CC; Pin to Views</button>
          <button class="turas-action-btn" onclick="exportSummarySlide(&#39;background&#39;)">&#x1F4F7; Export Slide</button>
        </div>
        <h3 class="summary-insight-title">Background &amp; Method</h3>
        <div class="insight-editor summary-editor" contenteditable="true" data-placeholder="Add background and methodology notes here..." id="summary-background-editor"></div>
      </div>
      <div class="summary-insight-box" id="summary-section-findings">
        <div class="summary-section-controls">
          <button class="turas-action-btn" onclick="pinSummarySection(&#39;findings&#39;)">&#x1F4CC; Pin to Views</button>
          <button class="turas-action-btn" onclick="exportSummarySlide(&#39;findings&#39;)">&#x1F4F7; Export Slide</button>
        </div>
        <h3 class="summary-insight-title">Summary</h3>
        <div class="insight-editor summary-editor" contenteditable="true" data-placeholder="Add key findings and summary here..." id="summary-findings-editor"></div>
      </div>
      <div class="dash-section" id="summary-section-sig-changes">
        <div class="summary-section-controls">
          <button class="turas-action-btn" onclick="pinSigChanges()">&#x1F4CC; Pin to Views</button>
          <button class="turas-action-btn" onclick="exportSummarySlide(&#39;sig-changes&#39;)">&#x1F4F7; Export Slide</button>
        </div>
        <div class="dash-section-title">Significant Changes</div>
        <div class="dash-section-sub">Wave-on-wave changes that are statistically significant (Oct 2024 vs Jul 2024)</div>
        <div class="dash-sig-grid">
          <div class="dash-sig-card" style="border-left-color: #059669">
            <div class="dash-sig-badges">
              <span class="dash-sig-metric-badge">Net Promoter Score (% Promoters)</span>
              <span class="dash-sig-group-badge">Loyalty</span>
              <span class="dash-sig-segment-badge">Region_Cape Town</span>
            </div>
            <div class="dash-sig-text">
              <span class="tk-sig tk-sig-up">â–²</span>
               Significant increase: 23% â†’ 61% (+37.6 pp)
            </div>
          </div>
          <div class="dash-sig-card" style="border-left-color: #059669">
            <div class="dash-sig-badges">
              <span class="dash-sig-metric-badge">Net Promoter Score (NPS)</span>
              <span class="dash-sig-group-badge">Loyalty</span>
              <span class="dash-sig-segment-badge">Region_Cape Town</span>
            </div>
            <div class="dash-sig-text">
              <span class="tk-sig tk-sig-up">â–²</span>
               Significant increase: -13.69 â†’ +53.04 (+66.73)
            </div>
          </div>
          <div class="dash-sig-card" style="border-left-color: #c0392b">
            <div class="dash-sig-badges">
              <span class="dash-sig-metric-badge">Net Promoter Score (% Detractors)</span>
              <span class="dash-sig-group-badge">Loyalty</span>
              <span class="dash-sig-segment-badge">Region_Cape Town</span>
            </div>
            <div class="dash-sig-text">
              <span class="tk-sig tk-sig-down">â–¼</span>
               Significant decrease: 37% â†’ 8% (-29.1 pp)
            </div>
          </div>
        </div>
      </div>
      <div class="summary-type-filter">
<button class="summary-type-chip active" data-type-filter="all" onclick="filterSummaryByType('all')">All</button>
<button class="summary-type-chip" data-type-filter="mean" onclick="filterSummaryByType('mean')">Mean / Rating</button>
<button class="summary-type-chip" data-type-filter="pct" onclick="filterSummaryByType('pct')">% / Top Box</button>
<button class="summary-type-chip" data-type-filter="nps" onclick="filterSummaryByType('nps')">NPS</button>
</div>
      <div class="summary-actions">
        <button class="turas-action-btn" onclick="exportSummaryExcel()">&#x2B73; Export Excel</button>
        <button class="turas-action-btn" onclick="pinSummaryTable()">&#x1F4CC; Pin to Views</button>
        <button class="turas-action-btn" onclick="exportSummaryTableSlide()">&#x1F4F7; Export Slide</button>
      </div>
      <div class="summary-metrics-table-wrap">
<h3 class="summary-insight-title">Metrics Overview</h3>
<table class="tk-table summary-metrics-table" id="summary-metrics-table">
<thead><tr>
<th class="tk-th tk-label-col">Metric</th>
<th class="tk-th">Jan 2024</th>
<th class="tk-th">Apr 2024</th>
<th class="tk-th">Jul 2024</th>
<th class="tk-th">Oct 2024</th>
</tr></thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell">100</td>
<td class="tk-td tk-base-cell">100</td>
<td class="tk-td tk-base-cell">100</td>
<td class="tk-td tk-base-cell">100</td>
</tr>
<tr class="tk-section-row"><td colspan="5" class="tk-section-cell">Awareness</td></tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Brand Awareness</span></td>
<td class="tk-td tk-value-cell">68%</td>
<td class="tk-td tk-value-cell">63%</td>
<td class="tk-td tk-value-cell">69%</td>
<td class="tk-td tk-value-cell">70%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Brand Preference (% Brand A)</span></td>
<td class="tk-td tk-value-cell">27%</td>
<td class="tk-td tk-value-cell">36%</td>
<td class="tk-td tk-value-cell">29%</td>
<td class="tk-td tk-value-cell">35%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Brand Preference (% Brand B)</span></td>
<td class="tk-td tk-value-cell">22%</td>
<td class="tk-td tk-value-cell">21%</td>
<td class="tk-td tk-value-cell">32%</td>
<td class="tk-td tk-value-cell">26%</td>
</tr>
<tr class="tk-section-row"><td colspan="5" class="tk-section-cell">Brand Health</td></tr>
<tr class="tk-metric-row" data-metric-type="mean">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Overall Satisfaction (Average)</span></td>
<td class="tk-td tk-value-cell">6.9</td>
<td class="tk-td tk-value-cell">7.1</td>
<td class="tk-td tk-value-cell">7.3</td>
<td class="tk-td tk-value-cell">7.7</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Overall Satisfaction (Satisfied)</span></td>
<td class="tk-td tk-value-cell">14%</td>
<td class="tk-td tk-value-cell">15%</td>
<td class="tk-td tk-value-cell">15%</td>
<td class="tk-td tk-value-cell">28%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Overall Satisfaction (Very Satisfied)</span></td>
<td class="tk-td tk-value-cell">4%</td>
<td class="tk-td tk-value-cell">6%</td>
<td class="tk-td tk-value-cell">7%</td>
<td class="tk-td tk-value-cell">14%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="mean">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Service Quality (Mean)</span></td>
<td class="tk-td tk-value-cell">6.5</td>
<td class="tk-td tk-value-cell">6.9</td>
<td class="tk-td tk-value-cell">6.8</td>
<td class="tk-td tk-value-cell">6.6</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Service Quality (Top 2 Box)</span></td>
<td class="tk-td tk-value-cell">16%</td>
<td class="tk-td tk-value-cell">15%</td>
<td class="tk-td tk-value-cell">19%</td>
<td class="tk-td tk-value-cell">18%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="mean">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Value for Money (Mean)</span></td>
<td class="tk-td tk-value-cell">6.0</td>
<td class="tk-td tk-value-cell">6.3</td>
<td class="tk-td tk-value-cell">6.1</td>
<td class="tk-td tk-value-cell">6.4</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Value for Money (Dissatisfied)</span></td>
<td class="tk-td tk-value-cell">23%</td>
<td class="tk-td tk-value-cell">4%</td>
<td class="tk-td tk-value-cell">8%</td>
<td class="tk-td tk-value-cell">5%</td>
</tr>
<tr class="tk-section-row"><td colspan="5" class="tk-section-cell">Channels</td></tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Channel Usage</span></td>
<td class="tk-td tk-value-cell">&mdash;</td>
<td class="tk-td tk-value-cell">&mdash;</td>
<td class="tk-td tk-value-cell">&mdash;</td>
<td class="tk-td tk-value-cell">&mdash;</td>
</tr>
<tr class="tk-section-row"><td colspan="5" class="tk-section-cell">Commercial</td></tr>
<tr class="tk-metric-row" data-metric-type="mean">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Purchase Intent (Average)</span></td>
<td class="tk-td tk-value-cell">3.2</td>
<td class="tk-td tk-value-cell">3.2</td>
<td class="tk-td tk-value-cell">3.5</td>
<td class="tk-td tk-value-cell">3.4</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Purchase Intent (Positive)</span></td>
<td class="tk-td tk-value-cell">36%</td>
<td class="tk-td tk-value-cell">36%</td>
<td class="tk-td tk-value-cell">55%</td>
<td class="tk-td tk-value-cell">46%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="pct">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Purchase Intent (Negative)</span></td>
<td class="tk-td tk-value-cell">24%</td>
<td class="tk-td tk-value-cell">21%</td>
<td class="tk-td tk-value-cell">16%</td>
<td class="tk-td tk-value-cell">17%</td>
</tr>
<tr class="tk-section-row"><td colspan="5" class="tk-section-cell">Loyalty</td></tr>
<tr class="tk-metric-row" data-metric-type="nps">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Net Promoter Score (NPS)</span></td>
<td class="tk-td tk-value-cell">-25.56</td>
<td class="tk-td tk-value-cell">-17.50</td>
<td class="tk-td tk-value-cell">-5.87</td>
<td class="tk-td tk-value-cell">-4.99</td>
</tr>
<tr class="tk-metric-row" data-metric-type="nps">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Net Promoter Score (% Promoters)</span></td>
<td class="tk-td tk-value-cell">22%</td>
<td class="tk-td tk-value-cell">26%</td>
<td class="tk-td tk-value-cell">29%</td>
<td class="tk-td tk-value-cell">33%</td>
</tr>
<tr class="tk-metric-row" data-metric-type="nps">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Net Promoter Score (% Detractors)</span></td>
<td class="tk-td tk-value-cell">47%</td>
<td class="tk-td tk-value-cell">43%</td>
<td class="tk-td tk-value-cell">34%</td>
<td class="tk-td tk-value-cell">38%</td>
</tr>
<tr class="tk-section-row"><td colspan="5" class="tk-section-cell">Summary Metrics</td></tr>
<tr class="tk-metric-row" data-metric-type="mean">
<td class="tk-td tk-label-col"><span class="tk-metric-label">Customer Experience Index</span></td>
<td class="tk-td tk-value-cell">6.4</td>
<td class="tk-td tk-value-cell">6.8</td>
<td class="tk-td tk-value-cell">6.7</td>
<td class="tk-td tk-value-cell">6.9</td>
</tr>
</tbody></table></div>
    </div>
  </div>
  <div id="tab-metrics" class="tab-panel">
    <div class="metrics-tab-layout">
      <aside class="mv-sidebar">
        <div class="mv-sidebar-inner">
          <div class="mv-sidebar-search">
            <input type="text" class="tk-search-input" placeholder="Search metrics..." oninput="filterMetricNav(this.value)"/>
          </div>
          <div class="mv-type-filter">
<button class="mv-type-chip active" data-type-filter="all" onclick="filterMetricType('all')">All</button>
<button class="mv-type-chip" data-type-filter="mean" onclick="filterMetricType('mean')">Mean / Rating</button>
<button class="mv-type-chip" data-type-filter="pct" onclick="filterMetricType('pct')">% / Top Box</button>
<button class="mv-type-chip" data-type-filter="nps" onclick="filterMetricType('nps')">NPS</button>
</div>
          <div class="mv-global-controls">
            <label class="tk-toggle">
              <input type="checkbox" id="toggle-sig-global" onchange="toggleSignificance()"/>
              <span class="tk-toggle-label">Hide Significance Indicators</span>
            </label>
          </div>
          <div class="mv-sidebar-nav-wrap">
            <div class="mv-sidebar-nav-header">Metrics (18)</div>
            <div class="mv-sidebar-nav-scroll">
              <nav class="mv-sidebar-nav"><div class="mv-nav-section">Awareness</div>
<a class="tk-metric-nav-item active" data-metric-id="metric_1" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_1');return false;">Brand Awareness</a>
<a class="tk-metric-nav-item" data-metric-id="metric_2" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_2');return false;">Brand Preference (% Brand A)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_3" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_3');return false;">Brand Preference (% Brand B)</a>
<div class="mv-nav-section">Brand Health</div>
<a class="tk-metric-nav-item" data-metric-id="metric_4" data-metric-type="mean" href="#" onclick="selectTrackerMetric('metric_4');return false;">Overall Satisfaction (Average)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_5" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_5');return false;">Overall Satisfaction (Satisfied)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_6" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_6');return false;">Overall Satisfaction (Very Satisfied)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_7" data-metric-type="mean" href="#" onclick="selectTrackerMetric('metric_7');return false;">Service Quality (Mean)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_8" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_8');return false;">Service Quality (Top 2 Box)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_9" data-metric-type="mean" href="#" onclick="selectTrackerMetric('metric_9');return false;">Value for Money (Mean)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_10" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_10');return false;">Value for Money (Dissatisfied)</a>
<div class="mv-nav-section">Channels</div>
<a class="tk-metric-nav-item" data-metric-id="metric_11" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_11');return false;">Channel Usage</a>
<div class="mv-nav-section">Commercial</div>
<a class="tk-metric-nav-item" data-metric-id="metric_12" data-metric-type="mean" href="#" onclick="selectTrackerMetric('metric_12');return false;">Purchase Intent (Average)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_13" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_13');return false;">Purchase Intent (Positive)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_14" data-metric-type="pct" href="#" onclick="selectTrackerMetric('metric_14');return false;">Purchase Intent (Negative)</a>
<div class="mv-nav-section">Loyalty</div>
<a class="tk-metric-nav-item" data-metric-id="metric_15" data-metric-type="nps" href="#" onclick="selectTrackerMetric('metric_15');return false;">Net Promoter Score (NPS)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_16" data-metric-type="nps" href="#" onclick="selectTrackerMetric('metric_16');return false;">Net Promoter Score (% Promoters)</a>
<a class="tk-metric-nav-item" data-metric-id="metric_17" data-metric-type="nps" href="#" onclick="selectTrackerMetric('metric_17');return false;">Net Promoter Score (% Detractors)</a>
<div class="mv-nav-section">Summary Metrics</div>
<a class="tk-metric-nav-item" data-metric-id="metric_18" data-metric-type="mean" href="#" onclick="selectTrackerMetric('metric_18');return false;">Customer Experience Index</a></nav>
            </div>
          </div>
          <div class="legend-box">
            <div class="legend-title">Legend</div>
            <div class="legend-item">
              <span class="tk-sig tk-sig-up">â–²</span>
              <span>Significantly higher than previous wave</span>
            </div>
            <div class="legend-item">
              <span class="tk-sig tk-sig-down">â–¼</span>
              <span>Significantly lower than previous wave</span>
            </div>
            <div class="legend-item">
              <span style="color:#94a3b8;font-size:12px">3.80</span>
              <span>Low base â€” values in grey (n&lt;30)</span>
            </div>
            <div class="legend-item">
              <span style="color:#e8614d;font-weight:700;font-size:11px">âš  28</span>
              <span>Low base warning in base row (n&lt;30)</span>
            </div>
          </div>
        </div>
      </aside>
      <main class="mv-content"><div class="tk-metric-panel active" id="mv-metric_1">
<h2 class="mv-metric-title">Brand Awareness<span class="mv-metric-subtitle"> &mdash; Are you aware of our brand?</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_1','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_1','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_1','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_1','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_1','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_1','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_1','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_1','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_1','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_1','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_1','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_1','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_1','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_1')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_1','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_1','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_1',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_1')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_1')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_1','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_1',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_1',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_1',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_1',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,4.7 20.7,14.0 39.3,3.9 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="68.1732757000564"><span class="tk-val">68%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="63.1972663465091"><span class="tk-val">63%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="68.6174171938965"><span class="tk-val">69%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="69.6063443531435"><span class="tk-val">70%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,8.0 20.7,14.0 39.3,3.0 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="68.6518085495068"><span class="tk-val">69%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="56.299347751459"><span class="tk-val">56%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="78.8064516129032"><span class="tk-val">79%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="80.9018567639257"><span class="tk-val">81%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-12pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+23pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-12pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+12pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,14.0 39.3,5.5 58.0,3.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="3.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="68.3474787818272"><span class="tk-val">68%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="57.2044647387113"><span class="tk-val">57%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="65.0610739801798"><span class="tk-val">65%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="67.4287182121757"><span class="tk-val">67%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+8pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,9.5 20.7,2.0 39.3,14.0 58.0,13.5" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="13.5" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="67.6583739420364"><span class="tk-val">68%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="74.2008557764913"><span class="tk-val">74%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="63.7352674524025"><span class="tk-val">64%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="64.1840366039654"><span class="tk-val">64%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+0pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-3pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,85.9 C97.8,90.4 195.6,99.6 293.3,99.4 C391.1,99.2 488.9,87.6 586.7,84.7 C684.4,81.8 782.2,83.0 880.0,82.1" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="85.9" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="68%"/>
<circle cx="293.3" cy="99.4" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="63%"/>
<circle cx="586.7" cy="84.7" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="69%"/>
<circle cx="880.0" cy="82.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="70%"/>
<path d="M0.0,84.6 C97.8,95.8 195.6,122.6 293.3,118.0 C391.1,113.4 488.9,68.3 586.7,57.2 C684.4,46.2 782.2,53.5 880.0,51.6" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="84.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="69%"/>
<circle cx="293.3" cy="118.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="56%"/>
<circle cx="586.7" cy="57.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="79%"/>
<circle cx="880.0" cy="51.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="81%"/>
<path d="M0.0,85.5 C97.8,95.5 195.6,114.1 293.3,115.5 C391.1,117.0 488.9,98.9 586.7,94.3 C684.4,89.7 782.2,90.1 880.0,87.9" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="85.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="68%"/>
<circle cx="293.3" cy="115.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="57%"/>
<circle cx="586.7" cy="94.3" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="65%"/>
<circle cx="880.0" cy="87.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="67%"/>
<path d="M0.0,87.3 C97.8,81.4 195.6,67.9 293.3,69.7 C391.1,71.4 488.9,93.4 586.7,97.9 C684.4,102.4 782.2,97.1 880.0,96.7" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="87.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="68%"/>
<circle cx="293.3" cy="69.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="74%"/>
<circle cx="586.7" cy="97.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="64%"/>
<circle cx="880.0" cy="96.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="64%"/>
<text x="0.0" y="70.6" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">69%</text>
<text x="0.0" y="84.6" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">68%</text>
<text x="0.0" y="98.6" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">68%</text>
<text x="0.0" y="112.6" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">68%</text>
<text x="293.3" y="55.7" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">74%</text>
<text x="293.3" y="85.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">63%</text>
<text x="293.3" y="101.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">57%</text>
<text x="293.3" y="115.5" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">56%</text>
<text x="586.7" y="43.2" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">79%</text>
<text x="586.7" y="70.7" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">69%</text>
<text x="586.7" y="84.7" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">65%</text>
<text x="586.7" y="98.7" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">64%</text>
<text x="880.0" y="37.6" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">81%</text>
<text x="880.0" y="68.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">70%</text>
<text x="880.0" y="82.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">67%</text>
<text x="880.0" y="96.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">64%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_1')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_1')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_1')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_2">
<h2 class="mv-metric-title">Brand Preference (% Brand A)<span class="mv-metric-subtitle"> &mdash; Which brand do you prefer?</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_2','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_2','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_2','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_2','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_2','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_2','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_2','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_2','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_2','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_2','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_2','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_2','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_2','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_2')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_2','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_2','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_2',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_2')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_2')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_2','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_2',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_2',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_2',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_2',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,11.1 58.0,2.9" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.9" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="27.024995301635"><span class="tk-val">27%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="35.8422608053195"><span class="tk-val">36%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="29.1310011164868"><span class="tk-val">29%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="35.1901394993312"><span class="tk-val">35%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">-7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+6pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+8pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,9.8 58.0,9.1" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="9.1" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="26.0869565217391"><span class="tk-val">26%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="36.3886028149674"><span class="tk-val">36%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="29.7096774193548"><span class="tk-val">30%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="30.2766199317923"><span class="tk-val">30%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+1pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+4pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,6.0 39.3,2.0 58.0,8.5" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="8.5" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="25.4867698452322"><span class="tk-val">25%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="31.7351598173516"><span class="tk-val">32%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="34.8236920949528"><span class="tk-val">35%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="29.7456974055998"><span class="tk-val">30%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-5pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,9.7 20.7,4.3 39.3,14.0 58.0,2.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="29.2639138240574"><span class="tk-val">29%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="39.5167379813743"><span class="tk-val">40%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="21.1242067089755"><span class="tk-val">21%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="43.8739196746314"><span class="tk-val">44%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-18pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+23pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-8pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+15pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,197.0 C97.8,189.1 195.6,174.2 293.3,173.2 C391.1,172.3 488.9,191.1 586.7,191.3 C684.4,191.6 782.2,180.4 880.0,175.0" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="197.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="27%"/>
<circle cx="293.3" cy="173.2" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="36%"/>
<circle cx="586.7" cy="191.3" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="29%"/>
<circle cx="880.0" cy="175.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="35%"/>
<path d="M0.0,199.6 C97.8,190.3 195.6,173.4 293.3,171.8 C391.1,170.1 488.9,187.0 586.7,189.8 C684.4,192.5 782.2,188.8 880.0,188.3" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="199.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="26%"/>
<circle cx="293.3" cy="171.8" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="36%"/>
<circle cx="586.7" cy="189.8" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="30%"/>
<circle cx="880.0" cy="188.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="30%"/>
<path d="M0.0,201.2 C97.8,195.6 195.6,188.5 293.3,184.3 C391.1,180.1 488.9,175.1 586.7,176.0 C684.4,176.9 782.2,185.1 880.0,189.7" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="201.2" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="25%"/>
<circle cx="293.3" cy="184.3" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="32%"/>
<circle cx="586.7" cy="176.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="35%"/>
<circle cx="880.0" cy="189.7" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="30%"/>
<path d="M0.0,191.0 C97.8,181.8 195.6,159.6 293.3,163.3 C391.1,167.0 488.9,214.9 586.7,213.0 C684.4,211.0 782.2,172.0 880.0,151.5" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="191.0" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="29%"/>
<circle cx="293.3" cy="163.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="40%"/>
<circle cx="586.7" cy="213.0" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="21%"/>
<circle cx="880.0" cy="151.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="44%"/>
<text x="0.0" y="177.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">29%</text>
<text x="0.0" y="191.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">27%</text>
<text x="0.0" y="205.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">26%</text>
<text x="0.0" y="219.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">25%</text>
<text x="293.3" y="149.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">40%</text>
<text x="293.3" y="163.3" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">36%</text>
<text x="293.3" y="177.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">36%</text>
<text x="293.3" y="191.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">32%</text>
<text x="586.7" y="162.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">35%</text>
<text x="586.7" y="176.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">30%</text>
<text x="586.7" y="190.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">29%</text>
<text x="586.7" y="204.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">21%</text>
<text x="880.0" y="137.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">44%</text>
<text x="880.0" y="161.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">35%</text>
<text x="880.0" y="175.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">30%</text>
<text x="880.0" y="189.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">30%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_2')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_2')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_2')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_3">
<h2 class="mv-metric-title">Brand Preference (% Brand B)<span class="mv-metric-subtitle"> &mdash; Which brand do you prefer?</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_3','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_3','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_3','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_3','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_3','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_3','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_3','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_3','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_3','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_3','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_3','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_3','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_3','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_3')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_3','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_3','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_3',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_3')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_3')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_3','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_3',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_3',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_3',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_3',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,13.4 20.7,14.0 39.3,2.0 58.0,9.1" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="9.1" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="21.7346363465514"><span class="tk-val">22%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="21.222755818249"><span class="tk-val">21%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="32.1920357275772"><span class="tk-val">32%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="25.7309382763233"><span class="tk-val">26%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-6pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+4pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,3.2 20.7,14.0 39.3,2.0 58.0,6.8" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="6.8" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="28.7541103397881"><span class="tk-val">29%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="19.121180913148"><span class="tk-val">19%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="29.8064516129032"><span class="tk-val">30%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="25.5399772641152"><span class="tk-val">26%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-4pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-3pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.5 39.3,2.0 58.0,3.6" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="3.6" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="17.773339990015"><span class="tk-val">18%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="19.558599695586"><span class="tk-val">20%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="26.3655220096796"><span class="tk-val">26%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="25.1990752632931"><span class="tk-val">25%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+7pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,12.0 39.3,2.0 58.0,10.9" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="10.9" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="20.8771479866632"><span class="tk-val">21%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="24.4147998993204"><span class="tk-val">24%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="42.067089755213"><span class="tk-val">42%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="26.3853584138282"><span class="tk-val">26%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+18pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-16pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+21pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+6pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,211.3 C97.8,211.8 195.6,217.4 293.3,212.7 C391.1,208.0 488.9,185.1 586.7,183.1 C684.4,181.1 782.2,194.7 880.0,200.5" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="211.3" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="22%"/>
<circle cx="293.3" cy="212.7" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="21%"/>
<circle cx="586.7" cy="183.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="32%"/>
<circle cx="880.0" cy="200.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="26%"/>
<path d="M0.0,192.4 C97.8,201.0 195.6,218.8 293.3,218.4 C391.1,217.9 488.9,192.4 586.7,189.5 C684.4,186.6 782.2,197.2 880.0,201.0" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="192.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="29%"/>
<circle cx="293.3" cy="218.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="19%"/>
<circle cx="586.7" cy="189.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="30%"/>
<circle cx="880.0" cy="201.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="26%"/>
<path d="M0.0,222.0 C97.8,220.4 195.6,221.1 293.3,217.2 C391.1,213.3 488.9,201.4 586.7,198.8 C684.4,196.3 782.2,200.9 880.0,202.0" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="222.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="18%"/>
<circle cx="293.3" cy="217.2" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="20%"/>
<circle cx="586.7" cy="198.8" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="26%"/>
<circle cx="880.0" cy="202.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="25%"/>
<path d="M0.0,213.6 C97.8,210.4 195.6,213.6 293.3,204.1 C391.1,194.5 488.9,157.3 586.7,156.4 C684.4,155.5 782.2,184.6 880.0,198.8" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="213.6" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="21%"/>
<circle cx="293.3" cy="204.1" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="24%"/>
<circle cx="586.7" cy="156.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="42%"/>
<circle cx="880.0" cy="198.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="26%"/>
<text x="0.0" y="178.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">29%</text>
<text x="0.0" y="197.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">22%</text>
<text x="0.0" y="211.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">21%</text>
<text x="0.0" y="225.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">18%</text>
<text x="293.3" y="190.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">24%</text>
<text x="293.3" y="204.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">21%</text>
<text x="293.3" y="218.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">20%</text>
<text x="293.3" y="232.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">19%</text>
<text x="586.7" y="142.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">42%</text>
<text x="586.7" y="169.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">32%</text>
<text x="586.7" y="183.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">30%</text>
<text x="586.7" y="197.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">26%</text>
<text x="880.0" y="184.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">26%</text>
<text x="880.0" y="198.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">26%</text>
<text x="880.0" y="212.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">26%</text>
<text x="880.0" y="226.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">25%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_3')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_3')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_3')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_4">
<h2 class="mv-metric-title">Overall Satisfaction (Average)<span class="mv-metric-subtitle"> &mdash; Overall, how satisfied are you with our brand? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_4','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_4','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_4','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_4','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_4','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_4','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_4','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_4','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_4','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_4','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_4','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_4','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_4','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_4')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_4','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_4','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_4',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_4')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_4')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_4','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_4',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_4',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_4',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_4',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,10.5 39.3,7.4 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="6.85904905093028"><span class="tk-val">6.9</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="7.09124492057628"><span class="tk-val">7.1</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="7.304335690361"><span class="tk-val">7.3</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="7.66587043760749"><span class="tk-val">7.7</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+0.8</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,8.5 39.3,10.1 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="6.71830471318962"><span class="tk-val">6.7</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="7.32028836251287"><span class="tk-val">7.3</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="7.13967741935484"><span class="tk-val">7.1</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="8.02159909056461"><span class="tk-val">8.0</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">+0.9 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+1.3</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.7 39.3,10.4 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="6.90988517224164"><span class="tk-val">6.9</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="6.92694063926941"><span class="tk-val">6.9</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="7.11108550357225"><span class="tk-val">7.1</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="7.58181351143077"><span class="tk-val">7.6</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.5 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.2</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.7</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.3 39.3,2.0 58.0,5.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="5.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="6.90561682482688"><span class="tk-val">6.9</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="7.08633274603574"><span class="tk-val">7.1</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="7.71199758235116"><span class="tk-val">7.7</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="7.51042196237926"><span class="tk-val">7.5</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+0.8</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+0.6</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0.0</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">2.5</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">5.0</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">7.5</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">10.0</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,84.8 C97.8,82.7 195.6,80.5 293.3,78.5 C391.1,76.5 488.9,75.4 586.7,72.8 C684.4,70.2 782.2,66.3 880.0,63.0" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="84.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="6.9"/>
<circle cx="293.3" cy="78.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="7.1"/>
<circle cx="586.7" cy="72.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="7.3"/>
<circle cx="880.0" cy="63.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="7.7"/>
<path d="M0.0,88.6 C97.8,83.2 195.6,74.2 293.3,72.4 C391.1,70.5 488.9,80.4 586.7,77.2 C684.4,74.1 782.2,61.4 880.0,53.4" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="88.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="6.7"/>
<circle cx="293.3" cy="72.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="7.3"/>
<circle cx="586.7" cy="77.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="7.1"/>
<circle cx="880.0" cy="53.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="8.0"/>
<path d="M0.0,83.4 C97.8,83.3 195.6,83.9 293.3,83.0 C391.1,82.1 488.9,80.9 586.7,78.0 C684.4,75.1 782.2,69.5 880.0,65.3" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="83.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="6.9"/>
<circle cx="293.3" cy="83.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="6.9"/>
<circle cx="586.7" cy="78.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="7.1"/>
<circle cx="880.0" cy="65.3" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="7.6"/>
<path d="M0.0,83.5 C97.8,81.9 195.6,82.3 293.3,78.7 C391.1,75.0 488.9,63.7 586.7,61.8 C684.4,59.9 782.2,65.4 880.0,67.2" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="83.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="6.9"/>
<circle cx="293.3" cy="78.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="7.1"/>
<circle cx="586.7" cy="61.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="7.7"/>
<circle cx="880.0" cy="67.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="7.5"/>
<text x="0.0" y="69.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">6.9</text>
<text x="0.0" y="83.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">6.9</text>
<text x="0.0" y="97.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">6.9</text>
<text x="0.0" y="111.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">6.7</text>
<text x="293.3" y="58.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">7.3</text>
<text x="293.3" y="72.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">7.1</text>
<text x="293.3" y="86.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">7.1</text>
<text x="293.3" y="100.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">6.9</text>
<text x="586.7" y="47.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">7.7</text>
<text x="586.7" y="61.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">7.3</text>
<text x="586.7" y="75.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">7.1</text>
<text x="586.7" y="89.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">7.1</text>
<text x="880.0" y="39.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">8.0</text>
<text x="880.0" y="53.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">7.7</text>
<text x="880.0" y="67.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">7.6</text>
<text x="880.0" y="81.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">7.5</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_4')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_4')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_4')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_5">
<h2 class="mv-metric-title">Overall Satisfaction (Satisfied)<span class="mv-metric-subtitle"> &mdash; Overall, how satisfied are you with our brand? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_5','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_5','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_5','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_5','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_5','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_5','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_5','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_5','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_5','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_5','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_5','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_5','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_5','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_5')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_5','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_5','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_5',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_5')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_5')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_5','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_5',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_5',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_5',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_5',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.4 39.3,13.2 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="13.9823341477166"><span class="tk-val">14%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="14.6564462504618"><span class="tk-val">15%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="14.9516189058429"><span class="tk-val">15%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="28.4827059048347"><span class="tk-val">28%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+14pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+15pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.9 39.3,10.2 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="15.4548776032152"><span class="tk-val">15%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="15.5509783728115"><span class="tk-val">16%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="21.1290322580645"><span class="tk-val">21%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="33.2701780977643"><span class="tk-val">33%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+12pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+18pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,10.8 20.7,11.3 39.3,14.0 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="12.755866200699"><span class="tk-val">13%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="11.9989852866565"><span class="tk-val">12%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="8.36598294537912"><span class="tk-val">8%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="24.5825841253532"><span class="tk-val">25%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+16pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+12pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,12.0 39.3,11.1 58.0,2.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="14.2087714798666"><span class="tk-val">14%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="16.6373017870627"><span class="tk-val">17%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="17.7999395587791"><span class="tk-val">18%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="29.1306558210473"><span class="tk-val">29%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+11pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+15pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,232.2 C97.8,231.6 195.6,230.9 293.3,230.4 C391.1,230.0 488.9,235.9 586.7,229.6 C684.4,223.4 782.2,205.3 880.0,193.1" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="232.2" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="14%"/>
<circle cx="293.3" cy="230.4" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="15%"/>
<circle cx="586.7" cy="229.6" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="15%"/>
<circle cx="880.0" cy="193.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="28%"/>
<path d="M0.0,228.3 C97.8,228.2 195.6,230.6 293.3,228.0 C391.1,225.5 488.9,220.9 586.7,213.0 C684.4,205.0 782.2,191.1 880.0,180.2" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="228.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="15%"/>
<circle cx="293.3" cy="228.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="16%"/>
<circle cx="586.7" cy="213.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="21%"/>
<circle cx="880.0" cy="180.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="33%"/>
<path d="M0.0,235.6 C97.8,236.2 195.6,235.6 293.3,237.6 C391.1,239.6 488.9,253.1 586.7,247.4 C684.4,241.7 782.2,218.2 880.0,203.6" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="235.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="13%"/>
<circle cx="293.3" cy="237.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="12%"/>
<circle cx="586.7" cy="247.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="8%"/>
<circle cx="880.0" cy="203.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="25%"/>
<path d="M0.0,231.6 C97.8,229.5 195.6,226.7 293.3,225.1 C391.1,223.5 488.9,227.6 586.7,221.9 C684.4,216.3 782.2,201.5 880.0,191.3" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="231.6" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="14%"/>
<circle cx="293.3" cy="225.1" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="17%"/>
<circle cx="586.7" cy="221.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="18%"/>
<circle cx="880.0" cy="191.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="29%"/>
<text x="0.0" y="214.3" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">15%</text>
<text x="0.0" y="228.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">14%</text>
<text x="0.0" y="242.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">14%</text>
<text x="0.0" y="256.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">13%</text>
<text x="293.3" y="211.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">17%</text>
<text x="293.3" y="225.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">16%</text>
<text x="293.3" y="239.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">15%</text>
<text x="293.3" y="253.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">12%</text>
<text x="586.7" y="199.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">21%</text>
<text x="586.7" y="213.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">18%</text>
<text x="586.7" y="227.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">15%</text>
<text x="586.7" y="241.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">8%</text>
<text x="880.0" y="166.2" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">33%</text>
<text x="880.0" y="180.2" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">29%</text>
<text x="880.0" y="194.2" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">28%</text>
<text x="880.0" y="208.2" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">25%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_5')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_5')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_5')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_6">
<h2 class="mv-metric-title">Overall Satisfaction (Very Satisfied)<span class="mv-metric-subtitle"> &mdash; Overall, how satisfied are you with our brand? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_6','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_6','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_6','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_6','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_6','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_6','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_6','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_6','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_6','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_6','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_6','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_6','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_6','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_6')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_6','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_6','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_6',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_6')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_6')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_6','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_6',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_6',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_6',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_6',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.6 39.3,10.3 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="3.9278331140763"><span class="tk-val">4%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="6.0121906169191"><span class="tk-val">6%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="7.13621138816524"><span class="tk-val">7%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="14.3130135677432"><span class="tk-val">14%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+7pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+10pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,6.0 39.3,2.0 58.0,12.6" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="12.6" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="3.54402630617464"><span class="tk-val">4%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="8.78819086852043"><span class="tk-val">9%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="11.3870967741935"><span class="tk-val">11%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="4.47139067828723"><span class="tk-val">4%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-7pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+8pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+1pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,9.5 39.3,13.7 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="2.37144283574638"><span class="tk-val">2%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="5.96144089294774"><span class="tk-val">6%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="2.60428670200507"><span class="tk-val">3%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="11.8674544053429"><span class="tk-val">12%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,12.9 20.7,14.0 39.3,10.8 58.0,2.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="5.79635804052321"><span class="tk-val">6%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="4.0271834885477"><span class="tk-val">4%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="9.0964037473557"><span class="tk-val">9%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="23.3350279613625"><span class="tk-val">23%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+18pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,259.4 C97.8,257.5 195.6,255.2 293.3,253.8 C391.1,252.3 488.9,254.5 586.7,250.7 C684.4,247.0 782.2,237.8 880.0,231.4" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="259.4" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="4%"/>
<circle cx="293.3" cy="253.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="6%"/>
<circle cx="586.7" cy="250.7" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="7%"/>
<circle cx="880.0" cy="231.4" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="14%"/>
<path d="M0.0,260.4 C97.8,255.7 195.6,249.8 293.3,246.3 C391.1,242.7 488.9,237.3 586.7,239.3 C684.4,241.2 782.2,251.7 880.0,257.9" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="260.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="4%"/>
<circle cx="293.3" cy="246.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="9%"/>
<circle cx="586.7" cy="239.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="11%"/>
<circle cx="880.0" cy="257.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="4%"/>
<path d="M0.0,263.6 C97.8,260.4 195.6,254.0 293.3,253.9 C391.1,253.8 488.9,265.6 586.7,263.0 C684.4,260.3 782.2,246.3 880.0,238.0" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="263.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="2%"/>
<circle cx="293.3" cy="253.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="6%"/>
<circle cx="586.7" cy="263.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="3%"/>
<circle cx="880.0" cy="238.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="12%"/>
<path d="M0.0,254.3 C97.8,255.9 195.6,260.6 293.3,259.1 C391.1,257.6 488.9,254.1 586.7,245.4 C684.4,236.8 782.2,219.8 880.0,207.0" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="254.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="6%"/>
<circle cx="293.3" cy="259.1" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="4%"/>
<circle cx="586.7" cy="245.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="9%"/>
<circle cx="880.0" cy="207.0" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="23%"/>
<text x="0.0" y="224.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">6%</text>
<text x="0.0" y="238.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">4%</text>
<text x="0.0" y="252.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">4%</text>
<text x="0.0" y="266.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">2%</text>
<text x="293.3" y="224.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">9%</text>
<text x="293.3" y="238.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">6%</text>
<text x="293.3" y="252.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">6%</text>
<text x="293.3" y="266.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">4%</text>
<text x="586.7" y="224.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">11%</text>
<text x="586.7" y="238.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">9%</text>
<text x="586.7" y="252.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">7%</text>
<text x="586.7" y="266.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">3%</text>
<text x="880.0" y="193.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">23%</text>
<text x="880.0" y="217.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">14%</text>
<text x="880.0" y="231.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">12%</text>
<text x="880.0" y="245.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">4%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_6')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_6')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_6')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_7">
<h2 class="mv-metric-title">Service Quality (Mean)<span class="mv-metric-subtitle"> &mdash; How would you rate the quality of our service? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_7','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_7','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_7','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_7','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_7','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_7','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_7','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_7','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_7','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_7','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_7','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_7','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_7','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_7')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_7','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_7','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_7',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_7')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_7')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_7','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_7',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_7',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_7',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_7',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,4.3 58.0,10.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="10.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="6.48271001691411"><span class="tk-val">6.5</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="6.90339859623199"><span class="tk-val">6.9</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="6.82182731671009"><span class="tk-val">6.8</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="6.62172749856679"><span class="tk-val">6.6</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">-0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+0.1</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,14.0 39.3,6.3 58.0,11.8" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="11.8" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="7.1516258677384"><span class="tk-val">7.2</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="6.57809818056986"><span class="tk-val">6.6</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="6.94387096774194"><span class="tk-val">6.9</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="6.68093974990527"><span class="tk-val">6.7</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">-0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">-0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-0.2</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-0.5</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,10.2 58.0,8.2" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="8.2" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="6.56165751372941"><span class="tk-val">6.6</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="7.00304414003044"><span class="tk-val">7.0</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="6.7026964738419"><span class="tk-val">6.7</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="6.77523760595941"><span class="tk-val">6.8</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.1</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.2</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,3.9 58.0,8.6" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="8.6" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="5.93203385483457"><span class="tk-val">5.9</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="7.04304052353385"><span class="tk-val">7.0<span class="tk-sig tk-sig-up">&#x25B2;</span></span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="6.86370504684195"><span class="tk-val">6.9</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="6.43009659379766"><span class="tk-val">6.4</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-up">+1.1 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">-0.4 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-up">+1.1 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+0.9</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+0.5</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0.0</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">2.5</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">5.0</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">7.5</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">10.0</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,95.0 C97.8,91.2 195.6,85.1 293.3,83.6 C391.1,82.1 488.9,84.5 586.7,85.8 C684.4,87.1 782.2,89.4 880.0,91.2" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="95.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="6.5"/>
<circle cx="293.3" cy="83.6" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="6.9"/>
<circle cx="586.7" cy="85.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="6.8"/>
<circle cx="880.0" cy="91.2" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="6.6"/>
<path d="M0.0,76.9 C97.8,82.1 195.6,91.5 293.3,92.4 C391.1,93.3 488.9,83.0 586.7,82.5 C684.4,82.1 782.2,87.2 880.0,89.6" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="76.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="7.2"/>
<circle cx="293.3" cy="92.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="6.6"/>
<circle cx="586.7" cy="82.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="6.9"/>
<circle cx="880.0" cy="89.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="6.7"/>
<path d="M0.0,92.8 C97.8,88.9 195.6,81.6 293.3,80.9 C391.1,80.3 488.9,88.0 586.7,89.0 C684.4,90.1 782.2,87.7 880.0,87.1" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="92.8" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="6.6"/>
<circle cx="293.3" cy="80.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="7.0"/>
<circle cx="586.7" cy="89.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="6.7"/>
<circle cx="880.0" cy="87.1" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="6.8"/>
<path d="M0.0,109.8 C97.8,99.8 195.6,84.0 293.3,79.8 C391.1,75.6 488.9,81.9 586.7,84.7 C684.4,87.4 782.2,92.5 880.0,96.4" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="109.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="5.9"/>
<circle cx="293.3" cy="79.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="7.0"/>
<circle cx="586.7" cy="84.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="6.9"/>
<circle cx="880.0" cy="96.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="6.4"/>
<text x="0.0" y="62.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">7.2</text>
<text x="0.0" y="78.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">6.6</text>
<text x="0.0" y="92.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">6.5</text>
<text x="0.0" y="106.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">5.9</text>
<text x="293.3" y="65.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">7.0</text>
<text x="293.3" y="79.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">7.0</text>
<text x="293.3" y="93.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">6.9</text>
<text x="293.3" y="107.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">6.6</text>
<text x="586.7" y="68.5" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">6.9</text>
<text x="586.7" y="82.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">6.9</text>
<text x="586.7" y="96.5" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">6.8</text>
<text x="586.7" y="110.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">6.7</text>
<text x="880.0" y="73.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">6.8</text>
<text x="880.0" y="87.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">6.7</text>
<text x="880.0" y="101.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">6.6</text>
<text x="880.0" y="115.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">6.4</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_7')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_7')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_7')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_8">
<h2 class="mv-metric-title">Service Quality (Top 2 Box)<span class="mv-metric-subtitle"> &mdash; How would you rate the quality of our service? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_8','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_8','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_8','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_8','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_8','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_8','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_8','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_8','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_8','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_8','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_8','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_8','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_8','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_8')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_8','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_8','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_8',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_8')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_8')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_8','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_8',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_8',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_8',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_8',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,12.9 20.7,14.0 39.3,2.0 58.0,4.8" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="4.8" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="15.6831422664913"><span class="tk-val">16%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="15.3583302548947"><span class="tk-val">15%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="18.9523632303684"><span class="tk-val">19%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="18.1062488056564"><span class="tk-val">18%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-1pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,8.5 20.7,14.0 39.3,3.1 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="20.058458165875"><span class="tk-val">20%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="11.1568829385513"><span class="tk-val">11%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="28.8387096774194"><span class="tk-val">29%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="30.5797650625237"><span class="tk-val">31%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+18pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+11pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,10.6 39.3,4.6 58.0,14.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="14.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="19.5956065901148"><span class="tk-val">20%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="13.7493658041603"><span class="tk-val">14%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="17.8382115694861"><span class="tk-val">18%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="11.405086051888"><span class="tk-val">11%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-8pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,10.1 39.3,2.0 58.0,11.4" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="11.4" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="8.59194665298795"><span class="tk-val">9%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="20.0352378555248"><span class="tk-val">20%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="43.8198851616803"><span class="tk-val">44%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="16.3701067615658"><span class="tk-val">16%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+24pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-27pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+35pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+8pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,227.7 C97.8,227.9 195.6,230.0 293.3,228.5 C391.1,227.1 488.9,220.1 586.7,218.8 C684.4,217.6 782.2,220.4 880.0,221.1" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="227.7" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="16%"/>
<circle cx="293.3" cy="228.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="15%"/>
<circle cx="586.7" cy="218.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="19%"/>
<circle cx="880.0" cy="221.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="18%"/>
<path d="M0.0,215.8 C97.8,223.9 195.6,243.8 293.3,239.9 C391.1,235.9 488.9,200.9 586.7,192.1 C684.4,183.4 782.2,189.0 880.0,187.4" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="215.8" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="20%"/>
<circle cx="293.3" cy="239.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="11%"/>
<circle cx="586.7" cy="192.1" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="29%"/>
<circle cx="880.0" cy="187.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="31%"/>
<path d="M0.0,217.1 C97.8,222.4 195.6,232.1 293.3,232.9 C391.1,233.7 488.9,220.8 586.7,221.8 C684.4,222.9 782.2,233.4 880.0,239.2" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="217.1" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="20%"/>
<circle cx="293.3" cy="232.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="14%"/>
<circle cx="586.7" cy="221.8" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="18%"/>
<circle cx="880.0" cy="239.2" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="11%"/>
<path d="M0.0,246.8 C97.8,236.5 195.6,231.8 293.3,215.9 C391.1,200.1 488.9,150.0 586.7,151.7 C684.4,153.3 782.2,201.1 880.0,225.8" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="246.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="9%"/>
<circle cx="293.3" cy="215.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="20%"/>
<circle cx="586.7" cy="151.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="44%"/>
<circle cx="880.0" cy="225.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="16%"/>
<text x="0.0" y="201.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">20%</text>
<text x="0.0" y="215.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">20%</text>
<text x="0.0" y="229.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">16%</text>
<text x="0.0" y="243.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">9%</text>
<text x="293.3" y="201.9" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">20%</text>
<text x="293.3" y="215.9" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">15%</text>
<text x="293.3" y="229.9" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">14%</text>
<text x="293.3" y="243.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">11%</text>
<text x="586.7" y="137.7" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">44%</text>
<text x="586.7" y="178.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">29%</text>
<text x="586.7" y="204.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">19%</text>
<text x="586.7" y="218.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">18%</text>
<text x="880.0" y="173.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">31%</text>
<text x="880.0" y="207.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">18%</text>
<text x="880.0" y="221.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">16%</text>
<text x="880.0" y="235.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">11%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_8')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_8')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_8')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_9">
<h2 class="mv-metric-title">Value for Money (Mean)<span class="mv-metric-subtitle"> &mdash; How would you rate the value for money of our products? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_9','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_9','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_9','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_9','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_9','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_9','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_9','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_9','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_9','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_9','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_9','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_9','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_9','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_9')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_9','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_9','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_9',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_9')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_9')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_9','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_9',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_9',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_9',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_9',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,4.4 39.3,10.4 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="5.99314038714527"><span class="tk-val">6.0</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="6.30938308090137"><span class="tk-val">6.3</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="6.11118347599553"><span class="tk-val">6.1</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="6.38926046244984"><span class="tk-val">6.4</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0.1</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+0.4</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.0 39.3,11.0 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="5.4165144318597"><span class="tk-val">5.4</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="5.53209749399245"><span class="tk-val">5.5</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="5.75806451612903"><span class="tk-val">5.8</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="6.79689276241"><span class="tk-val">6.8</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">+1.0 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+1.4</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,5.6 20.7,2.0 39.3,14.0 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="6.47903145282077"><span class="tk-val">6.5</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="6.57838660578387"><span class="tk-val">6.6</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="6.2459091956672"><span class="tk-val">6.2</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="6.57924479835602"><span class="tk-val">6.6</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-0.2</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.1</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,7.8 58.0,13.5" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="13.5" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="5.89869197230059"><span class="tk-val">5.9</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="6.61238358922728"><span class="tk-val">6.6</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="6.26533695980659"><span class="tk-val">6.3</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="5.92780884595831"><span class="tk-val">5.9</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+0.7 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+0.7 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+0.0</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0.0</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">2.5</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">5.0</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">7.5</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">10.0</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,108.2 C97.8,105.3 195.6,100.2 293.3,99.6 C391.1,99.1 488.9,105.4 586.7,105.0 C684.4,104.6 782.2,100.0 880.0,97.5" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="108.2" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="6.0"/>
<circle cx="293.3" cy="99.6" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="6.3"/>
<circle cx="586.7" cy="105.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="6.1"/>
<circle cx="880.0" cy="97.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="6.4"/>
<path d="M0.0,123.8 C97.8,122.7 195.6,122.2 293.3,120.6 C391.1,119.1 488.9,120.2 586.7,114.5 C684.4,108.8 782.2,95.8 880.0,86.5" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="123.8" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="5.4"/>
<circle cx="293.3" cy="120.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="5.5"/>
<circle cx="586.7" cy="114.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="5.8"/>
<circle cx="880.0" cy="86.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="6.8"/>
<path d="M0.0,95.1 C97.8,94.2 195.6,91.3 293.3,92.4 C391.1,93.4 488.9,101.4 586.7,101.4 C684.4,101.4 782.2,95.4 880.0,92.4" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="95.1" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="6.5"/>
<circle cx="293.3" cy="92.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="6.6"/>
<circle cx="586.7" cy="101.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="6.2"/>
<circle cx="880.0" cy="92.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="6.6"/>
<path d="M0.0,110.7 C97.8,104.3 195.6,93.1 293.3,91.5 C391.1,89.8 488.9,97.8 586.7,100.8 C684.4,103.9 782.2,106.9 880.0,109.9" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="110.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="5.9"/>
<circle cx="293.3" cy="91.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="6.6"/>
<circle cx="586.7" cy="100.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="6.3"/>
<circle cx="880.0" cy="109.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="5.9"/>
<text x="0.0" y="81.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">6.5</text>
<text x="0.0" y="95.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">6.0</text>
<text x="0.0" y="109.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">5.9</text>
<text x="0.0" y="123.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">5.4</text>
<text x="293.3" y="77.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">6.6</text>
<text x="293.3" y="91.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">6.6</text>
<text x="293.3" y="105.5" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">6.3</text>
<text x="293.3" y="119.5" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">5.5</text>
<text x="586.7" y="86.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">6.3</text>
<text x="586.7" y="100.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">6.2</text>
<text x="586.7" y="114.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">6.1</text>
<text x="586.7" y="128.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">5.8</text>
<text x="880.0" y="72.5" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">6.8</text>
<text x="880.0" y="86.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">6.6</text>
<text x="880.0" y="100.5" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">6.4</text>
<text x="880.0" y="114.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">5.9</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_9')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_9')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_9')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_10">
<h2 class="mv-metric-title">Value for Money (Dissatisfied)<span class="mv-metric-subtitle"> &mdash; How would you rate the value for money of our products? (1-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_10','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_10','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_10','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_10','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_10','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_10','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_10','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_10','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_10','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_10','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_10','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_10','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_10','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_10')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_10','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_10','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_10',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_10')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_10')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_10','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_10',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_10',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_10',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_10',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,14.0 39.3,11.2 58.0,13.4" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="13.4" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="22.7494831798534"><span class="tk-val">23%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="4.01736239379387"><span class="tk-val">4%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="8.38295496836621"><span class="tk-val">8%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="4.98757882667686"><span class="tk-val">5%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-3pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">-14pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-18pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,13.1 39.3,14.0 58.0,2.1" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.1" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="27.0734380708805"><span class="tk-val">27%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="7.65533813937521"><span class="tk-val">8%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="6.12903225806452"><span class="tk-val">6%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="26.979916635089"><span class="tk-val">27%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+21pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-21pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">0pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,4.3 20.7,14.0 39.3,2.0 58.0,10.1" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="10.1" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="16.3005491762356"><span class="tk-val">16%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="5.37798072044647"><span class="tk-val">5%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="18.9444572482139"><span class="tk-val">19%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="9.78679681479579"><span class="tk-val">10%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-9pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-7pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,14.0 39.3,11.8 58.0,13.6" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="13.6" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="26.3400872018466"><span class="tk-val">26%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="10.7727158318651"><span class="tk-val">11%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="13.5690540948927"><span class="tk-val">14%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="11.3370615149975"><span class="tk-val">11%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">-16pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">-16pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-13pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-15pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,208.6 C97.8,225.4 195.6,252.7 293.3,259.2 C391.1,265.6 488.9,247.8 586.7,247.4 C684.4,246.9 782.2,253.5 880.0,256.5" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="208.6" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="23%"/>
<circle cx="293.3" cy="259.2" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="4%"/>
<circle cx="586.7" cy="247.4" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="8%"/>
<circle cx="880.0" cy="256.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="5%"/>
<path d="M0.0,196.9 C97.8,214.4 195.6,239.9 293.3,249.3 C391.1,258.8 488.9,262.1 586.7,253.5 C684.4,244.8 782.2,215.9 880.0,197.2" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="196.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="27%"/>
<circle cx="293.3" cy="249.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="8%"/>
<circle cx="586.7" cy="253.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="6%"/>
<circle cx="880.0" cy="197.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="27%"/>
<path d="M0.0,226.0 C97.8,235.8 195.6,256.7 293.3,255.5 C391.1,254.3 488.9,220.8 586.7,218.8 C684.4,216.9 782.2,235.3 880.0,243.6" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="226.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="16%"/>
<circle cx="293.3" cy="255.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="5%"/>
<circle cx="586.7" cy="218.8" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="19%"/>
<circle cx="880.0" cy="243.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="10%"/>
<path d="M0.0,198.9 C97.8,212.9 195.6,235.2 293.3,240.9 C391.1,246.7 488.9,233.6 586.7,233.4 C684.4,233.1 782.2,237.4 880.0,239.4" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="198.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="26%"/>
<circle cx="293.3" cy="240.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="11%"/>
<circle cx="586.7" cy="233.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="14%"/>
<circle cx="880.0" cy="239.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="11%"/>
<text x="0.0" y="182.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">27%</text>
<text x="0.0" y="196.9" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">26%</text>
<text x="0.0" y="210.9" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">23%</text>
<text x="0.0" y="224.9" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">16%</text>
<text x="293.3" y="224.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">11%</text>
<text x="293.3" y="238.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">8%</text>
<text x="293.3" y="252.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">5%</text>
<text x="293.3" y="266.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">4%</text>
<text x="586.7" y="204.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">19%</text>
<text x="586.7" y="219.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">14%</text>
<text x="586.7" y="233.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">8%</text>
<text x="586.7" y="247.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">6%</text>
<text x="880.0" y="183.2" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">27%</text>
<text x="880.0" y="225.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">11%</text>
<text x="880.0" y="239.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">10%</text>
<text x="880.0" y="253.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">5%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_10')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_10')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_10')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_11">
<h2 class="mv-metric-title">Channel Usage<span class="mv-metric-subtitle"> &mdash; Which channels have you used in the past 3 months?</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_11','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_11','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_11','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_11','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_11','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_11','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_11','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_11','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_11','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_11','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_11','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_11','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_11','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_11')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_11','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_11','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_11',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_11')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_11')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_11','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_11',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_11',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_11',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_11',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n=""></td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n=""></td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n=""></td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n=""></td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val=""><span class="tk-val">&mdash;</span></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Durban" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Durban" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Durban" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Durban" data-sort-val=""><span class="tk-val">&mdash;</span></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val=""><span class="tk-val">&mdash;</span></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val=""><span class="tk-val">&mdash;</span></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val=""><span class="tk-val">&mdash;</span></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_11')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_11')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_11')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_12">
<h2 class="mv-metric-title">Purchase Intent (Average)<span class="mv-metric-subtitle"> &mdash; How likely are you to purchase from us in the next 6 months? (1-5)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_12','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_12','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_12','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_12','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_12','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_12','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_12','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_12','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_12','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_12','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_12','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_12','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_12','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_12')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_12','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_12','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_12',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_12')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_12')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_12','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_12',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_12',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_12',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_12',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.7 39.3,2.0 58.0,3.3" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="3.3" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="3.15382446908476"><span class="tk-val">3.2</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="3.21268932397488"><span class="tk-val">3.2</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="3.45729438034983"><span class="tk-val">3.5</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="3.42480412765144"><span class="tk-val">3.4</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">0.0 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,6.0 39.3,7.4 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="2.93569601753745"><span class="tk-val">2.9</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="3.36388602814967"><span class="tk-val">3.4</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="3.28903225806452"><span class="tk-val">3.3</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="3.58128078817734"><span class="tk-val">3.6</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">-0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+0.6</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,9.0 20.7,14.0 39.3,2.0 58.0,7.3" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="7.3" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="3.25761357963055"><span class="tk-val">3.3</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="2.98097412480974"><span class="tk-val">3.0</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="3.64761465775524"><span class="tk-val">3.6<span class="tk-sig tk-sig-up">&#x25B2;</span></span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="3.35242743385564"><span class="tk-val">3.4</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-up">+0.7 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.1</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,5.7 39.3,3.6 58.0,2.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="3.20030777122339"><span class="tk-val">3.2</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="3.33173923986912"><span class="tk-val">3.3</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="3.36536718041704"><span class="tk-val">3.4</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="3.3914590747331"><span class="tk-val">3.4</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+0.2</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+0.2</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0.0</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">1.2</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">2.5</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">3.8</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">5.0</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,99.7 C97.8,98.6 195.6,99.2 293.3,96.5 C391.1,93.8 488.9,85.2 586.7,83.3 C684.4,81.4 782.2,84.5 880.0,85.1" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="99.7" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="3.2"/>
<circle cx="293.3" cy="96.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="3.2"/>
<circle cx="586.7" cy="83.3" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="3.5"/>
<circle cx="880.0" cy="85.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="3.4"/>
<path d="M0.0,111.5 C97.8,103.8 195.6,91.5 293.3,88.4 C391.1,85.2 488.9,94.3 586.7,92.4 C684.4,90.4 782.2,81.9 880.0,76.6" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="111.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="2.9"/>
<circle cx="293.3" cy="88.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="3.4"/>
<circle cx="586.7" cy="92.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="3.3"/>
<circle cx="880.0" cy="76.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="3.6"/>
<path d="M0.0,94.1 C97.8,99.1 195.6,112.5 293.3,109.0 C391.1,105.5 488.9,76.4 586.7,73.0 C684.4,69.7 782.2,83.7 880.0,89.0" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="94.1" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="3.3"/>
<circle cx="293.3" cy="109.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="3.0"/>
<circle cx="586.7" cy="73.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="3.6"/>
<circle cx="880.0" cy="89.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="3.4"/>
<path d="M0.0,97.2 C97.8,94.8 195.6,91.6 293.3,90.1 C391.1,88.6 488.9,88.8 586.7,88.3 C684.4,87.7 782.2,87.3 880.0,86.9" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="97.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="3.2"/>
<circle cx="293.3" cy="90.1" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="3.3"/>
<circle cx="586.7" cy="88.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="3.4"/>
<circle cx="880.0" cy="86.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="3.4"/>
<text x="0.0" y="80.1" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">3.3</text>
<text x="0.0" y="94.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">3.2</text>
<text x="0.0" y="108.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">3.2</text>
<text x="0.0" y="122.1" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">2.9</text>
<text x="293.3" y="74.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">3.4</text>
<text x="293.3" y="88.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">3.3</text>
<text x="293.3" y="102.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">3.2</text>
<text x="293.3" y="116.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">3.0</text>
<text x="586.7" y="59.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">3.6</text>
<text x="586.7" y="73.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">3.5</text>
<text x="586.7" y="87.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">3.4</text>
<text x="586.7" y="101.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">3.3</text>
<text x="880.0" y="62.6" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">3.6</text>
<text x="880.0" y="76.6" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">3.4</text>
<text x="880.0" y="90.6" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">3.4</text>
<text x="880.0" y="104.6" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">3.4</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_12')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_12')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_12')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_13">
<h2 class="mv-metric-title">Purchase Intent (Positive)<span class="mv-metric-subtitle"> &mdash; How likely are you to purchase from us in the next 6 months? (1-5)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_13','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_13','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_13','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_13','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_13','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_13','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_13','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_13','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_13','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_13','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_13','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_13','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_13','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_13')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_13','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_13','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_13',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_13')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_13')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_13','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_13',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_13',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_13',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_13',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.6 39.3,2.0 58.0,7.7" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="7.7" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="35.7545574140199"><span class="tk-val">36%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="36.331732545253"><span class="tk-val">36%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="55.2754000744325"><span class="tk-val">55%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="45.9870055417543"><span class="tk-val">46%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+19pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-9pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+20pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+10pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.1 39.3,6.0 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="33.9422725611984"><span class="tk-val">34%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="40.3020940611054"><span class="tk-val">40%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="51.4838709677419"><span class="tk-val">51%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="60.0985221674877"><span class="tk-val">60%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+9pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+18pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+26pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,9.2 20.7,14.0 39.3,2.0 58.0,9.8" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="9.8" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="38.7668497254119"><span class="tk-val">39%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="22.0446473871131"><span class="tk-val">22%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="63.4708458170085"><span class="tk-val">63%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="36.6812227074236"><span class="tk-val">37%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+41pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-27pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+25pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-2pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.4 39.3,2.0 58.0,4.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="4.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="33.9317773788151"><span class="tk-val">34%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="47.5962748552731"><span class="tk-val">48%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="48.080991236023"><span class="tk-val">48%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="45.729537366548"><span class="tk-val">46%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+12pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,173.5 C97.8,172.9 195.6,180.7 293.3,171.9 C391.1,163.1 488.9,125.1 586.7,120.8 C684.4,116.4 782.2,137.5 880.0,145.8" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="173.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="36%"/>
<circle cx="293.3" cy="171.9" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="36%"/>
<circle cx="586.7" cy="120.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="55%"/>
<circle cx="880.0" cy="145.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="46%"/>
<path d="M0.0,178.4 C97.8,172.6 195.6,169.1 293.3,161.2 C391.1,153.3 488.9,139.9 586.7,131.0 C684.4,122.1 782.2,115.5 880.0,107.7" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="178.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="34%"/>
<circle cx="293.3" cy="161.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="40%"/>
<circle cx="586.7" cy="131.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="51%"/>
<circle cx="880.0" cy="107.7" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="60%"/>
<path d="M0.0,165.3 C97.8,180.4 195.6,221.6 293.3,210.5 C391.1,199.4 488.9,105.2 586.7,98.6 C684.4,92.0 782.2,146.9 880.0,171.0" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="165.3" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="39%"/>
<circle cx="293.3" cy="210.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="22%"/>
<circle cx="586.7" cy="98.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="63%"/>
<circle cx="880.0" cy="171.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="37%"/>
<path d="M0.0,178.4 C97.8,166.1 195.6,147.9 293.3,141.5 C391.1,135.1 488.9,139.3 586.7,140.2 C684.4,141.0 782.2,144.4 880.0,146.5" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="178.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="34%"/>
<circle cx="293.3" cy="141.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="48%"/>
<circle cx="586.7" cy="140.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="48%"/>
<circle cx="880.0" cy="146.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="46%"/>
<text x="0.0" y="151.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">39%</text>
<text x="0.0" y="165.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">36%</text>
<text x="0.0" y="179.3" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">34%</text>
<text x="0.0" y="193.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">34%</text>
<text x="293.3" y="127.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">48%</text>
<text x="293.3" y="147.2" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">40%</text>
<text x="293.3" y="161.2" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">36%</text>
<text x="293.3" y="196.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">22%</text>
<text x="586.7" y="84.6" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">63%</text>
<text x="586.7" y="106.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">55%</text>
<text x="586.7" y="120.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">51%</text>
<text x="586.7" y="134.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">48%</text>
<text x="880.0" y="93.7" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">60%</text>
<text x="880.0" y="131.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">46%</text>
<text x="880.0" y="145.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">46%</text>
<text x="880.0" y="159.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">37%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_13')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_13')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_13')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_14">
<h2 class="mv-metric-title">Purchase Intent (Negative)<span class="mv-metric-subtitle"> &mdash; How likely are you to purchase from us in the next 6 months? (1-5)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_14','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_14','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_14','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_14','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_14','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_14','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_14','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_14','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_14','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_14','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_14','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_14','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_14','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_14')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_14','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_14','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_14',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_14')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_14')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_14','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_14',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_14',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_14',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_14',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,6.8 39.3,14.0 58.0,12.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="12.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="23.9146776921631"><span class="tk-val">24%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="20.7148134466199"><span class="tk-val">21%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="15.863416449572"><span class="tk-val">16%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="17.2081024269062"><span class="tk-val">17%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">-8pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-7pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,13.4 39.3,8.9 58.0,14.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="14.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="31.8962367555718"><span class="tk-val">32%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="15.20768966701"><span class="tk-val">15%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="21.741935483871"><span class="tk-val">22%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="14.3615005683971"><span class="tk-val">14%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-7pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-18pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,7.8 20.7,2.0 39.3,14.0 58.0,11.5" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="11.5" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="18.4223664503245"><span class="tk-val">18%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="24.4545915778792"><span class="tk-val">24%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="11.892141046324"><span class="tk-val">12%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="14.46185461084"><span class="tk-val">14%</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-13pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+3pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-4pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,6.2 39.3,14.0 58.0,5.0" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="5.0" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="23.9548602205694"><span class="tk-val">24%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="21.0420337276617"><span class="tk-val">21%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="15.5636143850106"><span class="tk-val">16%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="21.8352821555669"><span class="tk-val">22%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+6pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-8pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,205.4 C97.8,208.3 195.6,210.4 293.3,214.1 C391.1,217.7 488.9,225.6 586.7,227.2 C684.4,228.7 782.2,224.7 880.0,223.5" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="205.4" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="24%"/>
<circle cx="293.3" cy="214.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="21%"/>
<circle cx="586.7" cy="227.2" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="16%"/>
<circle cx="880.0" cy="223.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="17%"/>
<path d="M0.0,183.9 C97.8,198.9 195.6,224.4 293.3,228.9 C391.1,233.5 488.9,210.9 586.7,211.3 C684.4,211.7 782.2,224.6 880.0,231.2" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="183.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="32%"/>
<circle cx="293.3" cy="228.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="15%"/>
<circle cx="586.7" cy="211.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="22%"/>
<circle cx="880.0" cy="231.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="14%"/>
<path d="M0.0,220.3 C97.8,214.8 195.6,201.0 293.3,204.0 C391.1,206.9 488.9,233.4 586.7,237.9 C684.4,242.4 782.2,233.3 880.0,231.0" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="220.3" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="18%"/>
<circle cx="293.3" cy="204.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="24%"/>
<circle cx="586.7" cy="237.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="12%"/>
<circle cx="880.0" cy="231.0" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="14%"/>
<path d="M0.0,205.3 C97.8,207.9 195.6,209.4 293.3,213.2 C391.1,217.0 488.9,228.3 586.7,228.0 C684.4,227.6 782.2,216.7 880.0,211.0" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="205.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="24%"/>
<circle cx="293.3" cy="213.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="21%"/>
<circle cx="586.7" cy="228.0" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="16%"/>
<circle cx="880.0" cy="211.0" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="22%"/>
<text x="0.0" y="169.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">32%</text>
<text x="0.0" y="191.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">24%</text>
<text x="0.0" y="205.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">24%</text>
<text x="0.0" y="219.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">18%</text>
<text x="293.3" y="190.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">24%</text>
<text x="293.3" y="204.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">21%</text>
<text x="293.3" y="218.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">21%</text>
<text x="293.3" y="232.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">15%</text>
<text x="586.7" y="197.3" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">22%</text>
<text x="586.7" y="213.2" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">16%</text>
<text x="586.7" y="227.2" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">16%</text>
<text x="586.7" y="241.2" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">12%</text>
<text x="880.0" y="197.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">22%</text>
<text x="880.0" y="211.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">17%</text>
<text x="880.0" y="225.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">14%</text>
<text x="880.0" y="239.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">14%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_14')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_14')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_14')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_15">
<h2 class="mv-metric-title">Net Promoter Score (NPS)<span class="mv-metric-subtitle"> &mdash; How likely are you to recommend us to a friend or colleague? (0-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_15','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_15','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_15','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_15','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_15','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_15','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_15','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_15','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_15','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_15','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_15','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_15','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_15','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_15')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_15','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_15','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_15',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_15')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_15')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_15','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_15',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_15',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_15',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_15',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,9.3 39.3,2.5 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="-25.5591054313099"><span class="tk-val">-25.56</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="-17.5009235315848"><span class="tk-val">-17.50</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="-5.87085969482694"><span class="tk-val">-5.87</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="-4.98757882667686"><span class="tk-val">-4.99</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+8.06 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">+11.63 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">+0.88 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+8.06 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+19.69</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+20.57</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,3.0 20.7,5.7 39.3,2.0 58.0,14.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="14.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="-23.1640482279869"><span class="tk-val">-23.16</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="-36.9378647442499"><span class="tk-val">-36.94</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="-18.1612903225806"><span class="tk-val">-18.16</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="-79.7650625236832"><span class="tk-val">-79.77</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">-13.77 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">+18.78 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">-61.6 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">-13.77 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+5</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-56.6</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,6.8 39.3,12.4 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="-23.8142785821268"><span class="tk-val">-23.81</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="22.0446473871131"><span class="tk-val">+22.04</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="-13.6897902742567"><span class="tk-val">-13.69</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="53.0439249935782"><span class="tk-val">+53.04<span class="tk-sig tk-sig-up">&#x25B2;</span></span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+45.86 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">-35.73 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-up">+66.73 <span class="sig-arrow">&#x2191;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+45.86 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+10.12</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+76.86</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,11.2 20.7,14.0 39.3,2.0 58.0,7.8" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="7.8" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="-29.0330854065145"><span class="tk-val">-29.03</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="-42.4867858041782"><span class="tk-val">-42.49</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="15.8960411000302"><span class="tk-val">+15.90</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="-12.2521606507372"><span class="tk-val">-12.25</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">-13.45 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">+58.38 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">-28.15 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">-13.45 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+44.93</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+16.78</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">-100.00</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">-50.00</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">+0.00</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">+50.00</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">+100.00</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,169.5 C97.8,165.9 195.6,163.1 293.3,158.6 C391.1,154.2 488.9,145.7 586.7,142.9 C684.4,140.1 782.2,142.1 880.0,141.7" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="169.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="-25.56"/>
<circle cx="293.3" cy="158.6" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="-17.50"/>
<circle cx="586.7" cy="142.9" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="-5.87"/>
<circle cx="880.0" cy="141.7" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="-4.99"/>
<path d="M0.0,166.3 C97.8,172.5 195.6,186.0 293.3,184.9 C391.1,183.7 488.9,149.9 586.7,159.5 C684.4,169.2 782.2,215.0 880.0,242.7" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="166.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="-23.16"/>
<circle cx="293.3" cy="184.9" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="-36.94"/>
<circle cx="586.7" cy="159.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="-18.16"/>
<circle cx="880.0" cy="242.7" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="-79.77"/>
<path d="M0.0,167.1 C97.8,146.5 195.6,107.5 293.3,105.2 C391.1,103.0 488.9,160.5 586.7,153.5 C684.4,146.5 782.2,93.4 880.0,63.4" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="167.1" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="-23.81"/>
<circle cx="293.3" cy="105.2" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="+22.04"/>
<circle cx="586.7" cy="153.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="-13.69"/>
<circle cx="880.0" cy="63.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="+53.04"/>
<path d="M0.0,174.2 C97.8,180.2 195.6,202.5 293.3,192.4 C391.1,182.2 488.9,120.3 586.7,113.5 C684.4,106.7 782.2,138.9 880.0,151.5" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="174.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="-29.03"/>
<circle cx="293.3" cy="192.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="-42.49"/>
<circle cx="586.7" cy="113.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="+15.90"/>
<circle cx="880.0" cy="151.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="-12.25"/>
<text x="0.0" y="152.3" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">-23.16</text>
<text x="0.0" y="166.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">-23.81</text>
<text x="0.0" y="180.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">-25.56</text>
<text x="0.0" y="194.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">-29.03</text>
<text x="293.3" y="91.2" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">+22.04</text>
<text x="293.3" y="144.6" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">-17.50</text>
<text x="293.3" y="170.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">-36.94</text>
<text x="293.3" y="184.9" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">-42.49</text>
<text x="586.7" y="99.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">+15.90</text>
<text x="586.7" y="128.9" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">-5.87</text>
<text x="586.7" y="142.9" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">-13.69</text>
<text x="586.7" y="156.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">-18.16</text>
<text x="880.0" y="49.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">+53.04</text>
<text x="880.0" y="127.7" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">-4.99</text>
<text x="880.0" y="141.7" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">-12.25</text>
<text x="880.0" y="228.7" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">-79.77</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_15')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_15')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_15')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_16">
<h2 class="mv-metric-title">Net Promoter Score (% Promoters)<span class="mv-metric-subtitle"> &mdash; How likely are you to recommend us to a friend or colleague? (0-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_16','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_16','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_16','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_16','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_16','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_16','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_16','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_16','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_16','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_16','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_16','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_16','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_16','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_16')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_16','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_16','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_16',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_16')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_16')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_16','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_16',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_16',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_16',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_16',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,9.8 39.3,6.4 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="21.6594625070475"><span class="tk-val">22%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="25.5264130033247"><span class="tk-val">26%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="28.5913658355043"><span class="tk-val">29%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="32.6008025988916"><span class="tk-val">33%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">+3pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+11pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,6.3 39.3,4.4 58.0,14.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="14.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="26.3792473511144"><span class="tk-val">26%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="17.0271198077583"><span class="tk-val">17%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="21.0967741935484"><span class="tk-val">21%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="0"><span class="tk-val">0%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">-21pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">-26pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,6.5 39.3,12.8 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="18.9965052421368"><span class="tk-val">19%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="44.9264332825977"><span class="tk-val">45%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="23.0006914035492"><span class="tk-val">23%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="60.6473156948369"><span class="tk-val">61%<span class="tk-sig tk-sig-up">&#x25B2;</span></span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+26pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">-22pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-up">+38pp <span class="sig-arrow">&#x2191;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+26pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+42pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,10.6 20.7,14.0 39.3,2.0 58.0,8.4" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="8.4" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="21.082328802257"><span class="tk-val">21%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="12.5094387113013"><span class="tk-val">13%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="42.9434874584467"><span class="tk-val">43%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="26.7158108795119"><span class="tk-val">27%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">+30pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">-16pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+22pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+6pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,211.5 C97.8,208.0 195.6,204.2 293.3,201.1 C391.1,198.0 488.9,196.0 586.7,192.8 C684.4,189.6 782.2,185.6 880.0,182.0" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="211.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="22%"/>
<circle cx="293.3" cy="201.1" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="26%"/>
<circle cx="586.7" cy="192.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="29%"/>
<circle cx="880.0" cy="182.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="33%"/>
<path d="M0.0,198.8 C97.8,207.2 195.6,221.6 293.3,224.0 C391.1,226.4 488.9,205.4 586.7,213.0 C684.4,220.7 782.2,251.0 880.0,270.0" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="198.8" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="26%"/>
<circle cx="293.3" cy="224.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="17%"/>
<circle cx="586.7" cy="213.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="21%"/>
<circle cx="880.0" cy="270.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="0%"/>
<path d="M0.0,218.7 C97.8,195.4 195.6,150.5 293.3,148.7 C391.1,146.9 488.9,215.0 586.7,207.9 C684.4,200.8 782.2,140.1 880.0,106.3" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="218.7" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="19%"/>
<circle cx="293.3" cy="148.7" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="45%"/>
<circle cx="586.7" cy="207.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="23%"/>
<circle cx="880.0" cy="106.3" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="61%"/>
<path d="M0.0,213.1 C97.8,220.8 195.6,246.1 293.3,236.2 C391.1,226.4 488.9,160.4 586.7,154.1 C684.4,147.7 782.2,183.3 880.0,197.9" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="213.1" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="21%"/>
<circle cx="293.3" cy="236.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="13%"/>
<circle cx="586.7" cy="154.1" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="43%"/>
<circle cx="880.0" cy="197.9" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="27%"/>
<text x="0.0" y="184.8" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">26%</text>
<text x="0.0" y="198.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">22%</text>
<text x="0.0" y="212.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">21%</text>
<text x="0.0" y="226.8" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">19%</text>
<text x="293.3" y="134.7" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">45%</text>
<text x="293.3" y="187.1" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">26%</text>
<text x="293.3" y="210.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">17%</text>
<text x="293.3" y="224.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">13%</text>
<text x="586.7" y="140.1" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">43%</text>
<text x="586.7" y="178.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">29%</text>
<text x="586.7" y="193.9" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">23%</text>
<text x="586.7" y="207.9" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">21%</text>
<text x="880.0" y="92.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">61%</text>
<text x="880.0" y="168.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">33%</text>
<text x="880.0" y="183.9" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">27%</text>
<text x="880.0" y="256.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">0%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_16')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_16')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_16')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_17">
<h2 class="mv-metric-title">Net Promoter Score (% Detractors)<span class="mv-metric-subtitle"> &mdash; How likely are you to recommend us to a friend or colleague? (0-10)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_17','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_17','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_17','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_17','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_17','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_17','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_17','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_17','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_17','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_17','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_17','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_17','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_17','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_17')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_17','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_17','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_17',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_17')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_17')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_17','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_17',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_17',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_17',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_17',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,5.9 39.3,14.0 58.0,11.1" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="11.1" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="47.2185679383575"><span class="tk-val">47%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="43.0273365349095"><span class="tk-val">43%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="34.4622255303312"><span class="tk-val">34%</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="37.5883814255685"><span class="tk-val">38%</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">-4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">+3pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val not-sig">-4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">-13pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">-10pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,11.0 20.7,9.6 39.3,14.0 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="49.5432955791012"><span class="tk-val">50%</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="53.9649845520082"><span class="tk-val">54%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="39.258064516129"><span class="tk-val">39%</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="79.7650625236832"><span class="tk-val">80%</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">-15pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">+41pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+30pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,8.8 39.3,4.1 58.0,14.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="14.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="42.8107838242636"><span class="tk-val">43%</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="22.8817858954845"><span class="tk-val">23%</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="36.6904816778059"><span class="tk-val">37%</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="7.60339070125867"><span class="tk-val">8%<span class="tk-sig tk-sig-down">&#x25BC;</span></span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">-20pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">+14pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-down">-29pp <span class="sig-arrow">&#x2193;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">-20pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">-35pp</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,4.1 20.7,2.0 39.3,14.0 58.0,8.9" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="8.9" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="50.1154142087715"><span class="tk-val">50%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="54.9962245154795"><span class="tk-val">55%</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="27.0474463584164"><span class="tk-val">27%</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="38.9679715302491"><span class="tk-val">39%</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+5pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">-28pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">+12pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val not-sig">+5pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">-23pp</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">-11pp</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0%</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">25%</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">50%</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">75%</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">100%</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,142.5 C97.8,146.3 195.6,148.1 293.3,153.8 C391.1,159.6 488.9,174.5 586.7,177.0 C684.4,179.4 782.2,171.3 880.0,168.5" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="142.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="47%"/>
<circle cx="293.3" cy="153.8" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="43%"/>
<circle cx="586.7" cy="177.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="34%"/>
<circle cx="880.0" cy="168.5" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="38%"/>
<path d="M0.0,136.2 C97.8,132.3 195.6,119.7 293.3,124.3 C391.1,128.9 488.9,175.6 586.7,164.0 C684.4,152.4 782.2,91.1 880.0,54.6" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="136.2" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="50%"/>
<circle cx="293.3" cy="124.3" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="54%"/>
<circle cx="586.7" cy="164.0" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="39%"/>
<circle cx="880.0" cy="54.6" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="80%"/>
<path d="M0.0,154.4 C97.8,172.3 195.6,205.5 293.3,208.2 C391.1,211.0 488.9,164.1 586.7,170.9 C684.4,177.8 782.2,223.3 880.0,249.5" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="154.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="43%"/>
<circle cx="293.3" cy="208.2" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="23%"/>
<circle cx="586.7" cy="170.9" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="37%"/>
<circle cx="880.0" cy="249.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="8%"/>
<path d="M0.0,134.7 C97.8,130.3 195.6,111.1 293.3,121.5 C391.1,131.9 488.9,189.8 586.7,197.0 C684.4,204.2 782.2,175.5 880.0,164.8" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="134.7" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="50%"/>
<circle cx="293.3" cy="121.5" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="55%"/>
<circle cx="586.7" cy="197.0" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="27%"/>
<circle cx="880.0" cy="164.8" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="39%"/>
<text x="0.0" y="120.7" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">50%</text>
<text x="0.0" y="134.7" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">50%</text>
<text x="0.0" y="148.7" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">47%</text>
<text x="0.0" y="162.7" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">43%</text>
<text x="293.3" y="107.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">55%</text>
<text x="293.3" y="121.5" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">54%</text>
<text x="293.3" y="139.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">43%</text>
<text x="293.3" y="194.2" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">23%</text>
<text x="586.7" y="150.0" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">39%</text>
<text x="586.7" y="164.0" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">37%</text>
<text x="586.7" y="178.0" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">34%</text>
<text x="586.7" y="192.0" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">27%</text>
<text x="880.0" y="40.6" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">80%</text>
<text x="880.0" y="150.8" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">39%</text>
<text x="880.0" y="164.8" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">38%</text>
<text x="880.0" y="235.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">8%</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_17')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_17')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_17')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div>
<div class="tk-metric-panel" id="mv-metric_18">
<h2 class="mv-metric-title">Customer Experience Index<span class="mv-metric-subtitle"> &mdash; Customer Experience Index (Satisfaction + Service + Value)</span></h2>
<div class="mv-segment-chips mv-segment-grouped">
<span class="mv-segment-chips-label">Segments:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleSegmentChip('metric_18','Total',this)">Total</button>
<button class="mv-groups-toggle" onclick="toggleSegmentGroups(this)">+ Segments</button>
<div class="mv-segment-group" data-group="Region">
<button class="mv-segment-group-header" data-group="Region" onclick="toggleSegmentGroupExpand('metric_18','Region',this)">Region <span class="chevron">&#x25B6;</span></button>
<div class="mv-segment-group-chips">
<button class="tk-segment-chip" data-segment="Region_Durban" data-group="Region" style="--chip-color:#CC9900" onclick="toggleSegmentChip('metric_18','Region_Durban',this)">Durban</button>
<button class="tk-segment-chip" data-segment="Region_Cape Town" data-group="Region" style="--chip-color:#2E8B57" onclick="toggleSegmentChip('metric_18','Region_Cape Town',this)">Cape Town</button>
<button class="tk-segment-chip" data-segment="Region_Joburg" data-group="Region" style="--chip-color:#CD5C5C" onclick="toggleSegmentChip('metric_18','Region_Joburg',this)">Joburg</button>
</div>
</div>
</div>
<div class="mv-wave-chips">
<span class="mv-wave-chips-label">Waves:</span>
<button class="tk-wave-chip active" data-wave="W1" onclick="toggleWaveChip('metric_18','W1',this)">Jan 2024</button>
<button class="tk-wave-chip active" data-wave="W2" onclick="toggleWaveChip('metric_18','W2',this)">Apr 2024</button>
<button class="tk-wave-chip active" data-wave="W3" onclick="toggleWaveChip('metric_18','W3',this)">Jul 2024</button>
<button class="tk-wave-chip active" data-wave="W4" onclick="toggleWaveChip('metric_18','W4',this)">Oct 2024</button>
</div>
<div class="mv-chart-segment-chips" style="display:none">
<span class="mv-wave-chips-label">Chart:</span>
<button class="tk-segment-chip active" data-segment="Total" style="--chip-color:#323367" onclick="toggleChartSegment('metric_18','Total',this)">Total</button>
<button class="tk-segment-chip active" data-segment="Region_Durban" style="--chip-color:#CC9900" onclick="toggleChartSegment('metric_18','Region_Durban',this)">Region_Durban</button>
<button class="tk-segment-chip active" data-segment="Region_Cape Town" style="--chip-color:#2E8B57" onclick="toggleChartSegment('metric_18','Region_Cape Town',this)">Region_Cape Town</button>
<button class="tk-segment-chip active" data-segment="Region_Joburg" style="--chip-color:#CD5C5C" onclick="toggleChartSegment('metric_18','Region_Joburg',this)">Region_Joburg</button>
</div>
<div class="mv-controls">
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricCounts('metric_18')"><span class="tk-toggle-label">Show count</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_18','vs-prev')"><span class="tk-toggle-label">vs Previous</span></label>
<label class="tk-toggle"><input type="checkbox" onchange="toggleMetricChangeRows('metric_18','vs-base')"><span class="tk-toggle-label">vs Baseline</span></label>
</div>
<div class="mv-control-group">
<label class="tk-toggle"><input type="checkbox" class="mv-show-chart-cb" onchange="toggleShowChart('metric_18',this.checked)"><span class="tk-toggle-label">Show chart</span></label>
</div>
<button class="export-btn" onclick="exportMetricExcel('metric_18')" title="Export to Excel">&#x2B73; Export Excel</button>
<button class="export-btn" onclick="pinMetricView('metric_18')" title="Pin this view">&#x1F4CC; Pin</button>
<button class="export-btn" onclick="exportSlidePNG('metric_18','table')" title="Export as slide">&#x1F4F8; Export Slide</button>
</div>
<div class="mv-table-area">
<div class="tk-table-wrapper">
<table class="tk-table mv-metric-table">
<thead>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col">Segment</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W1" data-col-index="1" onclick="sortMetricTable('metric_18',1,this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W2" data-col-index="2" onclick="sortMetricTable('metric_18',2,this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W3" data-col-index="3" onclick="sortMetricTable('metric_18',3,this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-wave="W4" data-col-index="4" onclick="sortMetricTable('metric_18',4,this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-wave="W1" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W2" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W3" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-wave="W4" data-n="100">100</td>
</tr>
<tr class="tk-metric-row" data-segment="Total">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#323367"></span><span class="tk-metric-label">Total</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,5.3 39.3,5.9 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Total" data-sort-val="6.44496648499655"><span class="tk-val">6.4</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Total" data-sort-val="6.76800886590321"><span class="tk-val">6.8<span class="tk-sig tk-sig-up">&#x25B2;</span></span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Total" data-sort-val="6.74578216102221"><span class="tk-val">6.7</span><div class="tk-freq">n=100</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Total" data-sort-val="6.89228613287471"><span class="tk-val">6.9</span><div class="tk-freq">n=100</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-up">+0.3 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val not-sig">0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-segment="Total">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Total"><span class="change-val sig-up">+0.3 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Total"><span class="change-val sig-na">+0.4</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CC9900"></span><span class="tk-metric-label">Region_Durban</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.2 39.3,11.0 58.0,2.0" fill="none" stroke="#CC9900" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#CC9900"/></svg></span></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W1" data-segment="Region_Durban" data-sort-val="6.42881500426257"><span class="tk-val">6.4</span><div class="tk-freq">n=26</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W2" data-segment="Region_Durban" data-sort-val="6.47682801235839"><span class="tk-val">6.5</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W3" data-segment="Region_Durban" data-sort-val="6.61387096774194"><span class="tk-val">6.6</span><div class="tk-freq">n=29</div></td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-wave="W4" data-segment="Region_Durban" data-sort-val="7.16647720095996"><span class="tk-val">7.2</span><div class="tk-freq">n=25</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Durban">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Durban"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Durban"><span class="change-val sig-na">+0.2</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Durban"><span class="change-val sig-na">+0.7</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#2E8B57"></span><span class="tk-metric-label">Region_Cape Town</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,7.2 39.3,12.7 58.0,2.0" fill="none" stroke="#2E8B57" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#2E8B57"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Cape Town" data-sort-val="6.65019137959727"><span class="tk-val">6.7</span><div class="tk-freq">n=38</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Cape Town" data-sort-val="6.8361237950279"><span class="tk-val">6.8</span><div class="tk-freq">n=35</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Cape Town" data-sort-val="6.68656372436045"><span class="tk-val">6.7</span><div class="tk-freq">n=40</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Cape Town" data-sort-val="6.97876530524874"><span class="tk-val">7.0</span><div class="tk-freq">n=37</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Cape Town">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.0</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.3</span></td>
</tr>
<tr class="tk-metric-row segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col"><span class="tk-seg-dot" style="background:#CD5C5C"></span><span class="tk-metric-label">Region_Joburg</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.6 39.3,2.0 58.0,7.5" fill="none" stroke="#CD5C5C" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="7.5" r="2" fill="#CD5C5C"/></svg></span></td>
<td class="tk-td tk-value-cell" data-wave="W1" data-segment="Region_Joburg" data-sort-val="6.24544755065401"><span class="tk-val">6.2</span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W2" data-segment="Region_Joburg" data-sort-val="6.91391895293229"><span class="tk-val">6.9<span class="tk-sig tk-sig-up">&#x25B2;</span></span><div class="tk-freq">n=36</div></td>
<td class="tk-td tk-value-cell" data-wave="W3" data-segment="Region_Joburg" data-sort-val="6.94701319633323"><span class="tk-val">6.9</span><div class="tk-freq">n=31</div></td>
<td class="tk-td tk-value-cell" data-wave="W4" data-segment="Region_Joburg" data-sort-val="6.62277580071174"><span class="tk-val">6.6</span><div class="tk-freq">n=38</div></td>
</tr>
<tr class="tk-change-row tk-vs-prev segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Prev</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-up">+0.7 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base segment-hidden" data-segment="Region_Joburg">
<td class="tk-td tk-label-col tk-change-label">vs Base</td>
<td class="tk-td tk-change-cell" data-wave="W1" data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-wave="W2" data-segment="Region_Joburg"><span class="change-val sig-up">+0.7 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-wave="W3" data-segment="Region_Joburg"><span class="change-val sig-na">+0.7</span></td>
<td class="tk-td tk-change-cell" data-wave="W4" data-segment="Region_Joburg"><span class="change-val sig-na">+0.4</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="mv-chart-area" style="display:none"><svg class="tk-line-chart" width="100%" height="auto" viewBox="0 0 960 410" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
<rect width="960" height="410" fill="#ffffff" rx="6"/>
<g transform="translate(60,30)">
<line x1="0" y1="270.0" x2="880" y2="270.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="270.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">0.0</text>
<line x1="0" y1="202.5" x2="880" y2="202.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="202.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">2.5</text>
<line x1="0" y1="135.0" x2="880" y2="135.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="135.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">5.0</text>
<line x1="0" y1="67.5" x2="880" y2="67.5" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="67.5" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">7.5</text>
<line x1="0" y1="0.0" x2="880" y2="0.0" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>
<text x="-10" y="0.0" text-anchor="end" fill="#666" font-size="12" font-weight="500" dy="0.35em">10.0</text>
<text x="0.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W1">Jan 2024</text>
<line x1="0.0" y1="270" x2="0.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W1"/>
<text x="293.3" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W2">Apr 2024</text>
<line x1="293.3" y1="270" x2="293.3" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W2"/>
<text x="586.7" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W3">Jul 2024</text>
<line x1="586.7" y1="270" x2="586.7" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W3"/>
<text x="880.0" y="294" text-anchor="middle" fill="#666" font-size="13" font-weight="600" class="tk-chart-xaxis" data-wave="W4">Oct 2024</text>
<line x1="880.0" y1="270" x2="880.0" y2="275" stroke="#ccc" stroke-width="1" class="tk-chart-tick" data-wave="W4"/>
<path d="M0.0,96.0 C97.8,93.1 195.6,88.6 293.3,87.3 C391.1,85.9 488.9,88.4 586.7,87.9 C684.4,87.3 782.2,85.2 880.0,83.9" fill="none" stroke="#323367" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Total"/>
<circle cx="0.0" cy="96.0" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W1" data-value="6.4"/>
<circle cx="293.3" cy="87.3" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W2" data-value="6.8"/>
<circle cx="586.7" cy="87.9" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W3" data-value="6.7"/>
<circle cx="880.0" cy="83.9" r="5" fill="#323367" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Total" data-wave="W4" data-value="6.9"/>
<path d="M0.0,96.4 C97.8,96.0 195.6,96.0 293.3,95.1 C391.1,94.3 488.9,94.5 586.7,91.4 C684.4,88.3 782.2,81.5 880.0,76.5" fill="none" stroke="#CC9900" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Durban"/>
<circle cx="0.0" cy="96.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W1" data-value="6.4"/>
<circle cx="293.3" cy="95.1" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W2" data-value="6.5"/>
<circle cx="586.7" cy="91.4" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W3" data-value="6.6"/>
<circle cx="880.0" cy="76.5" r="5" fill="#CC9900" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Durban" data-wave="W4" data-value="7.2"/>
<path d="M0.0,90.4 C97.8,88.8 195.6,85.6 293.3,85.4 C391.1,85.3 488.9,90.1 586.7,89.5 C684.4,88.8 782.2,84.2 880.0,81.6" fill="none" stroke="#2E8B57" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Cape Town"/>
<circle cx="0.0" cy="90.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W1" data-value="6.7"/>
<circle cx="293.3" cy="85.4" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W2" data-value="6.8"/>
<circle cx="586.7" cy="89.5" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W3" data-value="6.7"/>
<circle cx="880.0" cy="81.6" r="5" fill="#2E8B57" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Cape Town" data-wave="W4" data-value="7.0"/>
<path d="M0.0,101.4 C97.8,95.4 195.6,86.5 293.3,83.3 C391.1,80.2 488.9,81.1 586.7,82.4 C684.4,83.7 782.2,88.3 880.0,91.2" fill="none" stroke="#CD5C5C" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" opacity="1" class="tk-chart-line" data-segment="Region_Joburg"/>
<circle cx="0.0" cy="101.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W1" data-value="6.2"/>
<circle cx="293.3" cy="83.3" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W2" data-value="6.9"/>
<circle cx="586.7" cy="82.4" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W3" data-value="6.9"/>
<circle cx="880.0" cy="91.2" r="5" fill="#CD5C5C" stroke="#fff" stroke-width="2.5" class="tk-chart-point" data-segment="Region_Joburg" data-wave="W4" data-value="6.6"/>
<text x="0.0" y="76.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W1">6.7</text>
<text x="0.0" y="90.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W1">6.4</text>
<text x="0.0" y="104.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W1">6.4</text>
<text x="0.0" y="118.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W1">6.2</text>
<text x="293.3" y="69.3" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W2">6.9</text>
<text x="293.3" y="83.3" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W2">6.8</text>
<text x="293.3" y="97.3" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W2">6.8</text>
<text x="293.3" y="111.3" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W2">6.5</text>
<text x="586.7" y="68.4" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W3">6.9</text>
<text x="586.7" y="82.4" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W3">6.7</text>
<text x="586.7" y="96.4" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W3">6.7</text>
<text x="586.7" y="110.4" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W3">6.6</text>
<text x="880.0" y="62.5" text-anchor="middle" fill="#CC9900" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Durban" data-wave="W4">7.2</text>
<text x="880.0" y="76.5" text-anchor="middle" fill="#2E8B57" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Cape Town" data-wave="W4">7.0</text>
<text x="880.0" y="90.5" text-anchor="middle" fill="#323367" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Total" data-wave="W4">6.9</text>
<text x="880.0" y="104.5" text-anchor="middle" fill="#CD5C5C" font-size="12" font-weight="700" class="tk-chart-label" data-segment="Region_Joburg" data-wave="W4">6.6</text>
</g>
<g class="tk-chart-legend-item" data-segment="Total">
<rect x="223.5" y="392.0" width="16" height="4" rx="2" fill="#323367"/>
<text x="245.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Total</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Durban">
<rect x="304.5" y="392.0" width="16" height="4" rx="2" fill="#CC9900"/>
<text x="326.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Durban</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Cape Town">
<rect x="441.5" y="392.0" width="16" height="4" rx="2" fill="#2E8B57"/>
<text x="463.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Cape Town</text>
</g>
<g class="tk-chart-legend-item" data-segment="Region_Joburg">
<rect x="599.5" y="392.0" width="16" height="4" rx="2" fill="#CD5C5C"/>
<text x="621.5" y="393.0" fill="#555" font-size="12" font-weight="600" dy="0.35em">Region_Joburg</text>
</g>
</svg></div>
<div class="insight-area">
<button class="insight-toggle" onclick="toggleMetricInsight('metric_18')">+ Add Insight</button>
<div class="insight-container" style="display:none">
<div class="insight-editor" contenteditable="true" data-placeholder="Type key insight here..." oninput="syncMetricInsight('metric_18')"></div>
<button class="insight-dismiss" title="Delete insight" onclick="dismissMetricInsight('metric_18')">&times;</button>
</div>
<textarea class="insight-store" style="display:none"></textarea>
</div>
</div></main>
    </div>
  </div>
  <div id="tab-overview" class="tab-panel">
    <div class="tk-layout">
      <aside class="tk-sidebar">
        <div class="tk-sidebar-inner">
          <div class="tk-sidebar-nav-card">
            <div class="tk-sidebar-header">Segments (4)</div>
            <div class="tk-sidebar-nav-scroll">
              <nav class="tk-sidebar-nav"><a class="tk-sidebar-item tk-seg-sidebar-item active" data-segment="Total" href="#" onclick="switchSegment('Total');return false;"><span class="tk-seg-dot" style="background:#323367"></span>Total</a>
<div class="tk-sidebar-section" data-group-segments="Region_Durban,Region_Cape Town,Region_Joburg" onclick="showBannerGroup('Region',this);return false;" title="Show all Region segments">Region</div>
<a class="tk-sidebar-item tk-seg-sidebar-item" data-segment="Region_Durban" data-group="Region" href="#" onclick="switchSegment('Region_Durban');return false;"><span class="tk-seg-dot" style="background:#CC9900"></span>Durban</a>
<a class="tk-sidebar-item tk-seg-sidebar-item" data-segment="Region_Cape Town" data-group="Region" href="#" onclick="switchSegment('Region_Cape Town');return false;"><span class="tk-seg-dot" style="background:#2E8B57"></span>Cape Town</a>
<a class="tk-sidebar-item tk-seg-sidebar-item" data-segment="Region_Joburg" data-group="Region" href="#" onclick="switchSegment('Region_Joburg');return false;"><span class="tk-seg-dot" style="background:#CD5C5C"></span>Joburg</a></nav>
            </div>
          </div>
          <div class="legend-box">
            <div class="legend-title">Legend</div>
            <div class="legend-item">
              <span class="tk-sig tk-sig-up">â–²</span>
              <span>Significantly higher than previous wave</span>
            </div>
            <div class="legend-item">
              <span class="tk-sig tk-sig-down">â–¼</span>
              <span>Significantly lower than previous wave</span>
            </div>
            <div class="legend-item">
              <span style="color:#94a3b8;font-size:12px">3.80</span>
              <span>Low base â€” values in grey (n&lt;30)</span>
            </div>
            <div class="legend-item">
              <span style="color:#e8614d;font-weight:700;font-size:11px">âš  28</span>
              <span>Low base warning in base row (n&lt;30)</span>
            </div>
          </div>
        </div>
      </aside>
      <main class="tk-content">
        <div class="tk-controls">
          <div class="tk-control-group">
            <input type="text" class="tk-search-input tk-overview-search" placeholder="Filter rows..." oninput="filterOverviewRows(this.value)"/>
          </div>
          <div class="tk-control-group tk-overview-type-filter">
<button class="mv-type-chip tk-overview-type-chip active" data-type-filter="all" onclick="filterOverviewByType('all')">All</button>
<button class="mv-type-chip tk-overview-type-chip" data-type-filter="mean" onclick="filterOverviewByType('mean')">Mean / Rating</button>
<button class="mv-type-chip tk-overview-type-chip" data-type-filter="pct" onclick="filterOverviewByType('pct')">% / Top Box</button>
<button class="mv-type-chip tk-overview-type-chip" data-type-filter="nps" onclick="filterOverviewByType('nps')">NPS</button>
</div>
          <div class="tk-control-group">
            <label class="tk-toggle">
              <input type="checkbox" id="toggle-vs-prev" onchange="toggleChangeRows(&#39;vs-prev&#39;)"/>
              <span class="tk-toggle-label">vs Previous</span>
            </label>
            <label class="tk-toggle">
              <input type="checkbox" id="toggle-vs-base" onchange="toggleChangeRows(&#39;vs-base&#39;)"/>
              <span class="tk-toggle-label">vs Baseline</span>
            </label>
            <label class="tk-toggle">
              <input type="checkbox" id="toggle-sparklines" checked="checked" onchange="toggleSparklines()"/>
              <span class="tk-toggle-label">Sparklines</span>
            </label>
          </div>
          <div class="tk-control-group">
            <button class="tk-btn tk-btn-view tk-btn-active" id="btn-table-view" onclick="switchView(&#39;table&#39;)">Table</button>
            <button class="tk-btn tk-btn-view" id="btn-chart-view" onclick="switchView(&#39;chart&#39;)">Charts</button>
          </div>
          <div class="tk-control-group">
            <span class="tk-control-label">Group by:</span>
            <select class="tk-select" id="group-by-select" onchange="switchGroupBy(this.value)">
              <option value="section" selected="selected">Section</option>
              <option value="metric_type">Metric Type</option>
              <option value="question">Question</option>
            </select>
          </div>
          <div class="tk-control-group">
            <span class="tk-control-label">Sort by:</span>
            <select class="tk-select" id="sort-by-select" onchange="sortOverviewBy(this.value)">
              <option value="original" selected="selected">Original Order</option>
              <option value="metric_name">Metric Name (Aâ†’Z)</option>
              <option value="metric_name_desc">Metric Name (Zâ†’A)</option>
            </select>
          </div>
          <div class="tk-control-group" id="hidden-rows-indicator" style="display:none">
            <span class="tk-control-label" id="hidden-rows-count">0 greyed out</span>
            <button class="tk-btn tk-btn-sm" onclick="showAllHiddenRows()">Show All</button>
          </div>
          <div class="tk-control-group tk-export-group">
            <button class="tk-btn tk-btn-export" onclick="exportCSV()">Export CSV</button>
            <button class="tk-btn tk-btn-export" onclick="exportExcel()">Export Excel</button>
            <button class="tk-btn" onclick="toggleHelpOverlay()">?</button>
          </div>
        </div>
        <div class="overview-actions-bar">
          <button class="tk-btn" onclick="pinOverviewView()">&#x1F4CC; Pin Current View</button>
          <button class="tk-btn" onclick="exportOverviewSlide()">&#x1F4F8; Export Slide</button>
        </div>
        <div class="tk-main-area">
          <div class="tk-table-panel"><div class="tk-segment-showing" id="tk-segment-showing">Showing: <strong>Total</strong></div>
<div class="tk-table-wrapper">
<table class="tk-table" id="tk-crosstab-table">
<thead>
<tr class="tk-segment-indicator-row">
<th class="tk-segment-indicator tk-sticky-col"></th>
<th class="tk-segment-indicator" data-segment="Total" colspan="4" style="background-color:#323367;color:#ffffff;font-size:11px;font-weight:600;text-align:center;letter-spacing:0.02em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Total</th>
<th class="tk-segment-indicator" data-segment="Region_Durban" colspan="4" style="background-color:#CC9900;color:#1e293b;font-size:11px;font-weight:600;text-align:center;letter-spacing:0.02em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Region_Durban</th>
<th class="tk-segment-indicator" data-segment="Region_Cape Town" colspan="4" style="background-color:#2E8B57;color:#ffffff;font-size:11px;font-weight:600;text-align:center;letter-spacing:0.02em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Region_Cape Town</th>
<th class="tk-segment-indicator" data-segment="Region_Joburg" colspan="4" style="background-color:#CD5C5C;color:#ffffff;font-size:11px;font-weight:600;text-align:center;letter-spacing:0.02em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">Region_Joburg</th>
</tr>
<tr class="tk-wave-header-row">
<th class="tk-th tk-label-col tk-sticky-col">Metric</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Total" data-wave="W1" data-col-index="1" onclick="sortOverviewColumn(this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Total" data-wave="W2" data-col-index="2" onclick="sortOverviewColumn(this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Total" data-wave="W3" data-col-index="3" onclick="sortOverviewColumn(this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Total" data-wave="W4" data-col-index="4" onclick="sortOverviewColumn(this)" title="Click to sort">Oct 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Durban" data-wave="W1" data-col-index="5" onclick="sortOverviewColumn(this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Durban" data-wave="W2" data-col-index="6" onclick="sortOverviewColumn(this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Durban" data-wave="W3" data-col-index="7" onclick="sortOverviewColumn(this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Durban" data-wave="W4" data-col-index="8" onclick="sortOverviewColumn(this)" title="Click to sort">Oct 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Cape Town" data-wave="W1" data-col-index="9" onclick="sortOverviewColumn(this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Cape Town" data-wave="W2" data-col-index="10" onclick="sortOverviewColumn(this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Cape Town" data-wave="W3" data-col-index="11" onclick="sortOverviewColumn(this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Cape Town" data-wave="W4" data-col-index="12" onclick="sortOverviewColumn(this)" title="Click to sort">Oct 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Joburg" data-wave="W1" data-col-index="13" onclick="sortOverviewColumn(this)" title="Click to sort">Jan 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Joburg" data-wave="W2" data-col-index="14" onclick="sortOverviewColumn(this)" title="Click to sort">Apr 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Joburg" data-wave="W3" data-col-index="15" onclick="sortOverviewColumn(this)" title="Click to sort">Jul 2024</th>
<th class="tk-th tk-wave-header tk-sortable" data-segment="Region_Joburg" data-wave="W4" data-col-index="16" onclick="sortOverviewColumn(this)" title="Click to sort">Oct 2024</th>
</tr>
</thead>
<tbody>
<tr class="tk-base-row">
<td class="tk-td tk-label-col tk-sticky-col tk-base-label">Base (n=)</td>
<td class="tk-td tk-base-cell" data-segment="Total" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-segment="Total" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-segment="Total" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-segment="Total" data-n="100">100</td>
<td class="tk-td tk-base-cell" data-segment="Region_Durban" data-n="26"><span class="tk-low-base">26 &#x26A0;</span></td>
<td class="tk-td tk-base-cell" data-segment="Region_Durban" data-n="29"><span class="tk-low-base">29 &#x26A0;</span></td>
<td class="tk-td tk-base-cell" data-segment="Region_Durban" data-n="29"><span class="tk-low-base">29 &#x26A0;</span></td>
<td class="tk-td tk-base-cell" data-segment="Region_Durban" data-n="25"><span class="tk-low-base">25 &#x26A0;</span></td>
<td class="tk-td tk-base-cell" data-segment="Region_Cape Town" data-n="38">38</td>
<td class="tk-td tk-base-cell" data-segment="Region_Cape Town" data-n="35">35</td>
<td class="tk-td tk-base-cell" data-segment="Region_Cape Town" data-n="40">40</td>
<td class="tk-td tk-base-cell" data-segment="Region_Cape Town" data-n="37">37</td>
<td class="tk-td tk-base-cell" data-segment="Region_Joburg" data-n="36">36</td>
<td class="tk-td tk-base-cell" data-segment="Region_Joburg" data-n="36">36</td>
<td class="tk-td tk-base-cell" data-segment="Region_Joburg" data-n="31">31</td>
<td class="tk-td tk-base-cell" data-segment="Region_Joburg" data-n="38">38</td>
</tr>
<tr class="tk-section-row"><td colspan="17" class="tk-section-cell" onclick="toggleOverviewSection(this)"><span class="section-chevron">&#x25BC;</span> Awareness</td></tr>
<tr class="tk-metric-row" data-metric-id="metric_1" data-q-code="Q_AWARE" data-metric-type="pct" data-section="Awareness" data-chart='{"metric_id":"metric_1","metric_label":"Brand Awareness","metric_name":"category:yes","question_code":"Q_AWARE","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[68.1733,63.1973,68.6174,69.6063],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[68.6518,56.2993,78.8065,80.9019],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[68.3475,57.2045,65.0611,67.4287],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[67.6584,74.2009,63.7353,64.184],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_1')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Brand Awareness</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,4.7 20.7,14.0 39.3,3.9 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_1" onclick="addToChart('metric_1')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="68.1732757000564" data-n="100">68%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="63.1972663465091" data-n="100">63%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="68.6174171938965" data-n="100">69%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="69.6063443531435" data-n="100">70%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="68.6518085495068" data-n="26">69%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="56.299347751459" data-n="29">56%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="78.8064516129032" data-n="29">79%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="80.9018567639257" data-n="25">81%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="68.3474787818272" data-n="38">68%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="57.2044647387113" data-n="35">57%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="65.0610739801798" data-n="40">65%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="67.4287182121757" data-n="37">67%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="67.6583739420364" data-n="36">68%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="74.2008557764913" data-n="36">74%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="63.7352674524025" data-n="31">64%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="64.1840366039654" data-n="38">64%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_1">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-12pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+23pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+2pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+8pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+2pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_1">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-12pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+12pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-3pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_2" data-q-code="Q_PREF" data-metric-type="pct" data-section="Awareness" data-chart='{"metric_id":"metric_1","metric_label":"Brand Preference (% Brand A)","metric_name":"category:brand a","question_code":"Q_PREF","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[27.025,35.8423,29.131,35.1901],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[26.087,36.3886,29.7097,30.2766],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[25.4868,31.7352,34.8237,29.7457],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[29.2639,39.5167,21.1242,43.8739],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_2')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Brand Preference (% Brand A)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,11.1 58.0,2.9" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.9" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_2" onclick="addToChart('metric_2')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="27.024995301635" data-n="100">27%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="35.8422608053195" data-n="100">36%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="29.1310011164868" data-n="100">29%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="35.1901394993312" data-n="100">35%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="26.0869565217391" data-n="26">26%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="36.3886028149674" data-n="29">36%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="29.7096774193548" data-n="29">30%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="30.2766199317923" data-n="25">30%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="25.4867698452322" data-n="38">25%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="31.7351598173516" data-n="35">32%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="34.8236920949528" data-n="40">35%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="29.7456974055998" data-n="37">30%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="29.2639138240574" data-n="36">29%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="39.5167379813743" data-n="36">40%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="21.1242067089755" data-n="31">21%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="43.8739196746314" data-n="38">44%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_2">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+6pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+1pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-5pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-18pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+23pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_2">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+8pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+4pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-8pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+15pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_3" data-q-code="Q_PREF" data-metric-type="pct" data-section="Awareness" data-chart='{"metric_id":"metric_1","metric_label":"Brand Preference (% Brand B)","metric_name":"category:brand b","question_code":"Q_PREF","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[21.7346,21.2228,32.192,25.7309],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[28.7541,19.1212,29.8065,25.54],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[17.7733,19.5586,26.3655,25.1991],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[20.8771,24.4148,42.0671,26.3854],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_3')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Brand Preference (% Brand B)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,13.4 20.7,14.0 39.3,2.0 58.0,9.1" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="9.1" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_3" onclick="addToChart('metric_3')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="21.7346363465514" data-n="100">22%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="21.222755818249" data-n="100">21%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="32.1920357275772" data-n="100">32%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="25.7309382763233" data-n="100">26%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="28.7541103397881" data-n="26">29%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="19.121180913148" data-n="29">19%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="29.8064516129032" data-n="29">30%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="25.5399772641152" data-n="25">26%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="17.773339990015" data-n="38">18%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="19.558599695586" data-n="35">20%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="26.3655220096796" data-n="40">26%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="25.1990752632931" data-n="37">25%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="20.8771479866632" data-n="36">21%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="24.4147998993204" data-n="36">24%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="42.067089755213" data-n="31">42%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="26.3853584138282" data-n="38">26%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_3">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-6pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-4pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+18pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-16pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_3">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+4pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-3pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+7pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+21pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+6pp</span></td>
</tr>
<tr class="tk-section-row"><td colspan="17" class="tk-section-cell" onclick="toggleOverviewSection(this)"><span class="section-chevron">&#x25BC;</span> Brand Health</td></tr>
<tr class="tk-metric-row" data-metric-id="metric_4" data-q-code="Q_SAT" data-metric-type="mean" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Overall Satisfaction (Average)","metric_name":"mean","question_code":"Q_SAT","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[6.859,7.0912,7.3043,7.6659],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[6.7183,7.3203,7.1397,8.0216],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[6.9099,6.9269,7.1111,7.5818],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[6.9056,7.0863,7.712,7.5104],"n":[36,36,31,38]}},"is_percentage":false,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_4')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Overall Satisfaction (Average)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,10.5 39.3,7.4 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_4" onclick="addToChart('metric_4')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="6.85904905093028" data-n="100">6.9</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="7.09124492057628" data-n="100">7.1</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="7.304335690361" data-n="100">7.3</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="7.66587043760749" data-n="100">7.7</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="6.71830471318962" data-n="26">6.7</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="7.32028836251287" data-n="29">7.3</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="7.13967741935484" data-n="29">7.1</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="8.02159909056461" data-n="25">8.0</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="6.90988517224164" data-n="38">6.9</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="6.92694063926941" data-n="35">6.9</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="7.11108550357225" data-n="40">7.1</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="7.58181351143077" data-n="37">7.6</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="6.90561682482688" data-n="36">6.9</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="7.08633274603574" data-n="36">7.1</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="7.71199758235116" data-n="31">7.7</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="7.51042196237926" data-n="38">7.5</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_4">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.9 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.5 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_4">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.8</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+1.3</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.2</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.7</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.8</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.6</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_5" data-q-code="Q_SAT" data-metric-type="pct" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Overall Satisfaction (Satisfied)","metric_name":"top2_box","question_code":"Q_SAT","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[13.9823,14.6564,14.9516,28.4827],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[15.4549,15.551,21.129,33.2702],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[12.7559,11.999,8.366,24.5826],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[14.2088,16.6373,17.7999,29.1307],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_5')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Overall Satisfaction (Satisfied)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.4 39.3,13.2 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_5" onclick="addToChart('metric_5')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="13.9823341477166" data-n="100">14%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="14.6564462504618" data-n="100">15%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="14.9516189058429" data-n="100">15%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="28.4827059048347" data-n="100">28%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="15.4548776032152" data-n="26">15%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="15.5509783728115" data-n="29">16%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="21.1290322580645" data-n="29">21%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="33.2701780977643" data-n="25">33%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="12.755866200699" data-n="38">13%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="11.9989852866565" data-n="35">12%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="8.36598294537912" data-n="40">8%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="24.5825841253532" data-n="37">25%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="14.2087714798666" data-n="36">14%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="16.6373017870627" data-n="36">17%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="17.7999395587791" data-n="31">18%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="29.1306558210473" data-n="38">29%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_5">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+14pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+12pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+16pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+11pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_5">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+15pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+18pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+12pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+15pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_6" data-q-code="Q_SAT" data-metric-type="pct" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Overall Satisfaction (Very Satisfied)","metric_name":"top_box","question_code":"Q_SAT","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[3.9278,6.0122,7.1362,14.313],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[3.544,8.7882,11.3871,4.4714],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[2.3714,5.9614,2.6043,11.8675],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[5.7964,4.0272,9.0964,23.335],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_6')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Overall Satisfaction (Very Satisfied)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.6 39.3,10.3 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_6" onclick="addToChart('metric_6')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="3.9278331140763" data-n="100">4%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="6.0121906169191" data-n="100">6%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="7.13621138816524" data-n="100">7%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="14.3130135677432" data-n="100">14%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="3.54402630617464" data-n="26">4%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="8.78819086852043" data-n="29">9%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="11.3870967741935" data-n="29">11%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="4.47139067828723" data-n="25">4%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="2.37144283574638" data-n="38">2%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="5.96144089294774" data-n="35">6%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="2.60428670200507" data-n="40">3%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="11.8674544053429" data-n="37">12%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="5.79635804052321" data-n="36">6%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="4.0271834885477" data-n="36">4%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="9.0964037473557" data-n="31">9%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="23.3350279613625" data-n="38">23%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_6">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+7pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-7pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_6">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+10pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+8pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+1pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+9pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+18pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_7" data-q-code="Q_SERVICE" data-metric-type="mean" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Service Quality (Mean)","metric_name":"mean","question_code":"Q_SERVICE","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[6.4827,6.9034,6.8218,6.6217],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[7.1516,6.5781,6.9439,6.6809],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[6.5617,7.003,6.7027,6.7752],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[5.932,7.043,6.8637,6.4301],"n":[36,36,31,38]}},"is_percentage":false,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_7')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Service Quality (Mean)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,2.0 39.3,4.3 58.0,10.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="10.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_7" onclick="addToChart('metric_7')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="6.48271001691411" data-n="100">6.5</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="6.90339859623199" data-n="100">6.9</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="6.82182731671009" data-n="100">6.8</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="6.62172749856679" data-n="100">6.6</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="7.1516258677384" data-n="26">7.2</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="6.57809818056986" data-n="29">6.6</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="6.94387096774194" data-n="29">6.9</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="6.68093974990527" data-n="25">6.7</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="6.56165751372941" data-n="38">6.6</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="7.00304414003044" data-n="35">7.0</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="6.7026964738419" data-n="40">6.7</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="6.77523760595941" data-n="37">6.8</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="5.93203385483457" data-n="36">5.9</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="7.04304052353385" data-n="36">7.0<span class="tk-sig tk-sig-up">&#x25B2;</span></td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="6.86370504684195" data-n="31">6.9</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="6.43009659379766" data-n="38">6.4</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_7">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">-0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-up">+1.1 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-0.4 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_7">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.1</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-0.2</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-0.5</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.1</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.2</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-up">+1.1 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.9</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.5</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_8" data-q-code="Q_SERVICE" data-metric-type="pct" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Service Quality (Top 2 Box)","metric_name":"top2_box","question_code":"Q_SERVICE","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[15.6831,15.3583,18.9524,18.1062],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[20.0585,11.1569,28.8387,30.5798],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[19.5956,13.7494,17.8382,11.4051],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[8.5919,20.0352,43.8199,16.3701],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_8')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Service Quality (Top 2 Box)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,12.9 20.7,14.0 39.3,2.0 58.0,4.8" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="4.8" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_8" onclick="addToChart('metric_8')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="15.6831422664913" data-n="100">16%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="15.3583302548947" data-n="100">15%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="18.9523632303684" data-n="100">19%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="18.1062488056564" data-n="100">18%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="20.058458165875" data-n="26">20%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="11.1568829385513" data-n="29">11%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="28.8387096774194" data-n="29">29%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="30.5797650625237" data-n="25">31%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="19.5956065901148" data-n="38">20%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="13.7493658041603" data-n="35">14%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="17.8382115694861" data-n="40">18%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="11.405086051888" data-n="37">11%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="8.59194665298795" data-n="36">9%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="20.0352378555248" data-n="36">20%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="43.8198851616803" data-n="31">44%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="16.3701067615658" data-n="38">16%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_8">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-1pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+18pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+2pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+24pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-27pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_8">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+2pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+9pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+11pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-8pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+35pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+8pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_9" data-q-code="Q_VALUE" data-metric-type="mean" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Value for Money (Mean)","metric_name":"mean","question_code":"Q_VALUE","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[5.9931,6.3094,6.1112,6.3893],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[5.4165,5.5321,5.7581,6.7969],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[6.479,6.5784,6.2459,6.5792],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[5.8987,6.6124,6.2653,5.9278],"n":[36,36,31,38]}},"is_percentage":false,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_9')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Value for Money (Mean)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,4.4 39.3,10.4 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_9" onclick="addToChart('metric_9')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="5.99314038714527" data-n="100">6.0</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="6.30938308090137" data-n="100">6.3</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="6.11118347599553" data-n="100">6.1</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="6.38926046244984" data-n="100">6.4</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="5.4165144318597" data-n="26">5.4</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="5.53209749399245" data-n="29">5.5</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="5.75806451612903" data-n="29">5.8</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="6.79689276241" data-n="25">6.8</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="6.47903145282077" data-n="38">6.5</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="6.57838660578387" data-n="35">6.6</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="6.2459091956672" data-n="40">6.2</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="6.57924479835602" data-n="37">6.6</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="5.89869197230059" data-n="36">5.9</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="6.61238358922728" data-n="36">6.6</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="6.26533695980659" data-n="31">6.3</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="5.92780884595831" data-n="38">5.9</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_9">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">-0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+1.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.7 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_9">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.1</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.4</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+1.4</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-0.2</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.1</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.7 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.0</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_10" data-q-code="Q_VALUE" data-metric-type="pct" data-section="Brand Health" data-chart='{"metric_id":"metric_1","metric_label":"Value for Money (Dissatisfied)","metric_name":"bottom2_box","question_code":"Q_VALUE","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[22.7495,4.0174,8.383,4.9876],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[27.0734,7.6553,6.129,26.9799],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[16.3005,5.378,18.9445,9.7868],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[26.3401,10.7727,13.5691,11.3371],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_10')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Value for Money (Dissatisfied)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,14.0 39.3,11.2 58.0,13.4" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="13.4" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_10" onclick="addToChart('metric_10')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="22.7494831798534" data-n="100">23%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="4.01736239379387" data-n="100">4%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="8.38295496836621" data-n="100">8%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="4.98757882667686" data-n="100">5%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="27.0734380708805" data-n="26">27%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="7.65533813937521" data-n="29">8%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="6.12903225806452" data-n="29">6%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="26.979916635089" data-n="25">27%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="16.3005491762356" data-n="38">16%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="5.37798072044647" data-n="35">5%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="18.9444572482139" data-n="40">19%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="9.78679681479579" data-n="37">10%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="26.3400872018466" data-n="36">26%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="10.7727158318651" data-n="36">11%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="13.5690540948927" data-n="31">14%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="11.3370615149975" data-n="38">11%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_10">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-3pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-2pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+21pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-9pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-16pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_10">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-14pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-18pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-19pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-21pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">0pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-7pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-16pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-13pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-15pp</span></td>
</tr>
<tr class="tk-section-row"><td colspan="17" class="tk-section-cell" onclick="toggleOverviewSection(this)"><span class="section-chevron">&#x25BC;</span> Channels</td></tr>
<tr class="tk-metric-row" data-metric-id="metric_11" data-q-code="Q_CHANNEL" data-metric-type="pct" data-section="Channels" data-chart='{"metric_id":"metric_1","metric_label":"Channel Usage","metric_name":"any","question_code":"Q_CHANNEL","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":["NA","NA","NA","NA"],"n":["NA","NA","NA","NA"]},"Region_Durban":{"name":"Region_Durban","values":["NA","NA","NA","NA"],"n":["NA","NA","NA","NA"]},"Region_Cape Town":{"name":"Region_Cape Town","values":["NA","NA","NA","NA"],"n":["NA","NA","NA","NA"]},"Region_Joburg":{"name":"Region_Joburg","values":["NA","NA","NA","NA"],"n":["NA","NA","NA","NA"]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_11')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Channel Usage</span><span class="tk-sparkline-wrap"></span><button class="tk-add-chart-btn" data-metric-id="metric_11" onclick="addToChart('metric_11')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Durban" data-wave="W1" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Durban" data-wave="W2" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Durban" data-wave="W3" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Durban" data-wave="W4" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="" data-n="">&mdash;</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="" data-n="">&mdash;</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_11">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td data-segment="Total"></td>
<td data-segment="Total"></td>
<td data-segment="Total"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Joburg"></td>
<td data-segment="Region_Joburg"></td>
<td data-segment="Region_Joburg"></td>
<td data-segment="Region_Joburg"></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_11">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td data-segment="Total"></td>
<td data-segment="Total"></td>
<td data-segment="Total"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Durban"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Cape Town"></td>
<td data-segment="Region_Joburg"></td>
<td data-segment="Region_Joburg"></td>
<td data-segment="Region_Joburg"></td>
<td data-segment="Region_Joburg"></td>
</tr>
<tr class="tk-section-row"><td colspan="17" class="tk-section-cell" onclick="toggleOverviewSection(this)"><span class="section-chevron">&#x25BC;</span> Commercial</td></tr>
<tr class="tk-metric-row" data-metric-id="metric_12" data-q-code="Q_INTENT" data-metric-type="mean" data-section="Commercial" data-chart='{"metric_id":"metric_1","metric_label":"Purchase Intent (Average)","metric_name":"mean","question_code":"Q_INTENT","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[3.1538,3.2127,3.4573,3.4248],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[2.9357,3.3639,3.289,3.5813],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[3.2576,2.981,3.6476,3.3524],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[3.2003,3.3317,3.3654,3.3915],"n":[36,36,31,38]}},"is_percentage":false,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_12')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Purchase Intent (Average)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,11.7 39.3,2.0 58.0,3.3" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="3.3" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_12" onclick="addToChart('metric_12')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="3.15382446908476" data-n="100">3.2</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="3.21268932397488" data-n="100">3.2</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="3.45729438034983" data-n="100">3.5</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="3.42480412765144" data-n="100">3.4</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="2.93569601753745" data-n="26">2.9</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="3.36388602814967" data-n="29">3.4</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="3.28903225806452" data-n="29">3.3</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="3.58128078817734" data-n="25">3.6</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="3.25761357963055" data-n="38">3.3</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="2.98097412480974" data-n="35">3.0</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="3.64761465775524" data-n="40">3.6<span class="tk-sig tk-sig-up">&#x25B2;</span></td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="3.35242743385564" data-n="37">3.4</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="3.20030777122339" data-n="36">3.2</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="3.33173923986912" data-n="36">3.3</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="3.36536718041704" data-n="31">3.4</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="3.3914590747331" data-n="38">3.4</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_12">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-up">+0.7 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_12">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.4 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0.6</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.4</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.1</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.2</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.2</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_13" data-q-code="Q_INTENT" data-metric-type="pct" data-section="Commercial" data-chart='{"metric_id":"metric_1","metric_label":"Purchase Intent (Positive)","metric_name":"box:agree","question_code":"Q_INTENT","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[35.7546,36.3317,55.2754,45.987],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[33.9423,40.3021,51.4839,60.0985],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[38.7668,22.0446,63.4708,36.6812],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[33.9318,47.5963,48.081,45.7295],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_13')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Purchase Intent (Positive)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,13.6 39.3,2.0 58.0,7.7" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="7.7" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_13" onclick="addToChart('metric_13')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="35.7545574140199" data-n="100">36%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="36.331732545253" data-n="100">36%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="55.2754000744325" data-n="100">55%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="45.9870055417543" data-n="100">46%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="33.9422725611984" data-n="26">34%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="40.3020940611054" data-n="29">40%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="51.4838709677419" data-n="29">51%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="60.0985221674877" data-n="25">60%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="38.7668497254119" data-n="38">39%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="22.0446473871131" data-n="35">22%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="63.4708458170085" data-n="40">63%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="36.6812227074236" data-n="37">37%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="33.9317773788151" data-n="36">34%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="47.5962748552731" data-n="36">48%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="48.080991236023" data-n="31">48%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="45.729537366548" data-n="38">46%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_13">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+19pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-9pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+11pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+9pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+41pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-27pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_13">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+20pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+10pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+18pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+26pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+25pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-2pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+14pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+12pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_14" data-q-code="Q_INTENT" data-metric-type="pct" data-section="Commercial" data-chart='{"metric_id":"metric_1","metric_label":"Purchase Intent (Negative)","metric_name":"box:disagree","question_code":"Q_INTENT","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[23.9147,20.7148,15.8634,17.2081],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[31.8962,15.2077,21.7419,14.3615],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[18.4224,24.4546,11.8921,14.4619],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[23.9549,21.042,15.5636,21.8353],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_14')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Purchase Intent (Negative)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,6.8 39.3,14.0 58.0,12.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="12.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_14" onclick="addToChart('metric_14')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="23.9146776921631" data-n="100">24%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="20.7148134466199" data-n="100">21%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="15.863416449572" data-n="100">16%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="17.2081024269062" data-n="100">17%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="31.8962367555718" data-n="26">32%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="15.20768966701" data-n="29">15%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="21.741935483871" data-n="29">22%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="14.3615005683971" data-n="25">14%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="18.4223664503245" data-n="38">18%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="24.4545915778792" data-n="35">24%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="11.892141046324" data-n="40">12%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="14.46185461084" data-n="37">14%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="23.9548602205694" data-n="36">24%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="21.0420337276617" data-n="36">21%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="15.5636143850106" data-n="31">16%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="21.8352821555669" data-n="38">22%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_14">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+1pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-7pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-13pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+3pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+6pp</span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_14">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-8pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-7pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-17pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-18pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-4pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-3pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-8pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-2pp</span></td>
</tr>
<tr class="tk-section-row"><td colspan="17" class="tk-section-cell" onclick="toggleOverviewSection(this)"><span class="section-chevron">&#x25BC;</span> Loyalty</td></tr>
<tr class="tk-metric-row" data-metric-id="metric_15" data-q-code="Q_NPS" data-metric-type="nps" data-section="Loyalty" data-chart='{"metric_id":"metric_1","metric_label":"Net Promoter Score (NPS)","metric_name":"nps_score","question_code":"Q_NPS","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[-25.5591,-17.5009,-5.8709,-4.9876],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[-23.164,-36.9379,-18.1613,-79.7651],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[-23.8143,22.0446,-13.6898,53.0439],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[-29.0331,-42.4868,15.896,-12.2522],"n":[36,36,31,38]}},"is_percentage":false,"is_nps":true}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_15')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Net Promoter Score (NPS)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,9.3 39.3,2.5 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_15" onclick="addToChart('metric_15')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="-25.5591054313099" data-n="100">-25.56</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="-17.5009235315848" data-n="100">-17.50</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="-5.87085969482694" data-n="100">-5.87</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="-4.98757882667686" data-n="100">-4.99</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="-23.1640482279869" data-n="26">-23.16</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="-36.9378647442499" data-n="29">-36.94</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="-18.1612903225806" data-n="29">-18.16</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="-79.7650625236832" data-n="25">-79.77</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="-23.8142785821268" data-n="38">-23.81</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="22.0446473871131" data-n="35">+22.04</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="-13.6897902742567" data-n="40">-13.69</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="53.0439249935782" data-n="37">+53.04<span class="tk-sig tk-sig-up">&#x25B2;</span></td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="-29.0330854065145" data-n="36">-29.03</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="-42.4867858041782" data-n="36">-42.49</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="15.8960411000302" data-n="31">+15.90</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="-12.2521606507372" data-n="38">-12.25</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_15">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+8.06 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+11.63 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.88 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-13.77 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+18.78 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-61.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+45.86 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-35.73 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-up">+66.73 <span class="sig-arrow">&#x2191;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-13.45 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+58.38 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-28.15 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_15">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+8.06 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+19.69</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+20.57</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-13.77 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+5</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-56.6</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+45.86 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+10.12</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+76.86</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-13.45 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+44.93</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+16.78</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_16" data-q-code="Q_NPS" data-metric-type="nps" data-section="Loyalty" data-chart='{"metric_id":"metric_1","metric_label":"Net Promoter Score (% Promoters)","metric_name":"promoters_pct","question_code":"Q_NPS","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[21.6595,25.5264,28.5914,32.6008],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[26.3792,17.0271,21.0968,0],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[18.9965,44.9264,23.0007,60.6473],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[21.0823,12.5094,42.9435,26.7158],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_16')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Net Promoter Score (% Promoters)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,9.8 39.3,6.4 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_16" onclick="addToChart('metric_16')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="21.6594625070475" data-n="100">22%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="25.5264130033247" data-n="100">26%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="28.5913658355043" data-n="100">29%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="32.6008025988916" data-n="100">33%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="26.3792473511144" data-n="26">26%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="17.0271198077583" data-n="29">17%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="21.0967741935484" data-n="29">21%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="0" data-n="25">0%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="18.9965052421368" data-n="38">19%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="44.9264332825977" data-n="35">45%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="23.0006914035492" data-n="40">23%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="60.6473156948369" data-n="37">61%<span class="tk-sig tk-sig-up">&#x25B2;</span></td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="21.082328802257" data-n="36">21%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="12.5094387113013" data-n="36">13%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="42.9434874584467" data-n="31">43%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="26.7158108795119" data-n="38">27%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_16">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+3pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-21pp <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+26pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-22pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-up">+38pp <span class="sig-arrow">&#x2191;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+30pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-16pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_16">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+7pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+11pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-5pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-26pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+26pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+4pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+42pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+22pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+6pp</span></td>
</tr>
<tr class="tk-metric-row" data-metric-id="metric_17" data-q-code="Q_NPS" data-metric-type="nps" data-section="Loyalty" data-chart='{"metric_id":"metric_1","metric_label":"Net Promoter Score (% Detractors)","metric_name":"detractors_pct","question_code":"Q_NPS","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[47.2186,43.0273,34.4622,37.5884],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[49.5433,53.965,39.2581,79.7651],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[42.8108,22.8818,36.6905,7.6034],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[50.1154,54.9962,27.0474,38.968],"n":[36,36,31,38]}},"is_percentage":true,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_17')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Net Promoter Score (% Detractors)</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,2.0 20.7,5.9 39.3,14.0 58.0,11.1" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="11.1" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_17" onclick="addToChart('metric_17')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="47.2185679383575" data-n="100">47%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="43.0273365349095" data-n="100">43%</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="34.4622255303312" data-n="100">34%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="37.5883814255685" data-n="100">38%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="49.5432955791012" data-n="26">50%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="53.9649845520082" data-n="29">54%</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="39.258064516129" data-n="29">39%</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="79.7650625236832" data-n="25">80%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="42.8107838242636" data-n="38">43%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="22.8817858954845" data-n="35">23%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="36.6904816778059" data-n="40">37%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="7.60339070125867" data-n="37">8%<span class="tk-sig tk-sig-down">&#x25BC;</span></td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="50.1154142087715" data-n="36">50%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="54.9962245154795" data-n="36">55%</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="27.0474463584164" data-n="31">27%</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="38.9679715302491" data-n="38">39%</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_17">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">-4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">-9pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+3pp <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">-15pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+41pp <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-20pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+14pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-down">-29pp <span class="sig-arrow">&#x2193;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+5pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-28pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+12pp <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_17">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">-4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-13pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">-10pp</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+4pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">-10pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+30pp</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-20pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-6pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">-35pp</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+5pp <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-23pp</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">-11pp</span></td>
</tr>
<tr class="tk-section-row"><td colspan="17" class="tk-section-cell" onclick="toggleOverviewSection(this)"><span class="section-chevron">&#x25BC;</span> Summary Metrics</td></tr>
<tr class="tk-metric-row" data-metric-id="metric_18" data-q-code="Q_COMPOSITE" data-metric-type="mean" data-section="Summary Metrics" data-chart='{"metric_id":"metric_1","metric_label":"Customer Experience Index","metric_name":"mean","question_code":"Q_COMPOSITE","wave_ids":["W1","W2","W3","W4"],"wave_labels":["Jan 2024","Apr 2024","Jul 2024","Oct 2024"],"series":{"Total":{"name":"Total","values":[6.445,6.768,6.7458,6.8923],"n":[100,100,100,100]},"Region_Durban":{"name":"Region_Durban","values":[6.4288,6.4768,6.6139,7.1665],"n":[26,29,29,25]},"Region_Cape Town":{"name":"Region_Cape Town","values":[6.6502,6.8361,6.6866,6.9788],"n":[38,35,40,37]},"Region_Joburg":{"name":"Region_Joburg","values":[6.2454,6.9139,6.947,6.6228],"n":[36,36,31,38]}},"is_percentage":false,"is_nps":false}'>
<td class="tk-td tk-label-col tk-sticky-col"><button class="tk-row-hide-btn" onclick="toggleRowVisibility('metric_18')" title="Hide this metric">&#x1F441;</button><span class="tk-metric-label">Customer Experience Index</span><span class="tk-sparkline-wrap"><svg class="tk-sparkline" width="60" height="16" viewBox="0 0 60 16"><polyline points="2.0,14.0 20.7,5.3 39.3,5.9 58.0,2.0" fill="none" stroke="#323367" stroke-width="1.5" stroke-linejoin="round"/><circle cx="58.0" cy="2.0" r="2" fill="#323367"/></svg></span><button class="tk-add-chart-btn" data-metric-id="metric_18" onclick="addToChart('metric_18')" title="Add to chart">&#x1F4C8;</button></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W1" data-sort-val="6.44496648499655" data-n="100">6.4</td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W2" data-sort-val="6.76800886590321" data-n="100">6.8<span class="tk-sig tk-sig-up">&#x25B2;</span></td>
<td class="tk-td tk-value-cell" data-segment="Total" data-wave="W3" data-sort-val="6.74578216102221" data-n="100">6.7</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Total" data-wave="W4" data-sort-val="6.89228613287471" data-n="100">6.9</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W1" data-sort-val="6.42881500426257" data-n="26">6.4</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W2" data-sort-val="6.47682801235839" data-n="29">6.5</td>
<td class="tk-td tk-value-cell tk-low-base-dim" data-segment="Region_Durban" data-wave="W3" data-sort-val="6.61387096774194" data-n="29">6.6</td>
<td class="tk-td tk-value-cell tk-latest-wave tk-low-base-dim" data-segment="Region_Durban" data-wave="W4" data-sort-val="7.16647720095996" data-n="25">7.2</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W1" data-sort-val="6.65019137959727" data-n="38">6.7</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W2" data-sort-val="6.8361237950279" data-n="35">6.8</td>
<td class="tk-td tk-value-cell" data-segment="Region_Cape Town" data-wave="W3" data-sort-val="6.68656372436045" data-n="40">6.7</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Cape Town" data-wave="W4" data-sort-val="6.97876530524874" data-n="37">7.0</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W1" data-sort-val="6.24544755065401" data-n="36">6.2</td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W2" data-sort-val="6.91391895293229" data-n="36">6.9<span class="tk-sig tk-sig-up">&#x25B2;</span></td>
<td class="tk-td tk-value-cell" data-segment="Region_Joburg" data-wave="W3" data-sort-val="6.94701319633323" data-n="31">6.9</td>
<td class="tk-td tk-value-cell tk-latest-wave" data-segment="Region_Joburg" data-wave="W4" data-sort-val="6.62277580071174" data-n="38">6.6</td>
</tr>
<tr class="tk-change-row tk-vs-prev" data-metric-id="metric_18">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Prev</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-up">+0.3 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.6 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">-0.1 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.3 <span class="sig-arrow">&#x2192;</span></span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-up">+0.7 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val not-sig">-0.3 <span class="sig-arrow">&#x2192;</span></span></td>
</tr>
<tr class="tk-change-row tk-vs-base" data-metric-id="metric_18">
<td class="tk-td tk-label-col tk-sticky-col tk-change-label">vs Base</td>
<td data-segment="Total"></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-up">+0.3 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.3</span></td>
<td class="tk-td tk-change-cell" data-segment="Total"><span class="change-val sig-na">+0.4</span></td>
<td data-segment="Region_Durban"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val not-sig">+0.0 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0.2</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Durban"><span class="change-val sig-na">+0.7</span></td>
<td data-segment="Region_Cape Town"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val not-sig">+0.2 <span class="sig-arrow">&#x2192;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.0</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Cape Town"><span class="change-val sig-na">+0.3</span></td>
<td data-segment="Region_Joburg"></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-up">+0.7 <span class="sig-arrow">&#x2191;</span></span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.7</span></td>
<td class="tk-td tk-change-cell" data-segment="Region_Joburg"><span class="change-val sig-na">+0.4</span></td>
</tr>
</tbody>
</table>
</div></div>
          <div class="tk-chart-panel" id="tk-chart-panel" style="display:none"><div class="tk-chart-header">
<span class="tk-chart-count" id="tk-chart-count">Charts (0 selected)</span>
<div class="tk-chart-header-actions">
<button class="export-btn" onclick="exportChartPNG('combined')">&#x1F4F8; Export PNG</button>
<button class="export-btn" onclick="pinSelectedCharts()">&#x1F4CC; Pin Charts</button>
</div>
</div>
<div id="tk-combined-chart" class="tk-chart-container" style="padding:20px;background:var(--card);border-radius:8px;border:1px solid var(--border);">
<p style="color:#888;text-align:center;padding:40px;">Select metrics from the table to add them to the chart.</p>
</div></div>
        </div>
        <div class="insight-area">
          <button class="insight-toggle" onclick="toggleOverviewInsight()">+ Add Insight</button>
          <div class="insight-container" style="display:none">
            <div class="insight-editor" contenteditable="true" data-placeholder="Type overview insight here..." id="overview-insight-editor" oninput=""></div>
            <button class="insight-dismiss" title="Delete insight" onclick="dismissOverviewInsight()">&times;</button>
          </div>
        </div>
      </main>
    </div>
  </div>
  <div id="tab-pinned" class="tab-panel">
    <div class="pinned-tab-content">
      <div class="pinned-toolbar" id="pinned-toolbar" style="display:none">
        <button class="tk-btn" onclick="addSection()">&#x2795; Add Section</button>
        <button class="tk-btn" onclick="exportAllPinsPNG()">&#x1F4F8; Export All as PNGs</button>
        <button class="tk-btn" onclick="printAllPins()">&#x1F5A8; Print / Save PDF</button>
        <button class="tk-btn" onclick="saveReportHTML()">&#x1F4BE; Save Report HTML</button>
      </div>
      <div id="pinned-cards-container"></div>
      <div id="pinned-empty-state" class="pinned-empty-state">&#x1F4CC; No pinned views yet. Go to <strong>Metrics by Segment</strong> and click <strong>Pin</strong> to save a view here.</div>
    </div>
  </div>
</div>
<footer class="tk-footer">
  <div class="tk-footer-sig-info">Significance testing: Wave-on-wave z-test / t-test Â· p&lt;0.05 Â· Minimum base n=30</div>
  <div class="tk-footer-info">
    <span>Baseline: W1 (Jan 2024)</span>
    <span class="tk-footer-sep">|</span>
    <span>Confidence: 95%</span>
    <span class="tk-footer-sep">|</span>
    <span>Generated: 26 Feb 2026 17:44</span>
  </div>
  <div class="tk-footer-credit">
    <span>Prepared by The Research LampPost</span>
    <span> | Powered by Turas Analytics</span>
  </div>
</footer>
<div id="tk-help-overlay" class="tk-help-overlay" style="display:none">
  <div class="tk-help-content">
    <h2>Tracking Report Help</h2>
    <button class="tk-help-close" onclick="toggleHelpOverlay()">&times;</button>
    <div class="tk-help-body">
      <h3>Report Tabs</h3>
      <ul>
        <li>
          <strong>Summary</strong>
           â€” Key findings and methodology notes
        </li>
        <li>
          <strong>Metrics by Segment</strong>
           â€” Explore one metric at a time with segment chips and chart toggle
        </li>
        <li>
          <strong>Segment Overview</strong>
           â€” Full crosstab table with all metrics
        </li>
        <li>
          <strong>Pinned Views</strong>
           â€” Save and compare specific metric views
        </li>
      </ul>
      <h3>Significance Indicators</h3>
      <ul>
        <li><span class='sig-up'>&#x2191;</span> Significant increase</li>
        <li><span class='sig-down'>&#x2193;</span> Significant decrease</li>
        <li><span class='not-sig'>&#x2192;</span> No significant change</li>
      </ul>
      <h3>Segment Chips</h3>
      <p>Click segment chips to show or hide individual segments. Total is shown by default.</p>
      <h3>Export</h3>
      <p>Export the visible table as CSV or Excel. Export charts as PNG images.</p>
    </div>
  </div>
</div>
<script type="application/json" id="pinned-views-data">[]</script>
<script>var SEGMENTS = ["Total","Region_Durban","Region_Cape Town","Region_Joburg"];
var BASELINE_WAVE = "W1";
var N_WAVES = 4;
var SEGMENT_GROUPS = {"standalone":"Total","groups":{"Region":["Region_Durban","Region_Cape Town","Region_Joburg"]}};
var activeMetricTypeFilter = "all";
function filterMetricType(typeKey) {
  activeMetricTypeFilter = typeKey;
  document.querySelectorAll(".mv-type-chip").forEach(function(chip) {
    chip.classList.toggle("active", chip.getAttribute("data-type-filter") === typeKey);
  });
  applyMetricNavFilter();
}
function filterMetricNav(query) {
  window._metricSearchQuery = (query || "").toLowerCase();
  applyMetricNavFilter();
}
function applyMetricNavFilter() {
  var q = (window._metricSearchQuery || "").toLowerCase();
  var typeFilter = activeMetricTypeFilter || "all";
  document.querySelectorAll(".tk-metric-nav-item").forEach(function(item) {
    var textMatch = q === "" || item.textContent.toLowerCase().indexOf(q) >= 0;
    var typeMatch = typeFilter === "all" || item.getAttribute("data-metric-type") === typeFilter;
    item.style.display = (textMatch && typeMatch) ? "" : "none";
  });
  document.querySelectorAll(".mv-nav-section").forEach(function(section) {
    var next = section.nextElementSibling;
    var hasVisible = false;
    while (next && !next.classList.contains("mv-nav-section")) {
      if (next.classList.contains("tk-metric-nav-item") && next.style.display !== "none") {
        hasVisible = true;
        break;
      }
      next = next.nextElementSibling;
    }
    section.style.display = hasVisible ? "" : "none";
  });
}
function switchReportTab(tabName) {
  document.querySelectorAll(".report-tab").forEach(function(btn) {
    btn.classList.toggle("active", btn.getAttribute("data-tab") === tabName);
  });
  document.querySelectorAll(".tab-panel").forEach(function(panel) {
    panel.classList.remove("active");
  });
  var target = document.getElementById("tab-" + tabName);
  if (target) target.classList.add("active");
  if (tabName === "overview") {
    window.dispatchEvent(new Event("resize"));
  }
}
document.addEventListener("DOMContentLoaded", function() {
  switchReportTab("summary");
});
var activeSegments = {};
var activeWaves = {};
var chartSegments = {};
var chartSegmentInitialised = false;
var chipStateInitialised = false;
var selectedSegment = null;
function initChipState() {
  if (chipStateInitialised) return;
  var firstPanel = document.querySelector(".tk-metric-panel");
  if (firstPanel) {
    firstPanel.querySelectorAll(".mv-segment-chips .tk-segment-chip").forEach(function(chip) {
      var seg = chip.getAttribute("data-segment");
      if (seg) {
        var isActive = chip.classList.contains("active");
        activeSegments[seg] = isActive;
        if (isActive && selectedSegment === null) {
          selectedSegment = seg;
        }
      }
    });
    firstPanel.querySelectorAll(".mv-wave-chips .tk-wave-chip").forEach(function(chip) {
      var wid = chip.getAttribute("data-wave");
      if (wid) activeWaves[wid] = chip.classList.contains("active");
    });
  }
  chipStateInitialised = true;
}
function applyChipState(panel) {
  if (!panel) return;
  panel.querySelectorAll(".mv-segment-chips .tk-segment-chip").forEach(function(chip) {
    var seg = chip.getAttribute("data-segment");
    if (seg && seg in activeSegments) {
      var isActive = activeSegments[seg];
      var isSelected = (seg === selectedSegment);
      chip.classList.toggle("active", isActive);
      chip.classList.toggle("selected", isActive && isSelected);
      panel.querySelectorAll("tr[data-segment=\"" + seg + "\"]").forEach(function(el) {
        el.classList.toggle("segment-hidden", !isActive);
      });
      panel.querySelectorAll("td[data-segment=\"" + seg + "\"], th[data-segment=\"" + seg + "\"]").forEach(function(el) {
        el.classList.toggle("segment-hidden", !isActive);
      });
    }
  });
  if (typeof SEGMENT_GROUPS !== "undefined" && SEGMENT_GROUPS.groups) {
    for (var gName in SEGMENT_GROUPS.groups) {
      var gSegs = SEGMENT_GROUPS.groups[gName];
      var anyActive = false;
      for (var gi = 0; gi < gSegs.length; gi++) {
        if (activeSegments[gSegs[gi]]) { anyActive = true; break; }
      }
      panel.querySelectorAll('.mv-segment-group-header[data-group="' + gName + '"]').forEach(function(h) {
        h.classList.toggle("active", anyActive);
      });
    }
  }
  panel.querySelectorAll(".mv-wave-chips .tk-wave-chip").forEach(function(chip) {
    var wid = chip.getAttribute("data-wave");
    if (wid && wid in activeWaves) {
      var isActive = activeWaves[wid];
      chip.classList.toggle("active", isActive);
      panel.querySelectorAll("th[data-wave=\"" + wid + "\"], td[data-wave=\"" + wid + "\"]").forEach(function(el) {
        el.classList.toggle("wave-hidden", !isActive);
      });
      panel.querySelectorAll(".mv-chart-area circle[data-wave=\"" + wid + "\"]").forEach(function(el) {
        if (!isActive) el.style.display = "none";
      });
      panel.querySelectorAll(".mv-chart-area .tk-chart-label[data-wave=\"" + wid + "\"]").forEach(function(el) {
        if (!isActive) el.style.display = "none";
      });
    }
  });
  initChartSegmentState();
  panel.querySelectorAll(".mv-chart-segment-chips .tk-segment-chip").forEach(function(chip) {
    var seg = chip.getAttribute("data-segment");
    if (seg && seg in chartSegments) {
      chip.classList.toggle("active", chartSegments[seg]);
    }
  });
  applyChartSegmentState(panel);
}
function selectTrackerMetric(metricId) {
  initChipState();
  document.querySelectorAll(".tk-metric-panel").forEach(function(panel) {
    panel.classList.remove("active");
  });
  var target = document.getElementById("mv-" + metricId);
  if (target) {
    target.classList.add("active");
    applyChipState(target);
    syncGroupExpandState(target);
  }
  document.querySelectorAll(".tk-metric-nav-item").forEach(function(item) {
    item.classList.toggle("active", item.getAttribute("data-metric-id") === metricId);
  });
}
function toggleSegmentGroupExpand(metricId, groupName, headerBtn) {
  initChipState();
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var groupSegs = (typeof SEGMENT_GROUPS !== "undefined" && SEGMENT_GROUPS.groups)
    ? SEGMENT_GROUPS.groups[groupName] : null;
  if (!groupSegs) return;
  var groupDiv = headerBtn.closest(".mv-segment-group");
  if (!groupDiv) return;
  var isExpanded = groupDiv.classList.contains("expanded");
  if (isExpanded) {
    groupDiv.classList.remove("expanded");
    for (var i = 0; i < groupSegs.length; i++) {
      activeSegments[groupSegs[i]] = false;
    }
    var found = false;
    for (var j = 0; j < groupSegs.length; j++) {
      if (groupSegs[j] === selectedSegment) { found = true; break; }
    }
    if (found) {
      selectedSegment = null;
      for (var key in activeSegments) {
        if (activeSegments[key]) { selectedSegment = key; break; }
      }
    }
  } else {
    groupDiv.classList.add("expanded");
    for (var i = 0; i < groupSegs.length; i++) {
      activeSegments[groupSegs[i]] = true;
    }
    selectedSegment = groupSegs[0];
  }
  for (var si = 0; si < groupSegs.length; si++) {
    if (!activeSegments[groupSegs[si]]) {
      chartSegments[groupSegs[si]] = false;
    }
  }
  syncChartSegmentChips();
  applyChipStateAllPanels();
}
function applyChipStateAllPanels() {
  document.querySelectorAll(".tk-metric-panel").forEach(function(panel) {
    applyChipState(panel);
  });
}
function syncGroupExpandState(panel) {
  if (typeof SEGMENT_GROUPS === "undefined" || !SEGMENT_GROUPS.groups) return;
  for (var gName in SEGMENT_GROUPS.groups) {
    var gSegs = SEGMENT_GROUPS.groups[gName];
    var anyActive = false;
    for (var i = 0; i < gSegs.length; i++) {
      if (activeSegments[gSegs[i]]) { anyActive = true; break; }
    }
    panel.querySelectorAll('.mv-segment-group[data-group="' + gName + '"]').forEach(function(groupDiv) {
      groupDiv.classList.toggle("expanded", anyActive);
    });
  }
}
function toggleSegmentChip(metricId, segmentName, chip) {
  initChipState();
  chip.classList.toggle("active");
  var isActive = chip.classList.contains("active");
  activeSegments[segmentName] = isActive;
  if (!isActive) {
    chartSegments[segmentName] = false;
  }
  if (isActive) {
    selectedSegment = segmentName;
  } else if (segmentName === selectedSegment) {
    selectedSegment = null;
    for (var key in activeSegments) {
      if (activeSegments[key]) { selectedSegment = key; break; }
    }
  }
  syncChartSegmentChips();
  applyChipStateAllPanels();
}
function toggleWaveChip(metricId, waveId, chip) {
  initChipState();
  chip.classList.toggle("active");
  var isActive = chip.classList.contains("active");
  activeWaves[waveId] = isActive;
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  panel.querySelectorAll("th[data-wave=\"" + waveId + "\"], td[data-wave=\"" + waveId + "\"]").forEach(function(el) {
    el.classList.toggle("wave-hidden", !isActive);
  });
  panel.querySelectorAll(".mv-chart-area [data-wave=\"" + waveId + "\"]").forEach(function(el) {
    el.style.display = isActive ? "" : "none";
  });
  rebuildChartLines(panel);
}
function initChartSegmentState() {
  if (chartSegmentInitialised) return;
  initChipState();
  for (var seg in activeSegments) {
    chartSegments[seg] = (seg === "Total");
  }
  chartSegmentInitialised = true;
}
function syncChartSegmentChips() {
  document.querySelectorAll(".mv-chart-segment-chips .tk-segment-chip").forEach(function(chip) {
    var seg = chip.getAttribute("data-segment");
    if (!seg) return;
    var tableActive = activeSegments[seg] === true;
    chip.style.display = tableActive ? "" : "none";
    if (!tableActive) {
      chartSegments[seg] = false;
      chip.classList.remove("active");
    } else {
      if (!(seg in chartSegments)) chartSegments[seg] = false;
      chip.classList.toggle("active", chartSegments[seg]);
    }
  });
}
function toggleSegmentGroups(btn) {
  var chipBar = btn.closest(".mv-segment-chips");
  if (!chipBar) return;
  var isOpen = chipBar.classList.contains("groups-visible");
  chipBar.classList.toggle("groups-visible", !isOpen);
  btn.classList.toggle("open", !isOpen);
  btn.textContent = isOpen ? "+ Segments" : "\u2212 Segments";
  document.querySelectorAll(".mv-segment-chips").forEach(function(bar) {
    if (bar === chipBar) return;
    bar.classList.toggle("groups-visible", !isOpen);
    var otherBtn = bar.querySelector(".mv-groups-toggle");
    if (otherBtn) {
      otherBtn.classList.toggle("open", !isOpen);
      otherBtn.textContent = isOpen ? "+ Segments" : "\u2212 Segments";
    }
  });
}
function toggleChartSegment(metricId, segName, chip) {
  initChartSegmentState();
  var activeCount = 0;
  for (var k in chartSegments) { if (chartSegments[k]) activeCount++; }
  if (activeCount <= 1 && chartSegments[segName]) return;
  chip.classList.toggle("active");
  var isActive = chip.classList.contains("active");
  chartSegments[segName] = isActive;
  document.querySelectorAll(".mv-chart-segment-chips .tk-segment-chip[data-segment=\"" + segName + "\"]").forEach(function(c) {
    c.classList.toggle("active", isActive);
  });
  applyChartSegmentStateAllPanels();
}
function applyChartSegmentStateAllPanels() {
  document.querySelectorAll(".tk-metric-panel").forEach(function(panel) {
    applyChartSegmentState(panel);
  });
}
function applyChartSegmentState(panel) {
  var chartArea = panel.querySelector(".mv-chart-area");
  if (!chartArea) return;
  for (var seg in chartSegments) {
    var isVisible = chartSegments[seg] && (activeSegments[seg] !== false);
    chartArea.querySelectorAll("path[data-segment=\"" + seg + "\"]").forEach(function(el) {
      el.style.display = isVisible ? "" : "none";
    });
    chartArea.querySelectorAll("circle[data-segment=\"" + seg + "\"]").forEach(function(el) {
      el.style.display = isVisible ? "" : "none";
    });
    chartArea.querySelectorAll(".tk-chart-label[data-segment=\"" + seg + "\"]").forEach(function(el) {
      el.style.display = isVisible ? "" : "none";
    });
    chartArea.querySelectorAll(".tk-chart-legend-item[data-segment=\"" + seg + "\"]").forEach(function(el) {
      el.style.display = isVisible ? "" : "none";
    });
  }
  rebuildChartLines(panel);
}
function rebuildChartLines(panel) {
  var chartArea = panel.querySelector(".mv-chart-area");
  if (!chartArea) return;
  var svg = chartArea.querySelector("svg");
  if (!svg) return;
  var paths = svg.querySelectorAll("path.tk-chart-line");
  paths.forEach(function(pathEl) {
    var segName = pathEl.getAttribute("data-segment");
    if (!segName) return;
    if (pathEl.style.display === "none") return;
    var circles = svg.querySelectorAll("circle.tk-chart-point[data-segment=\"" + segName + "\"]");
    var visiblePoints = [];
    circles.forEach(function(circle) {
      if (circle.style.display !== "none") {
        visiblePoints.push({
          x: parseFloat(circle.getAttribute("cx")),
          y: parseFloat(circle.getAttribute("cy"))
        });
      }
    });
    if (visiblePoints.length < 2) {
      pathEl.setAttribute("d", "");
      return;
    }
    var d = smoothPathFromPoints(visiblePoints);
    pathEl.setAttribute("d", d);
  });
}
function smoothPathFromPoints(points) {
  var n = points.length;
  if (n < 2) return "";
  var d = "M" + points[0].x.toFixed(1) + "," + points[0].y.toFixed(1);
  if (n === 2) {
    d += " L" + points[1].x.toFixed(1) + "," + points[1].y.toFixed(1);
    return d;
  }
  var alpha = 0.5 / 3;
  for (var i = 0; i < n - 1; i++) {
    var p1 = points[i];
    var p2 = points[i + 1];
    var p0, p3;
    if (i === 0) {
      p0 = { x: 2 * p1.x - p2.x, y: 2 * p1.y - p2.y };
    } else {
      p0 = points[i - 1];
    }
    if (i === n - 2) {
      p3 = { x: 2 * p2.x - p1.x, y: 2 * p2.y - p1.y };
    } else {
      p3 = points[i + 2];
    }
    var cp1x = p1.x + alpha * (p2.x - p0.x);
    var cp1y = p1.y + alpha * (p2.y - p0.y);
    var cp2x = p2.x - alpha * (p3.x - p1.x);
    var cp2y = p2.y - alpha * (p3.y - p1.y);
    d += " C" + cp1x.toFixed(1) + "," + cp1y.toFixed(1) +
         " " + cp2x.toFixed(1) + "," + cp2y.toFixed(1) +
         " " + p2.x.toFixed(1) + "," + p2.y.toFixed(1);
  }
  return d;
}
function toggleSignificance() {
  document.body.classList.toggle("hide-significance");
}
function toggleMetricCounts(metricId) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  panel.classList.toggle("show-freq");
}
function toggleShowChart(metricId, show) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var chartArea = panel.querySelector(".mv-chart-area");
  if (chartArea) {
    chartArea.style.display = show ? "block" : "none";
  }
  var chartSegBar = panel.querySelector(".mv-chart-segment-chips");
  if (chartSegBar) {
    chartSegBar.style.display = show ? "flex" : "none";
  }
  if (show) {
    initChartSegmentState();
    syncChartSegmentChips();
    applyChartSegmentState(panel);
  }
}
function toggleMetricChangeRows(metricId, changeType) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var rows = panel.querySelectorAll(".tk-change-row.tk-" + changeType);
  rows.forEach(function(row) {
    row.classList.toggle("visible");
  });
}
function toggleMetricInsight(metricId) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var toggleBtn = panel.querySelector(".insight-toggle");
  var container = panel.querySelector(".insight-container");
  if (container.style.display === "none" || container.style.display === "") {
    container.style.display = "block";
    if (toggleBtn) toggleBtn.style.display = "none";
    var editor = container.querySelector(".insight-editor");
    if (editor) editor.focus();
  } else {
    container.style.display = "none";
    if (toggleBtn) toggleBtn.style.display = "";
  }
}
function syncMetricInsight(metricId) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var editor = panel.querySelector(".insight-editor");
  var store = panel.querySelector(".insight-store");
  if (editor && store) {
    store.value = editor.innerHTML;
  }
}
function dismissMetricInsight(metricId) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var editor = panel.querySelector(".insight-editor");
  var store = panel.querySelector(".insight-store");
  var container = panel.querySelector(".insight-container");
  var toggleBtn = panel.querySelector(".insight-toggle");
  if (editor) editor.innerHTML = "";
  if (store) store.value = "";
  if (container) container.style.display = "none";
  if (toggleBtn) toggleBtn.style.display = "";
}
function pinMetricView(metricId) {
  if (typeof togglePin === "function") {
    togglePin(metricId);
  }
}
var metricSortState = {};
var metricOriginalOrder = {};
function sortMetricTable(metricId, colIndex, headerEl) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var table = panel.querySelector(".mv-metric-table");
  if (!table) return;
  var tbody = table.querySelector("tbody");
  if (!tbody) return;
  if (!metricOriginalOrder[metricId]) {
    metricOriginalOrder[metricId] = Array.from(tbody.querySelectorAll("tr"));
  }
  var state = metricSortState[metricId] || {};
  var dir;
  if (state.col === colIndex) {
    if (state.dir === "desc") {
      dir = "asc";
    } else if (state.dir === "asc") {
      dir = "original";
    } else {
      dir = "desc";
    }
  } else {
    dir = "desc";
  }
  metricSortState[metricId] = { col: colIndex, dir: dir };
  table.querySelectorAll(".tk-sortable").forEach(function(th) {
    th.classList.remove("sort-asc", "sort-desc");
  });
  if (dir === "original") {
    metricSortState[metricId] = {};
    while (tbody.firstChild) tbody.removeChild(tbody.firstChild);
    metricOriginalOrder[metricId].forEach(function(row) {
      tbody.appendChild(row);
    });
    return;
  }
  headerEl.classList.add(dir === "asc" ? "sort-asc" : "sort-desc");
  var rows = Array.from(tbody.querySelectorAll("tr"));
  var groups = [];
  var i = 0;
  while (i < rows.length) {
    var row = rows[i];
    if (row.classList.contains("tk-metric-row")) {
      var group = { metric: row, changes: [], sortVal: 0 };
      var cells = row.querySelectorAll("td");
      if (colIndex < cells.length) {
        group.sortVal = parseFloat(cells[colIndex].getAttribute("data-sort-val")) || 0;
      }
      i++;
      while (i < rows.length && rows[i].classList.contains("tk-change-row")) {
        group.changes.push(rows[i]);
        i++;
      }
      groups.push(group);
    } else {
      i++;
    }
  }
  groups.sort(function(a, b) {
    return dir === "desc" ? b.sortVal - a.sortVal : a.sortVal - b.sortVal;
  });
  while (tbody.firstChild) tbody.removeChild(tbody.firstChild);
  groups.forEach(function(g) {
    tbody.appendChild(g.metric);
    g.changes.forEach(function(cr) { tbody.appendChild(cr); });
  });
}
function exportMetricExcel(metricId) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return;
  var table = panel.querySelector(".mv-metric-table");
  if (!table) return;
  var titleEl = panel.querySelector(".mv-metric-title");
  var title = titleEl ? titleEl.textContent.trim() : metricId;
  var showFreq = panel.classList.contains("show-freq");
  var xml = '<?xml version="1.0"?>\n';
  xml += '<?mso-application progid="Excel.Sheet"?>\n';
  xml += '<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n';
  xml += ' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">\n';
  xml += '<Styles>\n';
  xml += '<Style ss:ID="Default"><Font ss:FontName="Calibri" ss:Size="11"/></Style>\n';
  xml += '<Style ss:ID="Title"><Font ss:FontName="Calibri" ss:Size="14" ss:Bold="1"/></Style>\n';
  xml += '<Style ss:ID="Header"><Font ss:FontName="Calibri" ss:Size="11" ss:Bold="1"/><Interior ss:Color="#D9E2F3" ss:Pattern="Solid"/></Style>\n';
  xml += '<Style ss:ID="Change"><Font ss:FontName="Calibri" ss:Size="10" ss:Color="#666666"/><Interior ss:Color="#F5F5F5" ss:Pattern="Solid"/></Style>\n';
  xml += '<Style ss:ID="SigUp"><Font ss:FontName="Calibri" ss:Size="10" ss:Color="#008000" ss:Bold="1"/><Interior ss:Color="#F5F5F5" ss:Pattern="Solid"/></Style>\n';
  xml += '<Style ss:ID="SigDown"><Font ss:FontName="Calibri" ss:Size="10" ss:Color="#C00000" ss:Bold="1"/><Interior ss:Color="#F5F5F5" ss:Pattern="Solid"/></Style>\n';
  xml += '<Style ss:ID="Freq"><Font ss:FontName="Calibri" ss:Size="9" ss:Color="#94A3B8"/></Style>\n';
  xml += '</Styles>\n';
  xml += '<Worksheet ss:Name="' + xmlEscape(title.substring(0, 31)) + '">\n<Table>\n';
  xml += '<Row><Cell ss:StyleID="Title"><Data ss:Type="String">' + xmlEscape(title) + '</Data></Cell></Row>\n';
  xml += '<Row></Row>\n';
  var headerRow = table.querySelector("thead tr");
  if (headerRow) {
    xml += '<Row>\n';
    headerRow.querySelectorAll("th").forEach(function(th) {
      if (th.classList.contains("wave-hidden")) return;
      xml += '<Cell ss:StyleID="Header"><Data ss:Type="String">' + xmlEscape(th.textContent.trim()) + '</Data></Cell>\n';
    });
    xml += '</Row>\n';
  }
  var bodyRows = table.querySelectorAll("tbody tr");
  bodyRows.forEach(function(tr) {
    if (tr.classList.contains("segment-hidden")) return;
    if (tr.classList.contains("tk-change-row") && !tr.classList.contains("visible")) return;
    var isChange = tr.classList.contains("tk-change-row");
    xml += '<Row>\n';
    tr.querySelectorAll("td").forEach(function(td) {
      if (td.classList.contains("wave-hidden")) return;
      var text = "";
      var label = td.querySelector(".tk-metric-label");
      if (label) {
        text = label.textContent.trim();
      } else {
        var valSpan = td.querySelector(".tk-val");
        if (valSpan) {
          text = valSpan.textContent.trim();
          if (showFreq) {
            var freqEl = td.querySelector(".tk-freq");
            if (freqEl) text += " (" + freqEl.textContent.trim() + ")";
          }
        } else {
          text = td.textContent.trim();
        }
      }
      var style = "Default";
      if (isChange) {
        var sigUp = td.querySelector(".sig-up");
        var sigDown = td.querySelector(".sig-down");
        if (sigUp) style = "SigUp";
        else if (sigDown) style = "SigDown";
        else style = "Change";
      }
      xml += '<Cell ss:StyleID="' + style + '"><Data ss:Type="String">' + xmlEscape(text) + '</Data></Cell>\n';
    });
    xml += '</Row>\n';
  });
  xml += '</Table>\n</Worksheet>\n</Workbook>';
  var filename = "metric_" + metricId.replace(/[^a-zA-Z0-9_-]/g, "_") + ".xls";
  downloadBlob(xml, filename, "application/vnd.ms-excel");
}
var pinnedViews = [];
function togglePin(metricId) {
  var pinObj = captureMetricView(metricId);
  if (pinObj) {
    pinnedViews.push(pinObj);
  }
  renderPinnedCards();
  updatePinBadge();
  savePinnedData();
}
function captureMetricView(metricId) {
  var panel = document.getElementById("mv-" + metricId);
  if (!panel) return null;
  var titleEl = panel.querySelector(".mv-metric-title");
  var tableArea = panel.querySelector(".mv-table-area");
  var chartArea = panel.querySelector(".mv-chart-area");
  var insightEditor = panel.querySelector(".insight-editor");
  var visibleSegments = [];
  panel.querySelectorAll(".tk-segment-chip.active").forEach(function(chip) {
    visibleSegments.push(chip.getAttribute("data-segment"));
  });
  var cleanTableHtml = "";
  if (tableArea) {
    var tableClone = tableArea.cloneNode(true);
    tableClone.querySelectorAll("tr.segment-hidden").forEach(function(row) {
      row.parentNode.removeChild(row);
    });
    tableClone.querySelectorAll(".wave-hidden").forEach(function(el) {
      el.parentNode.removeChild(el);
    });
    var showFreq = panel.classList.contains("show-freq");
    var vsPrevVisible = false;
    var vsBaseVisible = false;
    var prevRows = panel.querySelectorAll(".tk-change-row.tk-vs-prev.visible");
    var baseRows = panel.querySelectorAll(".tk-change-row.tk-vs-base.visible");
    vsPrevVisible = prevRows.length > 0;
    vsBaseVisible = baseRows.length > 0;
    if (showFreq) {
      tableClone.querySelectorAll(".tk-freq").forEach(function(el) {
        el.style.display = "block";
      });
    }
    if (vsPrevVisible) {
      tableClone.querySelectorAll(".tk-change-row.tk-vs-prev").forEach(function(row) {
        row.style.display = "table-row";
      });
    } else {
      tableClone.querySelectorAll(".tk-change-row.tk-vs-prev").forEach(function(row) {
        row.parentNode.removeChild(row);
      });
    }
    if (vsBaseVisible) {
      tableClone.querySelectorAll(".tk-change-row.tk-vs-base").forEach(function(row) {
        row.style.display = "table-row";
      });
    } else {
      tableClone.querySelectorAll(".tk-change-row.tk-vs-base").forEach(function(row) {
        row.parentNode.removeChild(row);
      });
    }
    cleanTableHtml = tableClone.innerHTML;
  }
  var chartSvg = "";
  var chartVisible = false;
  if (chartArea && chartArea.style.display !== "none") {
    chartVisible = true;
    var chartClone = chartArea.cloneNode(true);
    chartClone.querySelectorAll("[data-segment]").forEach(function(el) {
      if (el.style.display === "none") {
        el.parentNode.removeChild(el);
      }
    });
    chartClone.querySelectorAll("[data-wave]").forEach(function(el) {
      if (el.style.display === "none") {
        el.parentNode.removeChild(el);
      }
    });
    chartSvg = chartClone.innerHTML;
  }
  var pinObj = {
    id: "pin-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5),
    metricId: metricId,
    metricTitle: titleEl ? titleEl.textContent : metricId,
    visibleSegments: visibleSegments,
    tableHtml: cleanTableHtml,
    chartSvg: chartSvg,
    chartVisible: chartVisible,
    insightText: insightEditor ? insightEditor.innerHTML : "",
    timestamp: Date.now(),
    order: pinnedViews.length
  };
  return pinObj;
}
function updatePinButton(metricId, isPinned) {
}
function renderPinnedCards() {
  var container = document.getElementById("pinned-cards-container");
  var emptyState = document.getElementById("pinned-empty-state");
  var toolbar = document.getElementById("pinned-toolbar");
  if (!container) return;
  var pinCount = 0;
  for (var c = 0; c < pinnedViews.length; c++) {
    if (pinnedViews[c].type !== "section") pinCount++;
  }
  if (pinCount === 0) {
    container.innerHTML = "";
    if (emptyState) emptyState.style.display = "block";
    if (toolbar) toolbar.style.display = "none";
    return;
  }
  if (emptyState) emptyState.style.display = "none";
  if (toolbar) toolbar.style.display = "flex";
  var html = "";
  var total = pinnedViews.length;
  for (var i = 0; i < total; i++) {
    var item = pinnedViews[i];
    if (item.type === "section") {
      html += "<div class=\"section-divider\" data-idx=\"" + i + "\">";
      html += "<div class=\"section-divider-title\" contenteditable=\"true\" " +
        "onblur=\"updateSectionTitle(" + i + ", this.textContent)\">" +
        escapeHtml(item.title) + "</div>";
      html += "<div class=\"section-divider-actions\">";
      if (i > 0) html += "<button class=\"tk-btn tk-btn-sm\" onclick=\"movePinned(" + i + "," + (i - 1) + ")\" title=\"Move up\">\u2191</button>";
      if (i < total - 1) html += "<button class=\"tk-btn tk-btn-sm\" onclick=\"movePinned(" + i + "," + (i + 1) + ")\" title=\"Move down\">\u2193</button>";
      html += "<button class=\"tk-btn tk-btn-sm\" style=\"color:#e8614d;\" onclick=\"removePinned('" + item.id + "','')\" title=\"Remove section\">\u00d7</button>";
      html += "</div></div>";
      continue;
    }
    var pin = item;
    html += "<div class=\"pinned-card\" data-pin-id=\"" + pin.id + "\">";
    html += "<div class=\"pinned-card-header\">";
    html += "<h3 class=\"pinned-card-title\">" + escapeHtml(pin.metricTitle) + "</h3>";
    html += "<div class=\"pinned-card-actions\">";
    html += "<button class=\"tk-btn tk-btn-sm\" onclick=\"exportPinnedCardPNG('" + pin.id + "')\" title=\"Export as PNG\">&#x1F4F8;</button>";
    if (i > 0) {
      html += "<button class=\"tk-btn tk-btn-sm\" onclick=\"movePinned(" + i + "," + (i - 1) + ")\" title=\"Move up\">\u2191</button>";
    }
    if (i < total - 1) {
      html += "<button class=\"tk-btn tk-btn-sm\" onclick=\"movePinned(" + i + "," + (i + 1) + ")\" title=\"Move down\">\u2193</button>";
    }
    html += "<button class=\"tk-btn tk-btn-sm\" onclick=\"removePinned('" + pin.id + "','" + pin.metricId + "')\" title=\"Remove pin\">\u00d7</button>";
    html += "</div></div>";
    html += "<div class=\"pinned-card-insight-area\">";
    if (pin.insightText) {
      html += "<div class=\"pinned-card-insight-editor insight-editor\" contenteditable=\"true\" data-pin-id=\"" + pin.id + "\" oninput=\"syncPinnedInsight('" + pin.id + "',this)\">" + pin.insightText + "</div>";
    } else {
      html += "<button class=\"insight-toggle pinned-insight-toggle\" onclick=\"showPinnedInsight('" + pin.id + "',this)\">+ Add Insight</button>";
      html += "<div class=\"pinned-card-insight-editor insight-editor\" contenteditable=\"true\" data-pin-id=\"" + pin.id + "\" oninput=\"syncPinnedInsight('" + pin.id + "',this)\" style=\"display:none\" data-placeholder=\"Type insight for this pin...\"></div>";
    }
    html += "</div>";
    if (pin.chartSvg && pin.chartVisible !== false) {
      html += "<div class=\"pinned-card-chart\">" + pin.chartSvg + "</div>";
    }
    if (pin.tableHtml) {
      html += "<div class=\"pinned-card-body\">" + pin.tableHtml + "</div>";
    }
    html += "<div class=\"pinned-card-meta\">" + new Date(pin.timestamp).toLocaleString() + "</div>";
    html += "</div>";
  }
  container.innerHTML = html;
}
function addSection(title) {
  title = title || "New Section";
  pinnedViews.push({
    type: "section",
    title: title,
    id: "sec-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5)
  });
  renderPinnedCards();
  savePinnedData();
}
function updateSectionTitle(idx, newTitle) {
  if (idx >= 0 && idx < pinnedViews.length && pinnedViews[idx].type === "section") {
    pinnedViews[idx].title = newTitle.trim() || "Untitled Section";
    savePinnedData();
  }
}
function movePinned(fromIdx, toIdx) {
  if (fromIdx < 0 || toIdx < 0 || fromIdx >= pinnedViews.length || toIdx >= pinnedViews.length) return;
  var item = pinnedViews.splice(fromIdx, 1)[0];
  pinnedViews.splice(toIdx, 0, item);
  renderPinnedCards();
  savePinnedData();
}
function removePinned(pinId, metricId) {
  pinnedViews = pinnedViews.filter(function(p) { return p.id !== pinId; });
  renderPinnedCards();
  updatePinBadge();
  savePinnedData();
}
function updatePinBadge() {
  var badge = document.getElementById("pin-count-badge");
  if (badge) {
    badge.textContent = pinnedViews.length;
    badge.style.display = pinnedViews.length > 0 ? "inline-block" : "none";
  }
}
function showPinnedInsight(pinId, btn) {
  var editor = btn.nextElementSibling;
  if (editor) {
    editor.style.display = "block";
    editor.focus();
  }
  btn.style.display = "none";
}
function syncPinnedInsight(pinId, editor) {
  for (var i = 0; i < pinnedViews.length; i++) {
    if (pinnedViews[i].id === pinId) {
      pinnedViews[i].insightText = editor.innerHTML;
      break;
    }
  }
  savePinnedData();
}
function savePinnedData() {
  var store = document.getElementById("pinned-views-data");
  if (store) {
    store.textContent = JSON.stringify(pinnedViews);
  }
}
function hydratePinnedViews() {
  var store = document.getElementById("pinned-views-data");
  if (store) {
    try {
      pinnedViews = JSON.parse(store.textContent || "[]");
      renderPinnedCards();
      updatePinBadge();
    } catch (e) {
      pinnedViews = [];
    }
  }
}
function escapeHtml(str) {
  var div = document.createElement("div");
  div.textContent = str;
  return div.innerHTML;
}
function pinWrapTextLines(text, maxWidth, charWidth) {
  if (!text) return [];
  var maxChars = Math.floor(maxWidth / charWidth);
  if (text.length <= maxChars) return [text];
  var words = text.split(" ");
  var lines = [], current = "";
  for (var i = 0; i < words.length; i++) {
    var test = current ? current + " " + words[i] : words[i];
    if (test.length > maxChars && current) {
      lines.push(current);
      current = words[i];
    } else {
      current = test;
    }
  }
  if (current) lines.push(current);
  return lines;
}
function pinCreateWrappedText(ns, lines, x, startY, lineHeight, attrs) {
  var el = document.createElementNS(ns, "text");
  el.setAttribute("x", x);
  for (var key in attrs) { el.setAttribute(key, attrs[key]); }
  for (var i = 0; i < lines.length; i++) {
    var tspan = document.createElementNS(ns, "tspan");
    tspan.setAttribute("x", x);
    tspan.setAttribute("y", startY + i * lineHeight);
    tspan.textContent = lines[i];
    el.appendChild(tspan);
  }
  return { element: el, height: lines.length * lineHeight };
}
function extractPinTableData(tableHtml) {
  if (!tableHtml) return null;
  var tempDiv = document.createElement("div");
  tempDiv.innerHTML = tableHtml;
  var table = tempDiv.querySelector("table");
  if (!table) return null;
  var rows = [];
  var headerCells = [];
  var headerRow = table.querySelector("thead tr");
  if (headerRow) {
    headerRow.querySelectorAll("th").forEach(function(th) {
      if (th.style.display === "none") return;
      headerCells.push(th.textContent.trim());
    });
    if (headerCells.length > 0) {
      rows.push({ cells: headerCells, type: "header" });
    }
  }
  table.querySelectorAll("tbody tr").forEach(function(tr) {
    if (tr.style.display === "none") return;
    var rowInfo = { cells: [], type: "data" };
    if (tr.classList.contains("tk-base-row")) {
      rowInfo.type = "base";
      var baseLabel = tr.querySelector(".tk-base-label");
      rowInfo.cells.push(baseLabel ? baseLabel.textContent.trim() : "Base");
      tr.querySelectorAll("td.tk-base-cell").forEach(function(td) {
        if (td.style.display === "none") return;
        rowInfo.cells.push(td.textContent.trim());
      });
    } else if (tr.classList.contains("tk-change-row")) {
      rowInfo.type = "change";
      var changeLabel = tr.querySelector(".tk-change-label");
      rowInfo.cells.push(changeLabel ? changeLabel.textContent.trim() : "Change");
      tr.querySelectorAll("td.tk-change-cell").forEach(function(td) {
        if (td.style.display === "none") return;
        rowInfo.cells.push(td.textContent.trim());
      });
    } else if (tr.classList.contains("tk-metric-row")) {
      var segName = tr.getAttribute("data-segment") || "";
      rowInfo.type = segName === "Total" ? "total" : "data";
      var labelEl = tr.querySelector(".tk-metric-label");
      rowInfo.cells.push(labelEl ? labelEl.textContent.trim() : segName);
      tr.querySelectorAll("td.tk-value-cell").forEach(function(td) {
        if (td.style.display === "none") return;
        var valSpan = td.querySelector(".tk-val");
        rowInfo.cells.push(valSpan ? valSpan.textContent.trim() : td.textContent.trim());
      });
      var dot = tr.querySelector(".tk-seg-dot");
      if (dot) {
        rowInfo.colour = dot.style.background || dot.style.backgroundColor || null;
      }
    } else {
      tr.querySelectorAll("th, td").forEach(function(cell) {
        if (cell.style.display === "none") return;
        rowInfo.cells.push(cell.textContent.trim());
      });
    }
    if (rowInfo.cells.length > 0) {
      rows.push(rowInfo);
    }
  });
  return rows.length > 0 ? rows : null;
}
function renderPinTableSVG(ns, svgParent, tableData, x, y, maxWidth) {
  if (!tableData || tableData.length === 0) return 0;
  var nCols = tableData[0].cells.length;
  if (nCols === 0) return 0;
  var COLOURS = [
    "#323367", "#CC9900", "#2E8B57", "#CD5C5C", "#4682B4",
    "#9370DB", "#D2691E", "#20B2AA", "#8B4513", "#6A5ACD"
  ];
  var baseRowH = 22, headerH = 26, fontSize = 10, padX = 6;
  var firstColW = Math.min(Math.max(maxWidth * 0.25, 140), 260);
  var dataColW = nCols > 1 ? (maxWidth - firstColW) / (nCols - 1) : maxWidth;
  var curY = y;
  var colourIdx = 0;
  tableData.forEach(function(row, ri) {
    var isHeader = row.type === "header";
    var rH = isHeader ? headerH : baseRowH;
    var bgRect = document.createElementNS(ns, "rect");
    bgRect.setAttribute("x", x); bgRect.setAttribute("y", curY);
    bgRect.setAttribute("width", maxWidth); bgRect.setAttribute("height", rH);
    if (isHeader) {
      bgRect.setAttribute("fill", "#1a2744");
    } else if (row.type === "base") {
      bgRect.setAttribute("fill", "#f8f9fa");
    } else if (row.type === "change") {
      bgRect.setAttribute("fill", "#fafbfc");
    } else if (row.type === "total") {
      bgRect.setAttribute("fill", "#f0f0f5");
    } else if (ri % 2 === 0) {
      bgRect.setAttribute("fill", "#ffffff");
    } else {
      bgRect.setAttribute("fill", "#f9fafb");
    }
    svgParent.appendChild(bgRect);
    if (row.type === "data" || row.type === "total") {
      var dotColour = row.colour || COLOURS[colourIdx % COLOURS.length];
      var dot = document.createElementNS(ns, "circle");
      dot.setAttribute("cx", x + 12);
      dot.setAttribute("cy", curY + rH / 2);
      dot.setAttribute("r", "3.5");
      dot.setAttribute("fill", dotColour);
      svgParent.appendChild(dot);
      colourIdx++;
    }
    row.cells.forEach(function(cellText, ci) {
      var cellW = ci === 0 ? firstColW : dataColW;
      var cellX;
      if (ci === 0) {
        cellX = (row.type === "data" || row.type === "total") ? x + 22 : x + padX;
      } else {
        cellX = x + firstColW + (ci - 1) * dataColW;
      }
      var textEl = document.createElementNS(ns, "text");
      textEl.setAttribute("y", curY + rH / 2 + 1);
      textEl.setAttribute("dominant-baseline", "central");
      textEl.setAttribute("font-size", fontSize);
      if (ci === 0) {
        textEl.setAttribute("x", cellX);
        textEl.setAttribute("text-anchor", "start");
      } else {
        textEl.setAttribute("x", cellX + cellW / 2);
        textEl.setAttribute("text-anchor", "middle");
      }
      if (isHeader) {
        textEl.setAttribute("fill", "#ffffff");
        textEl.setAttribute("font-weight", "600");
      } else if (row.type === "total") {
        textEl.setAttribute("fill", ci === 0 ? "#1a2744" : "#1e293b");
        textEl.setAttribute("font-weight", "600");
      } else if (row.type === "base") {
        textEl.setAttribute("fill", "#666666");
        textEl.setAttribute("font-weight", "600");
        textEl.setAttribute("font-size", fontSize - 1);
      } else if (row.type === "change") {
        textEl.setAttribute("fill", "#888888");
        textEl.setAttribute("font-size", fontSize - 1);
      } else {
        textEl.setAttribute("fill", ci === 0 ? "#374151" : "#1e293b");
      }
      var maxChars = Math.floor((cellW - padX * 2) / (fontSize * 0.55));
      if (maxChars > 0 && cellText.length > maxChars) {
        cellText = cellText.substring(0, Math.max(maxChars - 1, 5)) + "\u2026";
      }
      textEl.textContent = cellText;
      svgParent.appendChild(textEl);
    });
    var borderLine = document.createElementNS(ns, "line");
    borderLine.setAttribute("x1", x); borderLine.setAttribute("x2", x + maxWidth);
    borderLine.setAttribute("y1", curY + rH); borderLine.setAttribute("y2", curY + rH);
    borderLine.setAttribute("stroke", "#e2e8f0"); borderLine.setAttribute("stroke-width", "0.5");
    svgParent.appendChild(borderLine);
    curY += rH;
  });
  return curY - y;
}
function exportPinnedCardPNG(pinId) {
  var pin = null;
  for (var i = 0; i < pinnedViews.length; i++) {
    if (pinnedViews[i].id === pinId) { pin = pinnedViews[i]; break; }
  }
  if (!pin) return;
  var ns = "http://www.w3.org/2000/svg";
  var W = 1280;
  var fontFamily = "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif";
  var pad = 28;
  var usableW = W - pad * 2;
  var brandColour = getComputedStyle(document.documentElement).getPropertyValue("--brand").trim() || "#323367";
  var titleText = pin.metricTitle || "Pinned View";
  var titleLines = pinWrapTextLines(titleText, usableW, 9.5);
  var titleLineH = 20;
  var titleStartY = pad + 16;
  var titleBlockH = titleLines.length * titleLineH;
  var metaText = new Date(pin.timestamp).toLocaleDateString();
  if (pin.visibleSegments && pin.visibleSegments.length > 0) {
    metaText += "  \u00B7  Segments: " + pin.visibleSegments.join(", ");
  }
  var metaY = titleStartY + titleBlockH + 4;
  var contentTop = metaY + 18;
  var insightPlain = "";
  if (pin.insightText) {
    var tmpDiv = document.createElement("div");
    tmpDiv.innerHTML = pin.insightText;
    insightPlain = tmpDiv.textContent.trim();
  }
  var insightLines = pinWrapTextLines(insightPlain, usableW - 16, 7.5);
  var insightLineH = 17;
  var insightBlockH = insightLines.length > 0 ? insightLines.length * insightLineH + 24 : 0;
  var insightY = contentTop;
  var chartTopY = contentTop + insightBlockH + (insightBlockH > 0 ? 12 : 0);
  var chartDisplayH = 0;
  var chartClone = null;
  var chartScale = 1;
  if (pin.chartSvg && pin.chartVisible !== false) {
    var chartTempDiv = document.createElement("div");
    chartTempDiv.innerHTML = pin.chartSvg;
    var svgEl = chartTempDiv.querySelector("svg");
    if (svgEl) {
      chartClone = svgEl.cloneNode(true);
      chartClone.querySelectorAll("*").forEach(function(el) {
        ["fill", "stroke"].forEach(function(attr) {
          var val = el.getAttribute(attr);
          if (val && val.indexOf("var(") !== -1) {
            var match = val.match(/var\(--[^,)]+,\s*([^)]+)\)/);
            if (match) el.setAttribute(attr, match[1].trim());
          }
        });
      });
      var vb = chartClone.getAttribute("viewBox");
      if (vb) {
        var chartVB = vb.split(" ").map(Number);
        var chartOrigW = chartVB[2];
        var chartOrigH = chartVB[3];
        chartScale = usableW / chartOrigW;
        chartDisplayH = chartOrigH * chartScale;
      }
    }
  }
  var tableTopY = chartTopY + chartDisplayH + (chartDisplayH > 0 ? 14 : 0);
  var tableData = null;
  var estimatedTableH = 0;
  if (pin.tableHtml) {
    tableData = extractPinTableData(pin.tableHtml);
    if (tableData && tableData.length > 0) {
      estimatedTableH = 26 + (tableData.length - 1) * 22 + 8;
    }
  }
  var totalH = tableTopY + estimatedTableH + pad + 20;
  if (totalH < 300) totalH = 300;
  var svg = document.createElementNS(ns, "svg");
  svg.setAttribute("xmlns", ns);
  svg.setAttribute("viewBox", "0 0 " + W + " " + totalH);
  svg.setAttribute("style", "font-family:" + fontFamily + ";");
  var bg = document.createElementNS(ns, "rect");
  bg.setAttribute("width", W); bg.setAttribute("height", totalH);
  bg.setAttribute("fill", "#ffffff");
  svg.appendChild(bg);
  var accentBar = document.createElementNS(ns, "rect");
  accentBar.setAttribute("x", "0"); accentBar.setAttribute("y", "0");
  accentBar.setAttribute("width", W); accentBar.setAttribute("height", "4");
  accentBar.setAttribute("fill", brandColour);
  svg.appendChild(accentBar);
  var titleResult = pinCreateWrappedText(ns, titleLines, pad, titleStartY, titleLineH,
    { fill: "#1a2744", "font-size": "16", "font-weight": "700" });
  svg.appendChild(titleResult.element);
  var metaEl = document.createElementNS(ns, "text");
  metaEl.setAttribute("x", pad); metaEl.setAttribute("y", metaY);
  metaEl.setAttribute("fill", "#94a3b8"); metaEl.setAttribute("font-size", "11");
  metaEl.textContent = metaText;
  svg.appendChild(metaEl);
  if (insightLines.length > 0) {
    var accentH = Math.max(28, insightLines.length * insightLineH + 12);
    var insBg = document.createElementNS(ns, "rect");
    insBg.setAttribute("x", pad); insBg.setAttribute("y", insightY + 2);
    insBg.setAttribute("width", usableW); insBg.setAttribute("height", accentH);
    insBg.setAttribute("rx", "4"); insBg.setAttribute("fill", "#f0f4ff");
    svg.appendChild(insBg);
    var iBar = document.createElementNS(ns, "rect");
    iBar.setAttribute("x", pad); iBar.setAttribute("y", insightY + 2);
    iBar.setAttribute("width", "4"); iBar.setAttribute("height", accentH);
    iBar.setAttribute("fill", brandColour); iBar.setAttribute("rx", "2");
    svg.appendChild(iBar);
    var insResult = pinCreateWrappedText(ns, insightLines, pad + 14, insightY + 18, insightLineH,
      { fill: "#1a2744", "font-size": "13", "font-weight": "500" });
    svg.appendChild(insResult.element);
  }
  if (chartClone && chartDisplayH > 0) {
    var chartG = document.createElementNS(ns, "g");
    chartG.setAttribute("transform", "translate(" + pad + "," + chartTopY + ") scale(" + chartScale + ")");
    while (chartClone.firstChild) chartG.appendChild(chartClone.firstChild);
    svg.appendChild(chartG);
  }
  if (tableData && tableData.length > 0) {
    var actualTableH = renderPinTableSVG(ns, svg, tableData, pad, tableTopY, usableW);
    var newTotalH = tableTopY + actualTableH + pad + 20;
    if (newTotalH > totalH) {
      totalH = newTotalH;
      bg.setAttribute("height", totalH);
      svg.setAttribute("viewBox", "0 0 " + W + " " + totalH);
    }
  }
  var footerY = totalH - pad;
  var footerLine = document.createElementNS(ns, "line");
  footerLine.setAttribute("x1", pad); footerLine.setAttribute("x2", W - pad);
  footerLine.setAttribute("y1", footerY); footerLine.setAttribute("y2", footerY);
  footerLine.setAttribute("stroke", "#e2e8f0"); footerLine.setAttribute("stroke-width", "0.5");
  svg.appendChild(footerLine);
  var footerText = document.createElementNS(ns, "text");
  footerText.setAttribute("x", W - pad); footerText.setAttribute("y", footerY + 14);
  footerText.setAttribute("text-anchor", "end");
  footerText.setAttribute("fill", "#cbd5e1"); footerText.setAttribute("font-size", "9");
  footerText.textContent = "Tracking Report";
  svg.appendChild(footerText);
  var renderScale = 3;
  var svgData = new XMLSerializer().serializeToString(svg);
  var svgBlob = new Blob([svgData], { type: "image/svg+xml;charset=utf-8" });
  var url = URL.createObjectURL(svgBlob);
  var img = new Image();
  img.onerror = function() {
    URL.revokeObjectURL(url);
    console.error("[Pin PNG] SVG render failed for pin: " + pinId);
    alert("PNG export failed. Please try using Chrome or Edge browser.");
  };
  img.onload = function() {
    var canvas = document.createElement("canvas");
    canvas.width = W * renderScale;
    canvas.height = totalH * renderScale;
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = "#ffffff";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    URL.revokeObjectURL(url);
    canvas.toBlob(function(blob) {
      if (!blob) return;
      var filename = "pinned_" + pin.metricTitle.replace(/[^a-zA-Z0-9]/g, "_") + ".png";
      var a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);
    }, "image/png");
  };
  img.src = url;
}
function downloadDataUrlAsPng(dataUrl, filename) {
  try {
    var parts = dataUrl.split(",");
    var mime = parts[0].match(/:(.*?);/)[1];
    var bstr = atob(parts[1]);
    var n = bstr.length;
    var u8 = new Uint8Array(n);
    for (var i = 0; i < n; i++) u8[i] = bstr.charCodeAt(i);
    var blob = new Blob([u8], { type: mime });
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  } catch (e) {
    var a2 = document.createElement("a");
    a2.href = dataUrl;
    a2.download = filename;
    document.body.appendChild(a2);
    a2.click();
    document.body.removeChild(a2);
  }
}
function cleanCloneForExport(clone) {
  clone.querySelectorAll("[contenteditable]").forEach(function(el) {
    el.removeAttribute("contenteditable");
  });
  clone.querySelectorAll("[oninput],[onblur],[onclick]").forEach(function(el) {
    el.removeAttribute("oninput");
    el.removeAttribute("onblur");
    el.removeAttribute("onclick");
  });
}
function sanitizeForSvg(html) {
  html = html.replace(/&(?![a-zA-Z]+;|#\d+;|#x[0-9a-fA-F]+;)/g, "&amp;");
  html = html.replace(/<br\s*>/gi, "<br/>");
  html = html.replace(/<hr\s*>/gi, "<hr/>");
  html = html.replace(/<img([^>]*?)(?<!\/)>/gi, "<img$1/>");
  html = html.replace(/<input([^>]*?)(?<!\/)>/gi, "<input$1/>");
  html = html.replace(/<col([^>]*?)(?<!\/)>/gi, "<col$1/>");
  html = html.replace(/<wbr\s*>/gi, "<wbr/>");
  html = html.replace(/<source([^>]*?)(?<!\/)>/gi, "<source$1/>");
  html = html.replace(/<meta([^>]*?)(?<!\/)>/gi, "<meta$1/>");
  html = html.replace(/<link([^>]*?)(?<!\/)>/gi, "<link$1/>");
  return html;
}
function inlineStyles(el) {
  if (el.nodeType !== 1) return;
  var computed = window.getComputedStyle(el);
  var important = [
    "font-family", "font-size", "font-weight", "color", "background-color",
    "background", "border", "border-radius", "padding", "margin",
    "display", "text-align", "line-height", "white-space",
    "border-bottom", "border-top", "overflow"
  ];
  for (var i = 0; i < important.length; i++) {
    el.style[important[i]] = computed.getPropertyValue(important[i]);
  }
  for (var c = 0; c < el.children.length; c++) {
    inlineStyles(el.children[c]);
  }
}
function exportAllPinsPNG() {
  var pins = [];
  for (var p = 0; p < pinnedViews.length; p++) {
    if (pinnedViews[p].type !== "section") pins.push(pinnedViews[p]);
  }
  if (pins.length === 0) return;
  var idx = 0;
  function exportNext() {
    if (idx >= pins.length) return;
    exportPinnedCardPNG(pins[idx].id);
    idx++;
    setTimeout(exportNext, 300);
  }
  exportNext();
}
function printAllPins() {
  if (typeof switchReportTab === "function") {
    switchReportTab("pinned");
  }
  document.body.classList.add("print-pinned-only");
  setTimeout(function() {
    window.print();
    setTimeout(function() {
      document.body.classList.remove("print-pinned-only");
    }, 500);
  }, 200);
}
function saveReportHTML() {
  savePinnedData();
  var dateBadge = document.getElementById("header-date-badge");
  if (dateBadge) {
    var now = new Date();
    var months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    var d = now.getDate();
    var m = months[now.getMonth()];
    var y = now.getFullYear();
    var hh = String(now.getHours()).padStart(2, "0");
    var mm = String(now.getMinutes()).padStart(2, "0");
    dateBadge.textContent = "Last saved " + d + " " + m + " " + y + " " + hh + ":" + mm;
  }
  document.querySelectorAll(".insight-editor").forEach(function(editor) {
    var store = editor.closest(".insight-area");
    if (store) {
      var textarea = store.querySelector(".insight-store");
      if (textarea) textarea.value = editor.innerHTML;
    }
  });
  document.querySelectorAll(".summary-editor").forEach(function(editor) {
    editor.setAttribute("data-saved-content", editor.innerHTML);
  });
  var htmlContent = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
  var blob = new Blob([htmlContent], { type: "text/html;charset=utf-8" });
  var a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  var projectTitle = document.querySelector(".tk-header-project");
  var filename = projectTitle ? projectTitle.textContent.trim().replace(/[^a-zA-Z0-9_-]/g, "_") : "tracking_report";
  a.download = filename + "_updated.html";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(a.href);
}
function pinSummarySection(sectionType) {
  var editorId = sectionType === "background"
    ? "summary-background-editor"
    : "summary-findings-editor";
  var editor = document.getElementById(editorId);
  if (!editor || !editor.innerHTML.trim()) {
    alert("Add content before pinning.");
    return;
  }
  var title = sectionType === "background" ? "Background & Method" : "Summary";
  var pinObj = {
    id: "pin-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5),
    metricId: "summary-" + sectionType,
    metricTitle: title,
    visibleSegments: [],
    tableHtml: "",
    chartSvg: "",
    chartVisible: false,
    insightText: editor.innerHTML,
    timestamp: Date.now(),
    order: pinnedViews.length
  };
  pinnedViews.push(pinObj);
  renderPinnedCards();
  updatePinBadge();
  savePinnedData();
}
function pinSigChanges() {
  var section = document.getElementById("summary-section-sig-changes");
  if (!section) {
    alert("No significant changes section found.");
    return;
  }
  var cards = section.querySelectorAll(".dash-sig-card");
  if (cards.length === 0) {
    alert("There are no significant changes to pin.");
    return;
  }
  var clone = section.cloneNode(true);
  var controls = clone.querySelector(".summary-section-controls");
  if (controls) controls.parentNode.removeChild(controls);
  var pinObj = {
    id: "pin-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5),
    metricId: "summary-sig-changes",
    metricTitle: "Significant Changes",
    visibleSegments: [],
    tableHtml: clone.innerHTML,
    chartSvg: "",
    chartVisible: false,
    insightText: "",
    timestamp: Date.now(),
    order: pinnedViews.length
  };
  pinnedViews.push(pinObj);
  renderPinnedCards();
  updatePinBadge();
  savePinnedData();
}
function exportSummarySlide(sectionType) {
  var sectionId;
  if (sectionType === "background") {
    sectionId = "summary-section-background";
  } else if (sectionType === "sig-changes") {
    sectionId = "summary-section-sig-changes";
  } else {
    sectionId = "summary-section-findings";
  }
  var section = document.getElementById(sectionId);
  if (!section) return;
  var clone = section.cloneNode(true);
  var controls = clone.querySelector(".summary-section-controls");
  if (controls) controls.parentNode.removeChild(controls);
  cleanCloneForExport(clone);
  inlineStyles(clone);
  var w = section.offsetWidth || 800;
  var h = Math.max(section.offsetHeight || 300, 200);
  var scale = 3;
  var svgNS = "http://www.w3.org/2000/svg";
  var htmlContent = sanitizeForSvg(clone.outerHTML);
  var svgStr = '<svg xmlns="' + svgNS + '" width="' + (w * scale) + '" height="' + (h * scale) + '">';
  svgStr += '<foreignObject width="' + w + '" height="' + h + '" transform="scale(' + scale + ')">';
  svgStr += '<div xmlns="http://www.w3.org/1999/xhtml" style="font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-size:14px;color:#2c2c2c;background:#fff;">';
  svgStr += htmlContent;
  svgStr += '</div></foreignObject></svg>';
  var svgBlob = new Blob([svgStr], { type: "image/svg+xml;charset=utf-8" });
  var svgUrl = URL.createObjectURL(svgBlob);
  var canvas = document.createElement("canvas");
  canvas.width = w * scale;
  canvas.height = h * scale;
  var ctx = canvas.getContext("2d");
  var img = new Image();
  img.onload = function() {
    ctx.drawImage(img, 0, 0);
    canvas.toBlob(function(blob) {
      if (!blob) return;
      var a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "summary_" + sectionType + ".png";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);
    }, "image/png");
    URL.revokeObjectURL(svgUrl);
  };
  img.onerror = function() {
    URL.revokeObjectURL(svgUrl);
  };
  img.src = svgUrl;
}
function exportSummaryExcel() {
  var table = document.getElementById("summary-metrics-table");
  if (!table) return;
  var xml = '<?xml version="1.0"?>\n';
  xml += '<?mso-application progid="Excel.Sheet"?>\n';
  xml += '<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n';
  xml += ' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">\n';
  xml += '<Styles>\n';
  xml += '<Style ss:ID="Default"><Font ss:FontName="Calibri" ss:Size="11"/></Style>\n';
  xml += '<Style ss:ID="Title"><Font ss:FontName="Calibri" ss:Size="14" ss:Bold="1"/></Style>\n';
  xml += '<Style ss:ID="Header"><Font ss:FontName="Calibri" ss:Size="11" ss:Bold="1"/><Interior ss:Color="#D9E2F3" ss:Pattern="Solid"/></Style>\n';
  xml += '</Styles>\n';
  xml += '<Worksheet ss:Name="Summary"><Table>\n';
  xml += '<Row><Cell ss:StyleID="Title"><Data ss:Type="String">Summary Metrics Overview</Data></Cell></Row>\n';
  xml += '<Row></Row>\n';
  var headerRow = table.querySelector("thead tr");
  if (headerRow) {
    xml += '<Row>\n';
    headerRow.querySelectorAll("th").forEach(function(th) {
      xml += '<Cell ss:StyleID="Header"><Data ss:Type="String">' + xmlEscape(th.textContent.trim()) + '</Data></Cell>\n';
    });
    xml += '</Row>\n';
  }
  table.querySelectorAll("tbody tr").forEach(function(tr) {
    if (tr.style.display === "none") return;
    if (tr.classList.contains("tk-base-row")) {
      xml += '<Row>\n';
      tr.querySelectorAll("td").forEach(function(td) {
        xml += '<Cell><Data ss:Type="String">' + xmlEscape(td.textContent.trim()) + '</Data></Cell>\n';
      });
      xml += '</Row>\n';
      return;
    }
    if (tr.classList.contains("tk-section-row")) {
      xml += '<Row><Cell><Data ss:Type="String">' + xmlEscape(tr.textContent.trim()) + '</Data></Cell></Row>\n';
      return;
    }
    xml += '<Row>\n';
    tr.querySelectorAll("td").forEach(function(td) {
      var label = td.querySelector(".tk-metric-label");
      var text = label ? label.textContent.trim() : td.textContent.trim();
      xml += '<Cell><Data ss:Type="String">' + xmlEscape(text) + '</Data></Cell>\n';
    });
    xml += '</Row>\n';
  });
  xml += '</Table>\n</Worksheet>\n</Workbook>';
  downloadBlob(xml, "summary_metrics.xls", "application/vnd.ms-excel");
}
function pinSummaryTable() {
  var table = document.getElementById("summary-metrics-table");
  if (!table) return;
  var clone = table.cloneNode(true);
  clone.querySelectorAll("tr").forEach(function(tr) {
    if (tr.style.display === "none") tr.parentNode.removeChild(tr);
  });
  var pinObj = {
    id: "pin-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5),
    metricId: "summary-metrics-table",
    metricTitle: "Summary Metrics Overview",
    visibleSegments: [],
    tableHtml: '<div class="tk-table-wrapper">' + clone.outerHTML + '</div>',
    chartSvg: "",
    chartVisible: false,
    insightText: "",
    timestamp: Date.now(),
    order: pinnedViews.length
  };
  pinnedViews.push(pinObj);
  renderPinnedCards();
  updatePinBadge();
  savePinnedData();
}
function exportSummaryTableSlide() {
  var table = document.getElementById("summary-metrics-table");
  if (!table) return;
  var brandColour = getComputedStyle(document.documentElement).getPropertyValue("--brand").trim() || "#323367";
  var slideW = 1280, slideH = 720, scale = 3;
  var canvas = document.createElement("canvas");
  canvas.width = slideW * scale;
  canvas.height = slideH * scale;
  var ctx = canvas.getContext("2d");
  ctx.scale(scale, scale);
  ctx.fillStyle = "#ffffff";
  ctx.fillRect(0, 0, slideW, slideH);
  ctx.fillStyle = brandColour;
  ctx.fillRect(0, 0, slideW, 60);
  ctx.fillStyle = "#fff";
  ctx.font = "bold 22px -apple-system, sans-serif";
  ctx.fillText("Summary Metrics Overview", 30, 40);
  ctx.fillStyle = "#666";
  ctx.font = "13px -apple-system, sans-serif";
  ctx.fillText("See HTML report for full interactive table", 30, 90);
  canvas.toBlob(function(blob) {
    if (!blob) return;
    var a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "summary_metrics_slide.png";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  }, "image/png");
}
document.addEventListener("DOMContentLoaded", function() {
  hydratePinnedViews();
});
(function() {
  "use strict";
  var currentSegment = SEGMENTS[0] || "Total";
  var changeRowState = { "vs-prev": false, "vs-base": false };
  var originalRowOrder = [];
  var hiddenMetrics = {};
  window.getCurrentSegment = function() { return currentSegment; };
  window.selectMetric = function(metricId) {
    var items = document.querySelectorAll(".tk-sidebar-item");
    items.forEach(function(item) {
      item.classList.toggle("active", item.getAttribute("data-metric-id") === metricId);
    });
    var row = document.querySelector('.tk-metric-row[data-metric-id="' + metricId + '"]');
    if (row) {
      row.scrollIntoView({ behavior: "smooth", block: "center" });
      row.style.transition = "background 0.3s";
      row.style.background = "#fffde7";
      setTimeout(function() { row.style.background = ""; }, 1500);
    }
    var chart = document.querySelector('.tk-chart-container[data-metric-id="' + metricId + '"]');
    if (chart && document.getElementById("tk-chart-panel").style.display !== "none") {
      chart.scrollIntoView({ behavior: "smooth", block: "center" });
    }
  };
  window.filterMetrics = function(term) {
    var lower = term.toLowerCase();
    var items = document.querySelectorAll(".tk-sidebar-item");
    items.forEach(function(item) {
      var label = item.textContent.toLowerCase();
      item.classList.toggle("hidden", lower !== "" && label.indexOf(lower) === -1);
    });
  };
  window.switchSegment = function(segmentName) {
    currentSegment = segmentName;
    var dropdown = document.getElementById("segment-selector");
    if (dropdown && dropdown.value !== segmentName) {
      dropdown.value = segmentName;
    }
    document.querySelectorAll(".tk-seg-sidebar-item").forEach(function(item) {
      item.classList.toggle("active", item.getAttribute("data-segment") === segmentName);
    });
    document.querySelectorAll(".tk-sidebar-section").forEach(function(el) {
      el.classList.remove("active");
    });
    SEGMENTS.forEach(function(seg) {
      var cells = document.querySelectorAll('[data-segment="' + seg + '"]');
      cells.forEach(function(cell) {
        if (cell.classList.contains("tk-seg-sidebar-item")) return;
        if (cell.closest("#tab-overview") || cell.closest(".tk-table-panel")) {
          cell.classList.toggle("segment-hidden", seg !== segmentName);
        }
      });
    });
    var showingEl = document.getElementById("tk-segment-showing");
    if (showingEl) {
      showingEl.innerHTML = "Showing: <strong>" + segmentName + "</strong>";
    }
    updateSparklines(segmentName);
    if (typeof onOverviewSegmentChanged === "function") {
      onOverviewSegmentChanged();
    }
  };
  window.showBannerGroup = function(groupName, headerEl) {
    var segAttr = headerEl ? headerEl.getAttribute("data-group-segments") : "";
    if (!segAttr) return;
    var groupSegs = segAttr.split(",");
    currentSegment = groupName;
    document.querySelectorAll(".tk-seg-sidebar-item").forEach(function(item) {
      var seg = item.getAttribute("data-segment");
      item.classList.toggle("active", groupSegs.indexOf(seg) !== -1);
    });
    document.querySelectorAll(".tk-sidebar-section").forEach(function(el) {
      el.classList.remove("active");
    });
    if (headerEl) headerEl.classList.add("active");
    SEGMENTS.forEach(function(seg) {
      var show = groupSegs.indexOf(seg) !== -1;
      var cells = document.querySelectorAll('[data-segment="' + seg + '"]');
      cells.forEach(function(cell) {
        if (cell.classList.contains("tk-seg-sidebar-item")) return;
        if (cell.closest("#tab-overview") || cell.closest(".tk-table-panel")) {
          cell.classList.toggle("segment-hidden", !show);
        }
      });
    });
    var showingEl = document.getElementById("tk-segment-showing");
    if (showingEl) {
      showingEl.innerHTML = "Showing: <strong>" + groupName + "</strong> (" + groupSegs.length + " segments)";
    }
  };
  function updateSparklines(segmentName) {
  }
  window.toggleChangeRows = function(type) {
    changeRowState[type] = !changeRowState[type];
    var rows = document.querySelectorAll(".tk-" + type);
    rows.forEach(function(row) {
      row.classList.toggle("visible", changeRowState[type]);
    });
  };
  window.toggleSparklines = function() {
    document.body.classList.toggle("hide-sparklines");
  };
  window.switchView = function(view) {
    var tablePanel = document.querySelector(".tk-table-panel");
    var chartPanel = document.getElementById("tk-chart-panel");
    var btnTable = document.getElementById("btn-table-view");
    var btnChart = document.getElementById("btn-chart-view");
    if (view === "table") {
      tablePanel.style.display = "";
      chartPanel.style.display = "none";
      btnTable.classList.add("tk-btn-active");
      btnChart.classList.remove("tk-btn-active");
    } else {
      tablePanel.style.display = "none";
      chartPanel.style.display = "";
      btnTable.classList.remove("tk-btn-active");
      btnChart.classList.add("tk-btn-active");
    }
  };
  window.switchGroupBy = function(mode) {
    var tbody = document.querySelector("#tk-crosstab-table tbody");
    if (!tbody) return;
    var rows = Array.from(tbody.querySelectorAll("tr"));
    rows.forEach(function(r) {
      if (r.classList.contains("tk-section-row")) {
        r.parentNode.removeChild(r);
      }
    });
    var metricGroups = [];
    var dataRows = Array.from(tbody.querySelectorAll("tr"));
    var i = 0;
    while (i < dataRows.length) {
      var row = dataRows[i];
      if (row.classList.contains("tk-metric-row")) {
        var group = { metric: row, changes: [] };
        i++;
        while (i < dataRows.length && dataRows[i].classList.contains("tk-change-row")) {
          group.changes.push(dataRows[i]);
          i++;
        }
        metricGroups.push(group);
      } else {
        i++;
      }
    }
    if (mode === "section") {
      metricGroups.sort(function(a, b) {
        var sA = (a.metric.querySelector(".tk-metric-label") || {}).textContent || "";
        var sB = (b.metric.querySelector(".tk-metric-label") || {}).textContent || "";
        return sA.localeCompare(sB);
      });
      rebuildTableWithSections(tbody, metricGroups, function(row) {
        return row.getAttribute("data-section") || "(Ungrouped)";
      });
    } else if (mode === "metric_type") {
      rebuildTableWithSections(tbody, metricGroups, function(row) {
        var chartData = row.getAttribute("data-chart");
        if (chartData) {
          try {
            var d = JSON.parse(chartData);
            return formatMetricType(d.metric_name);
          } catch(e) { return "Other"; }
        }
        return "Other";
      });
    } else if (mode === "question") {
      rebuildTableWithSections(tbody, metricGroups, function(row) {
        return row.getAttribute("data-q-code") || "(Unknown)";
      });
    }
    var sortSelect = document.getElementById("sort-by-select");
    if (sortSelect) sortSelect.value = "original";
  };
  function rebuildTableWithSections(tbody, metricGroups, sectionFn) {
    var baseRow = tbody.querySelector(".tk-base-row");
    while (tbody.firstChild) {
      tbody.removeChild(tbody.firstChild);
    }
    var groups = {};
    metricGroups.forEach(function(g) {
      var section = sectionFn(g.metric);
      if (!groups[section]) groups[section] = [];
      groups[section].push(g);
    });
    var sectionKeys = Object.keys(groups).sort(function(a, b) {
      if (a === "(Ungrouped)") return 1;
      if (b === "(Ungrouped)") return -1;
      return a.localeCompare(b);
    });
    var totalCols = 1 + SEGMENTS.length * N_WAVES;
    sectionKeys.forEach(function(sec) {
      var secRow = document.createElement("tr");
      secRow.className = "tk-section-row";
      var secCell = document.createElement("td");
      secCell.className = "tk-section-cell";
      secCell.colSpan = totalCols;
      secCell.innerHTML = "<span class=\"section-chevron\">&#x25BC;</span> " + sec;
      secCell.setAttribute("onclick", "toggleOverviewSection(this)");
      secRow.appendChild(secCell);
      tbody.appendChild(secRow);
      groups[sec].forEach(function(g) {
        tbody.appendChild(g.metric);
        g.changes.forEach(function(cr) {
          tbody.appendChild(cr);
        });
      });
    });
    if (baseRow) tbody.insertBefore(baseRow, tbody.firstChild);
  }
  function formatMetricType(name) {
    var labels = {
      "mean": "Means & Averages",
      "nps_score": "NPS Scores",
      "nps": "NPS Scores",
      "top_box": "Box Categories",
      "top2_box": "Box Categories",
      "top3_box": "Box Categories",
      "bottom_box": "Box Categories",
      "bottom2_box": "Box Categories",
      "promoters_pct": "NPS Components",
      "passives_pct": "NPS Components",
      "detractors_pct": "NPS Components"
    };
    return labels[name] || "Other Metrics";
  }
  var overviewSortState = { col: -1, dir: "desc" };
  window.sortOverviewColumn = function(headerEl) {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var colIndex = parseInt(headerEl.getAttribute("data-col-index"), 10);
    if (isNaN(colIndex)) return;
    var dir = "desc";
    if (overviewSortState.col === colIndex && overviewSortState.dir === "desc") {
      dir = "asc";
    }
    overviewSortState = { col: colIndex, dir: dir };
    table.querySelectorAll(".tk-sortable").forEach(function(th) {
      th.classList.remove("sort-asc", "sort-desc");
    });
    headerEl.classList.add(dir === "asc" ? "sort-asc" : "sort-desc");
    var tbody = table.querySelector("tbody");
    var rows = Array.from(tbody.querySelectorAll("tr"));
    var groups = [];
    var baseRow = null;
    var i = 0;
    while (i < rows.length) {
      var row = rows[i];
      if (row.classList.contains("tk-base-row")) {
        baseRow = row;
        i++;
      } else if (row.classList.contains("tk-section-row")) {
        i++;
      } else if (row.classList.contains("tk-metric-row")) {
        var group = { metric: row, changes: [], sortVal: 0 };
        var cells = row.querySelectorAll("td");
        if (colIndex < cells.length) {
          group.sortVal = parseFloat(cells[colIndex].getAttribute("data-sort-val")) || 0;
        }
        i++;
        while (i < rows.length && rows[i].classList.contains("tk-change-row")) {
          group.changes.push(rows[i]);
          i++;
        }
        groups.push(group);
      } else {
        i++;
      }
    }
    groups.sort(function(a, b) {
      return dir === "desc" ? b.sortVal - a.sortVal : a.sortVal - b.sortVal;
    });
    while (tbody.firstChild) tbody.removeChild(tbody.firstChild);
    groups.forEach(function(g) {
      tbody.appendChild(g.metric);
      g.changes.forEach(function(cr) { tbody.appendChild(cr); });
    });
    if (baseRow) tbody.insertBefore(baseRow, tbody.firstChild);
    var sortSelect = document.getElementById("sort-by-select");
    if (sortSelect) sortSelect.value = "original";
  };
  var overviewTypeFilter = "all";
  window.filterOverviewByType = function(typeKey) {
    overviewTypeFilter = typeKey;
    document.querySelectorAll(".tk-overview-type-chip").forEach(function(chip) {
      chip.classList.toggle("active", chip.getAttribute("data-type-filter") === typeKey);
    });
    applyOverviewFilters();
  };
  var overviewSearchQuery = "";
  window.filterOverviewRows = function(query) {
    overviewSearchQuery = (query || "").toLowerCase();
    applyOverviewFilters();
  };
  function applyOverviewFilters() {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var rows = table.querySelectorAll("tbody tr.tk-metric-row");
    rows.forEach(function(row) {
      var typeAttr = row.getAttribute("data-metric-type") || "other";
      var label = (row.querySelector(".tk-metric-label") || {}).textContent || "";
      var typeMatch = overviewTypeFilter === "all" || typeAttr === overviewTypeFilter;
      var textMatch = overviewSearchQuery === "" || label.toLowerCase().indexOf(overviewSearchQuery) >= 0;
      var visible = typeMatch && textMatch;
      row.classList.toggle("row-filtered", !visible);
      var metricId = row.getAttribute("data-metric-id");
      if (metricId) {
        table.querySelectorAll('.tk-change-row[data-metric-id="' + metricId + '"]').forEach(function(cr) {
          cr.classList.toggle("row-filtered", !visible);
        });
      }
    });
    table.querySelectorAll("tbody tr.tk-section-row").forEach(function(secRow) {
      var next = secRow.nextElementSibling;
      var hasVisible = false;
      while (next && !next.classList.contains("tk-section-row")) {
        if (next.classList.contains("tk-metric-row") && !next.classList.contains("row-filtered")) {
          hasVisible = true;
          break;
        }
        next = next.nextElementSibling;
      }
      secRow.style.display = hasVisible ? "" : "none";
    });
  }
  window.sortOverviewBy = function(mode) {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var tbody = table.querySelector("tbody");
    if (!tbody) return;
    table.querySelectorAll(".tk-sortable").forEach(function(th) {
      th.classList.remove("sort-asc", "sort-desc");
    });
    overviewSortState = { col: -1, dir: "desc" };
    if (mode === "original") {
      restoreOriginalOrder(tbody);
      return;
    }
    var rows = Array.from(tbody.querySelectorAll("tr"));
    var sectionRows = [];
    var metricGroups = [];
    var baseRow = null;
    var i = 0;
    while (i < rows.length) {
      var row = rows[i];
      if (row.classList.contains("tk-base-row")) {
        baseRow = row;
        i++;
      } else if (row.classList.contains("tk-section-row")) {
        i++;
      } else if (row.classList.contains("tk-metric-row")) {
        var label = (row.querySelector(".tk-metric-label") || {}).textContent || "";
        var group = { metric: row, changes: [], label: label };
        i++;
        while (i < rows.length && rows[i].classList.contains("tk-change-row")) {
          group.changes.push(rows[i]);
          i++;
        }
        metricGroups.push(group);
      } else {
        i++;
      }
    }
    var descending = mode === "metric_name_desc";
    metricGroups.sort(function(a, b) {
      var cmp = a.label.localeCompare(b.label);
      return descending ? -cmp : cmp;
    });
    while (tbody.firstChild) tbody.removeChild(tbody.firstChild);
    metricGroups.forEach(function(g) {
      tbody.appendChild(g.metric);
      g.changes.forEach(function(cr) { tbody.appendChild(cr); });
    });
    if (baseRow) tbody.insertBefore(baseRow, tbody.firstChild);
  };
  function restoreOriginalOrder(tbody) {
    if (originalRowOrder.length === 0) return;
    var baseRow = tbody.querySelector(".tk-base-row");
    while (tbody.firstChild) tbody.removeChild(tbody.firstChild);
    for (var i = 0; i < originalRowOrder.length; i++) {
      tbody.appendChild(originalRowOrder[i]);
    }
    if (baseRow) tbody.insertBefore(baseRow, tbody.firstChild);
  }
  window.toggleRowVisibility = function(metricId) {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var isHidden = !hiddenMetrics[metricId];
    hiddenMetrics[metricId] = isHidden;
    var metricRow = table.querySelector('.tk-metric-row[data-metric-id="' + metricId + '"]');
    if (metricRow) {
      metricRow.classList.toggle("row-hidden-user", isHidden);
      var btn = metricRow.querySelector(".tk-row-hide-btn");
      if (btn) btn.classList.toggle("row-greyed", isHidden);
    }
    table.querySelectorAll('.tk-change-row[data-metric-id="' + metricId + '"]').forEach(function(cr) {
      cr.classList.toggle("row-hidden-user", isHidden);
    });
    updateHiddenRowsIndicator();
  };
  window.showAllHiddenRows = function() {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    table.querySelectorAll(".row-hidden-user").forEach(function(el) {
      el.classList.remove("row-hidden-user");
    });
    table.querySelectorAll(".tk-row-hide-btn.row-greyed").forEach(function(btn) {
      btn.classList.remove("row-greyed");
    });
    hiddenMetrics = {};
    updateHiddenRowsIndicator();
  };
  function updateHiddenRowsIndicator() {
    var count = Object.keys(hiddenMetrics).filter(function(k) { return hiddenMetrics[k]; }).length;
    var indicator = document.getElementById("hidden-rows-indicator");
    var countEl = document.getElementById("hidden-rows-count");
    if (indicator) indicator.style.display = count > 0 ? "flex" : "none";
    if (countEl) countEl.textContent = count + " greyed out";
  }
  window.toggleOverviewSection = function(sectionCell) {
    var sectionRow = sectionCell.closest("tr");
    if (!sectionRow) return;
    var isCollapsed = sectionRow.classList.toggle("section-collapsed");
    var next = sectionRow.nextElementSibling;
    while (next && !next.classList.contains("tk-section-row")) {
      if (isCollapsed) {
        next.classList.add("section-hidden");
      } else {
        next.classList.remove("section-hidden");
      }
      next = next.nextElementSibling;
    }
  };
  window.toggleOverviewInsight = function() {
    var area = document.querySelector("#tab-overview .insight-area");
    if (!area) return;
    var toggleBtn = area.querySelector(".insight-toggle");
    var container = area.querySelector(".insight-container");
    if (container.style.display === "none" || container.style.display === "") {
      container.style.display = "block";
      if (toggleBtn) toggleBtn.style.display = "none";
      var editor = container.querySelector(".insight-editor");
      if (editor) editor.focus();
    } else {
      container.style.display = "none";
      if (toggleBtn) toggleBtn.style.display = "";
    }
  };
  window.dismissOverviewInsight = function() {
    var area = document.querySelector("#tab-overview .insight-area");
    if (!area) return;
    var editor = area.querySelector(".insight-editor");
    var container = area.querySelector(".insight-container");
    var toggleBtn = area.querySelector(".insight-toggle");
    if (editor) editor.innerHTML = "";
    if (container) container.style.display = "none";
    if (toggleBtn) toggleBtn.style.display = "";
  };
  window.pinOverviewView = function() {
    var tablePanel = document.querySelector("#tab-overview .tk-table-panel");
    var chartPanel = document.getElementById("tk-chart-panel");
    var insightEditor = document.getElementById("overview-insight-editor");
    var cleanHtml = "";
    if (tablePanel && tablePanel.style.display !== "none") {
      var clone = tablePanel.cloneNode(true);
      clone.querySelectorAll(".segment-hidden").forEach(function(el) { el.parentNode.removeChild(el); });
      clone.querySelectorAll(".row-hidden-user").forEach(function(el) { el.parentNode.removeChild(el); });
      clone.querySelectorAll(".row-filtered").forEach(function(el) { el.parentNode.removeChild(el); });
      clone.querySelectorAll(".section-hidden").forEach(function(el) { el.parentNode.removeChild(el); });
      clone.querySelectorAll(".tk-change-row").forEach(function(el) {
        if (!el.classList.contains("visible")) el.parentNode.removeChild(el);
      });
      clone.querySelectorAll(".tk-section-row.section-collapsed").forEach(function(el) {
        el.parentNode.removeChild(el);
      });
      clone.querySelectorAll(".tk-row-hide-btn, .tk-add-chart-btn, .tk-sortable").forEach(function(el) {
        el.removeAttribute("onclick");
      });
      cleanHtml = clone.innerHTML;
    }
    var chartSvg = "";
    var chartVisible = false;
    if (chartPanel && chartPanel.style.display !== "none") {
      chartVisible = true;
      chartSvg = chartPanel.innerHTML;
    }
    var pinObj = {
      id: "pin-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5),
      metricId: "overview-" + currentSegment,
      metricTitle: "Segment Overview: " + currentSegment,
      visibleSegments: [currentSegment],
      tableHtml: cleanHtml,
      chartSvg: chartSvg,
      chartVisible: chartVisible,
      insightText: insightEditor ? insightEditor.innerHTML : "",
      timestamp: Date.now(),
      order: pinnedViews.length
    };
    pinnedViews.push(pinObj);
    if (typeof renderPinnedCards === "function") renderPinnedCards();
    if (typeof updatePinBadge === "function") updatePinBadge();
    if (typeof savePinnedData === "function") savePinnedData();
    captureOverviewPng(pinObj);
  };
  window.captureOverviewPng = function(pinObj) {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var brandColour = getComputedStyle(document.documentElement).getPropertyValue("--brand").trim() || "#323367";
    var headers = [];
    var headerRow = table.querySelector("thead tr.tk-wave-header-row");
    if (headerRow) {
      headerRow.querySelectorAll("th").forEach(function(th) {
        if (th.classList.contains("segment-hidden")) return;
        headers.push(th.textContent.trim());
      });
    }
    var dataRows = [];
    table.querySelectorAll("tbody tr").forEach(function(tr) {
      if (tr.classList.contains("section-hidden")) return;
      if (tr.classList.contains("row-hidden-user")) return;
      if (tr.classList.contains("row-filtered")) return;
      if (tr.style.display === "none") return;
      if (tr.classList.contains("tk-change-row") && !tr.classList.contains("visible")) return;
      var cells = [];
      var rowType = "data";
      if (tr.classList.contains("tk-section-row")) rowType = "section";
      else if (tr.classList.contains("tk-base-row")) rowType = "base";
      else if (tr.classList.contains("tk-change-row")) rowType = "change";
      tr.querySelectorAll("td, th").forEach(function(cell) {
        if (cell.classList.contains("segment-hidden")) return;
        var label = cell.querySelector(".tk-metric-label");
        cells.push(label ? label.textContent.trim() : cell.textContent.trim());
      });
      if (cells.length > 0) {
        dataRows.push({ cells: cells, type: rowType });
      }
    });
    if (dataRows.length === 0) return;
    var nCols = headers.length || 4;
    var slideW = Math.max(1280, nCols * 120 + 300);
    var rowH = 24;
    var headerH = 36;
    var titleBarH = 60;
    var pad = 30;
    var slideH = Math.max(720, titleBarH + pad + headerH + dataRows.length * rowH + pad * 2);
    var scale = 3;
    var canvas = document.createElement("canvas");
    canvas.width = slideW * scale;
    canvas.height = slideH * scale;
    var ctx = canvas.getContext("2d");
    ctx.scale(scale, scale);
    ctx.fillStyle = "#ffffff";
    ctx.fillRect(0, 0, slideW, slideH);
    ctx.fillStyle = brandColour;
    ctx.fillRect(0, 0, slideW, titleBarH);
    ctx.fillStyle = "#ffffff";
    ctx.font = "bold 22px -apple-system, sans-serif";
    ctx.fillText(pinObj.metricTitle, pad, 40);
    ctx.font = "14px -apple-system, sans-serif";
    ctx.fillStyle = "rgba(255,255,255,0.8)";
    ctx.fillText("Tracking Report", slideW - 200, 40);
    var tableX = pad;
    var tableY = titleBarH + pad;
    var labelColW = Math.min(400, slideW * 0.35);
    var dataColW = (slideW - pad * 2 - labelColW) / Math.max(1, nCols - 1);
    ctx.fillStyle = "#f0f0f5";
    ctx.fillRect(tableX, tableY, slideW - pad * 2, headerH);
    ctx.fillStyle = "#555";
    ctx.font = "bold 12px -apple-system, sans-serif";
    ctx.textAlign = "left";
    if (headers.length > 0) ctx.fillText(headers[0], tableX + 10, tableY + 22);
    ctx.textAlign = "center";
    for (var hi = 1; hi < headers.length; hi++) {
      var hx = tableX + labelColW + (hi - 1) * dataColW + dataColW / 2;
      ctx.fillText(headers[hi], hx, tableY + 22);
    }
    var curY = tableY + headerH;
    for (var ri = 0; ri < dataRows.length; ri++) {
      var row = dataRows[ri];
      if (row.type === "section") {
        ctx.fillStyle = "#f4f5f7";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = brandColour;
        ctx.font = "bold 11px -apple-system, sans-serif";
        ctx.textAlign = "left";
        ctx.fillText(row.cells[0] || "", tableX + 10, curY + 16);
        curY += rowH;
        continue;
      }
      if (row.type === "base") {
        ctx.fillStyle = "#fafbfc";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = "#888";
        ctx.font = "11px -apple-system, sans-serif";
      } else if (row.type === "change") {
        ctx.fillStyle = "#fafafa";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = "#888";
        ctx.font = "11px -apple-system, sans-serif";
      } else {
        ctx.fillStyle = ri % 2 === 0 ? "#ffffff" : "#fafbfc";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = "#1e293b";
        ctx.font = "12px -apple-system, sans-serif";
      }
      ctx.strokeStyle = "#eee";
      ctx.lineWidth = 0.5;
      ctx.beginPath();
      ctx.moveTo(tableX, curY + rowH);
      ctx.lineTo(tableX + slideW - pad * 2, curY + rowH);
      ctx.stroke();
      ctx.textAlign = "left";
      if (row.cells.length > 0) {
        var labelText = row.cells[0];
        if (labelText.length > 50) labelText = labelText.substring(0, 48) + "...";
        ctx.fillText(labelText, tableX + 10, curY + 16);
      }
      ctx.textAlign = "center";
      for (var ci = 1; ci < row.cells.length; ci++) {
        var cx = tableX + labelColW + (ci - 1) * dataColW + dataColW / 2;
        ctx.fillText(row.cells[ci] || "", cx, curY + 16);
      }
      curY += rowH;
    }
    ctx.strokeStyle = "#ddd";
    ctx.lineWidth = 1;
    ctx.strokeRect(tableX, tableY, slideW - pad * 2, curY - tableY);
    try {
      pinObj.pngDataUrl = canvas.toDataURL("image/png");
      if (typeof renderPinnedCards === "function") renderPinnedCards();
      if (typeof savePinnedData === "function") savePinnedData();
    } catch (e) {
    }
  }
  window.exportOverviewSlide = function() {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var brandColour = getComputedStyle(document.documentElement).getPropertyValue("--brand").trim() || "#323367";
    var headers = [];
    var headerRow = table.querySelector("thead tr.tk-wave-header-row");
    if (headerRow) {
      headerRow.querySelectorAll("th").forEach(function(th) {
        if (th.classList.contains("segment-hidden")) return;
        headers.push(th.textContent.trim());
      });
    }
    var dataRows = [];
    table.querySelectorAll("tbody tr").forEach(function(tr) {
      if (tr.classList.contains("section-hidden")) return;
      if (tr.classList.contains("row-hidden-user")) return;
      if (tr.classList.contains("row-filtered")) return;
      if (tr.style.display === "none") return;
      if (tr.classList.contains("tk-change-row") && !tr.classList.contains("visible")) return;
      var cells = [];
      var rowType = "data";
      if (tr.classList.contains("tk-section-row")) rowType = "section";
      else if (tr.classList.contains("tk-base-row")) rowType = "base";
      else if (tr.classList.contains("tk-change-row")) rowType = "change";
      tr.querySelectorAll("td, th").forEach(function(cell) {
        if (cell.classList.contains("segment-hidden")) return;
        var label = cell.querySelector(".tk-metric-label");
        cells.push(label ? label.textContent.trim() : cell.textContent.trim());
      });
      if (cells.length > 0) {
        dataRows.push({ cells: cells, type: rowType });
      }
    });
    var nCols = headers.length || 4;
    var slideW = Math.max(1280, nCols * 120 + 300);
    var rowH = 24;
    var headerH = 36;
    var titleBarH = 60;
    var pad = 30;
    var slideH = Math.max(720, titleBarH + pad + headerH + dataRows.length * rowH + pad * 2);
    var scale = 3;
    var canvas = document.createElement("canvas");
    canvas.width = slideW * scale;
    canvas.height = slideH * scale;
    var ctx = canvas.getContext("2d");
    ctx.scale(scale, scale);
    ctx.fillStyle = "#ffffff";
    ctx.fillRect(0, 0, slideW, slideH);
    ctx.fillStyle = brandColour;
    ctx.fillRect(0, 0, slideW, titleBarH);
    ctx.fillStyle = "#ffffff";
    ctx.font = "bold 22px -apple-system, sans-serif";
    ctx.fillText("Segment Overview: " + currentSegment, pad, 40);
    ctx.font = "14px -apple-system, sans-serif";
    ctx.fillStyle = "rgba(255,255,255,0.8)";
    ctx.fillText("Tracking Report", slideW - 200, 40);
    var tableX = pad;
    var tableY = titleBarH + pad;
    var labelColW = Math.min(400, slideW * 0.35);
    var dataColW = (slideW - pad * 2 - labelColW) / Math.max(1, nCols - 1);
    ctx.fillStyle = "#f0f0f5";
    ctx.fillRect(tableX, tableY, slideW - pad * 2, headerH);
    ctx.fillStyle = "#555";
    ctx.font = "bold 12px -apple-system, sans-serif";
    ctx.textAlign = "left";
    if (headers.length > 0) ctx.fillText(headers[0], tableX + 10, tableY + 22);
    ctx.textAlign = "center";
    for (var hi = 1; hi < headers.length; hi++) {
      var hx = tableX + labelColW + (hi - 1) * dataColW + dataColW / 2;
      ctx.fillText(headers[hi], hx, tableY + 22);
    }
    var curY = tableY + headerH;
    for (var ri = 0; ri < dataRows.length; ri++) {
      var row = dataRows[ri];
      if (row.type === "section") {
        ctx.fillStyle = "#f4f5f7";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = brandColour;
        ctx.font = "bold 11px -apple-system, sans-serif";
        ctx.textAlign = "left";
        ctx.fillText(row.cells[0] || "", tableX + 10, curY + 16);
        curY += rowH;
        continue;
      }
      if (row.type === "base") {
        ctx.fillStyle = "#fafbfc";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = "#888";
        ctx.font = "11px -apple-system, sans-serif";
      } else if (row.type === "change") {
        ctx.fillStyle = "#fafafa";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = "#888";
        ctx.font = "11px -apple-system, sans-serif";
      } else {
        ctx.fillStyle = ri % 2 === 0 ? "#ffffff" : "#fafbfc";
        ctx.fillRect(tableX, curY, slideW - pad * 2, rowH);
        ctx.fillStyle = "#1e293b";
        ctx.font = "12px -apple-system, sans-serif";
      }
      ctx.strokeStyle = "#eee";
      ctx.lineWidth = 0.5;
      ctx.beginPath();
      ctx.moveTo(tableX, curY + rowH);
      ctx.lineTo(tableX + slideW - pad * 2, curY + rowH);
      ctx.stroke();
      ctx.textAlign = "left";
      if (row.cells.length > 0) {
        var labelText = row.cells[0];
        if (labelText.length > 50) labelText = labelText.substring(0, 48) + "...";
        ctx.fillText(labelText, tableX + 10, curY + 16);
      }
      ctx.textAlign = "center";
      for (var ci = 1; ci < row.cells.length; ci++) {
        var cx = tableX + labelColW + (ci - 1) * dataColW + dataColW / 2;
        ctx.fillText(row.cells[ci] || "", cx, curY + 16);
      }
      curY += rowH;
    }
    ctx.strokeStyle = "#ddd";
    ctx.lineWidth = 1;
    ctx.strokeRect(tableX, tableY, slideW - pad * 2, curY - tableY);
    canvas.toBlob(function(blob) {
      if (!blob) return;
      var a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "overview_" + currentSegment + ".png";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);
    }, "image/png");
  };
  window.toggleHelpOverlay = function() {
    var overlay = document.getElementById("tk-help-overlay");
    if (overlay) {
      overlay.style.display = overlay.style.display === "none" ? "flex" : "none";
    }
  };
  window.filterSummaryByType = function(typeKey) {
    document.querySelectorAll(".summary-type-chip").forEach(function(chip) {
      chip.classList.toggle("active", chip.getAttribute("data-type-filter") === typeKey);
    });
    var table = document.getElementById("summary-metrics-table");
    if (!table) return;
    var rows = table.querySelectorAll("tbody tr.tk-metric-row");
    rows.forEach(function(row) {
      var rowType = row.getAttribute("data-metric-type") || "other";
      var visible = typeKey === "all" || rowType === typeKey;
      row.style.display = visible ? "" : "none";
    });
    table.querySelectorAll("tbody tr.tk-section-row").forEach(function(secRow) {
      var next = secRow.nextElementSibling;
      var hasVisible = false;
      while (next && !next.classList.contains("tk-section-row")) {
        if (next.classList.contains("tk-metric-row") && next.style.display !== "none") {
          hasVisible = true;
          break;
        }
        next = next.nextElementSibling;
      }
      secRow.style.display = hasVisible ? "" : "none";
    });
  };
  document.addEventListener("DOMContentLoaded", function() {
    var tbody = document.querySelector("#tk-crosstab-table tbody");
    if (tbody) {
      var rows = tbody.querySelectorAll("tr:not(.tk-base-row)");
      originalRowOrder = Array.from(rows);
    }
    if (SEGMENTS.length <= 1) {
      var selector = document.querySelector(".tk-segment-selector");
      if (selector) selector.style.display = "none";
    }
    if (SEGMENTS.length > 0) {
      window.switchSegment(SEGMENTS[0]);
    }
  });
})();
(function() {
  "use strict";
  var chartSelection = {};
  var CHART_COLOURS = [
    "#323367", "#CC9900", "#2E8B57", "#CD5C5C", "#4682B4",
    "#9370DB", "#D2691E", "#20B2AA", "#8B4513", "#6A5ACD",
    "#DC143C", "#008080", "#FF6347", "#4169E1", "#32CD32"
  ];
  window.addToChart = function(metricId) {
    if (chartSelection[metricId]) {
      removeFromChart(metricId);
      return;
    }
    chartSelection[metricId] = true;
    var chartPanel = document.getElementById("tk-chart-panel");
    if (chartPanel) chartPanel.style.display = "";
    var btn = document.querySelector('.tk-add-chart-btn[data-metric-id="' + metricId + '"]');
    if (btn) btn.classList.add("in-chart");
    rebuildCombinedChart();
  };
  window.removeFromChart = function(metricId) {
    delete chartSelection[metricId];
    var btn = document.querySelector('.tk-add-chart-btn[data-metric-id="' + metricId + '"]');
    if (btn) btn.classList.remove("in-chart");
    var count = Object.keys(chartSelection).length;
    if (count === 0) {
      var chartPanel = document.getElementById("tk-chart-panel");
      if (chartPanel) chartPanel.style.display = "none";
    }
    rebuildCombinedChart();
  };
  window.getChartSelection = function() {
    return Object.keys(chartSelection).filter(function(k) { return chartSelection[k]; });
  };
  function rebuildCombinedChart() {
    var selected = getChartSelection();
    var countEl = document.getElementById("tk-chart-count");
    if (countEl) {
      countEl.textContent = "Charts (" + selected.length + " selected)";
    }
    var chartContainer = document.getElementById("tk-combined-chart");
    if (!chartContainer) return;
    if (selected.length === 0) {
      chartContainer.innerHTML = '<p style="color:#888;text-align:center;padding:40px;">Select metrics from the table to add them to the chart.</p>';
      return;
    }
    var segmentName = (typeof getCurrentSegment === "function") ? getCurrentSegment() : "Total";
    var seriesData = [];
    var allWaveLabels = null;
    var allWaveIds = null;
    var isPct = false;
    var isNPS = false;
    for (var i = 0; i < selected.length; i++) {
      var metricId = selected[i];
      var row = document.querySelector('.tk-metric-row[data-metric-id="' + metricId + '"]');
      if (!row) continue;
      var chartAttr = row.getAttribute("data-chart");
      if (!chartAttr) continue;
      try {
        var chartData = JSON.parse(chartAttr);
      } catch (e) { continue; }
      if (!chartData || !chartData.series) continue;
      if (!allWaveLabels && chartData.wave_labels) {
        allWaveLabels = chartData.wave_labels;
        allWaveIds = chartData.wave_ids;
      }
      var segSeries = chartData.series[segmentName] || null;
      if (!segSeries) continue;
      var labelEl = row.querySelector(".tk-metric-label");
      var label = labelEl ? labelEl.textContent : metricId;
      if (chartData.is_percentage) isPct = true;
      if (chartData.is_nps) isNPS = true;
      seriesData.push({
        name: label,
        values: segSeries.values,
        metricId: metricId,
        isPct: chartData.is_percentage || false,
        isNPS: chartData.is_nps || false
      });
    }
    if (seriesData.length === 0 || !allWaveLabels) {
      chartContainer.innerHTML = '<p style="color:#888;text-align:center;padding:40px;">No data available for segment: ' + segmentName + '</p>';
      return;
    }
    var svg = buildCombinedSVG(seriesData, allWaveLabels, allWaveIds, segmentName, isPct, isNPS);
    chartContainer.innerHTML = svg;
  }
  function buildCombinedSVG(seriesData, waveLabels, waveIds, segmentName, isPct, isNPS) {
    var nWaves = waveLabels.length;
    if (nWaves < 2) return "";
    var width = 960;
    var legendRowH = 30 + Math.ceil(seriesData.length / 3) * 20;
    var height = 380 + legendRowH;
    var margin = { top: 30, right: 20, bottom: 80, left: 60 };
    var plotW = width - margin.left - margin.right;
    var plotH = height - margin.top - margin.bottom - legendRowH;
    var allVals = [];
    seriesData.forEach(function(s) {
      s.values.forEach(function(v) { if (v !== null && !isNaN(v)) allVals.push(v); });
    });
    if (allVals.length === 0) return "";
    var yMin, yMax;
    if (isPct) {
      yMin = 0; yMax = 100;
    } else if (isNPS) {
      yMin = -100; yMax = 100;
    } else {
      var dataMin = Math.min.apply(null, allVals);
      var dataMax = Math.max.apply(null, allVals);
      if (dataMax <= 5.5) { yMin = 0; yMax = 5; }
      else if (dataMax <= 10.5) { yMin = 0; yMax = 10; }
      else {
        var range = dataMax - dataMin || 1;
        yMin = Math.max(0, dataMin - range * 0.15);
        yMax = dataMax + range * 0.15;
      }
    }
    var yRange = yMax - yMin || 1;
    function scaleY(v) { return (v - yMin) / yRange * plotH; }
    function formatVal(v) {
      if (isPct) return Math.round(v) + "%";
      if (isNPS) return (v >= 0 ? "+" : "") + v.toFixed(1);
      return v.toFixed(2);
    }
    var parts = [];
    parts.push('<svg class="tk-line-chart" width="' + width + '" height="' + height + '" viewBox="0 0 ' + width + ' ' + height + '" xmlns="http://www.w3.org/2000/svg">');
    parts.push('<rect width="' + width + '" height="' + height + '" fill="#ffffff" rx="6"/>');
    parts.push('<g transform="translate(' + margin.left + ',' + margin.top + ')">');
    parts.push('<text x="' + (plotW / 2) + '" y="-10" text-anchor="middle" fill="#1e293b" font-size="14" font-weight="700">Segment: ' + segmentName + '</text>');
    for (var gi = 0; gi <= 4; gi++) {
      var gv = yMin + (yMax - yMin) * gi / 4;
      var gy = plotH - scaleY(gv);
      parts.push('<line x1="0" y1="' + gy.toFixed(1) + '" x2="' + plotW + '" y2="' + gy.toFixed(1) + '" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="4,4"/>');
      parts.push('<text x="-10" y="' + gy.toFixed(1) + '" text-anchor="end" fill="#666" font-size="12" dy="0.35em">' + formatVal(gv) + '</text>');
    }
    for (var xi = 0; xi < nWaves; xi++) {
      var xPos = xi / (nWaves - 1) * plotW;
      parts.push('<text x="' + xPos.toFixed(1) + '" y="' + (plotH + 24) + '" text-anchor="middle" fill="#666" font-size="13" font-weight="600">' + waveLabels[xi] + '</text>');
      parts.push('<line x1="' + xPos.toFixed(1) + '" y1="' + plotH + '" x2="' + xPos.toFixed(1) + '" y2="' + (plotH + 5) + '" stroke="#ccc" stroke-width="1"/>');
    }
    var allLabelsByWave = [];
    for (var wi = 0; wi < nWaves; wi++) allLabelsByWave.push([]);
    seriesData.forEach(function(series, sIdx) {
      var colour = CHART_COLOURS[sIdx % CHART_COLOURS.length];
      var points = [];
      for (var wi = 0; wi < nWaves; wi++) {
        var val = series.values[wi];
        if (val === null || isNaN(val)) continue;
        var px = wi / (nWaves - 1) * plotW;
        var py = plotH - scaleY(val);
        points.push({ x: px, y: py, val: val, wi: wi });
      }
      if (points.length >= 2) {
        var pathD = buildSmoothPath(points.map(function(p) { return { x: p.x, y: p.y }; }));
        parts.push('<path d="' + pathD + '" fill="none" stroke="' + colour + '" stroke-width="3" stroke-linejoin="round" stroke-linecap="round"/>');
      }
      points.forEach(function(p) {
        parts.push('<circle cx="' + p.x.toFixed(1) + '" cy="' + p.y.toFixed(1) + '" r="5" fill="' + colour + '" stroke="#fff" stroke-width="2.5"/>');
        allLabelsByWave[p.wi].push({
          x: p.x, y: p.y - 14, text: formatVal(p.val), colour: colour
        });
      });
    });
    var minGap = 14;
    allLabelsByWave.forEach(function(labels) {
      if (labels.length === 0) return;
      labels.sort(function(a, b) { return a.y - b.y; });
      for (var j = 1; j < labels.length; j++) {
        if (labels[j].y - labels[j - 1].y < minGap) {
          labels[j].y = labels[j - 1].y + minGap;
        }
      }
      if (labels.length > 0 && labels[labels.length - 1].y > plotH - 4) {
        var needed = (labels.length - 1) * minGap;
        var startY = Math.max(4, Math.min(labels[0].y, plotH - 4 - needed));
        for (var j = 0; j < labels.length; j++) {
          labels[j].y = Math.max(4, Math.min(startY + j * minGap, plotH - 4));
        }
      }
      labels.forEach(function(lb) {
        parts.push('<text x="' + lb.x.toFixed(1) + '" y="' + lb.y.toFixed(1) + '" text-anchor="middle" fill="' + lb.colour + '" font-size="11" font-weight="700">' + lb.text + '</text>');
      });
    });
    parts.push('</g>');
    var legendY = height - legendRowH + 8;
    var lx = margin.left;
    seriesData.forEach(function(series, sIdx) {
      var colour = CHART_COLOURS[sIdx % CHART_COLOURS.length];
      var itemW = 16 + 6 + series.name.length * 6.5 + 24;
      if (lx + itemW > width - 20) {
        lx = margin.left;
        legendY += 20;
      }
      parts.push('<rect x="' + lx + '" y="' + (legendY + 4) + '" width="16" height="4" rx="2" fill="' + colour + '"/>');
      parts.push('<text x="' + (lx + 22) + '" y="' + (legendY + 5) + '" fill="#555" font-size="11" font-weight="600" dy="0.35em">' + series.name + '</text>');
      lx += itemW;
    });
    parts.push('</svg>');
    return parts.join("\n");
  }
  function buildSmoothPath(pts) {
    if (typeof smoothPathFromPoints === "function") {
      return smoothPathFromPoints(pts);
    }
    if (pts.length < 2) return "";
    var d = "M" + pts[0].x.toFixed(1) + "," + pts[0].y.toFixed(1);
    for (var i = 1; i < pts.length; i++) {
      d += " L" + pts[i].x.toFixed(1) + "," + pts[i].y.toFixed(1);
    }
    return d;
  }
  window.exportChartPNG = function(metricId) {
    var container;
    if (metricId === "combined") {
      container = document.getElementById("tk-combined-chart");
    } else {
      container = document.querySelector('.tk-chart-container[data-metric-id="' + metricId + '"]');
    }
    if (!container) return;
    var svg = container.querySelector(".tk-line-chart");
    if (!svg) return;
    var svgData = new XMLSerializer().serializeToString(svg);
    var svgBlob = new Blob([svgData], { type: "image/svg+xml;charset=utf-8" });
    var svgUrl = URL.createObjectURL(svgBlob);
    var canvas = document.createElement("canvas");
    var ctx = canvas.getContext("2d");
    var img = new Image();
    img.onload = function() {
      var scale = 3;
      canvas.width = img.width * scale;
      canvas.height = img.height * scale;
      ctx.scale(scale, scale);
      ctx.fillStyle = "#ffffff";
      ctx.fillRect(0, 0, img.width, img.height);
      ctx.drawImage(img, 0, 0);
      canvas.toBlob(function(blob) {
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url;
        a.download = "chart_overview.png";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        URL.revokeObjectURL(svgUrl);
      }, "image/png");
    };
    img.src = svgUrl;
  };
  window.exportSelectedChartsSlide = function() {
    var selected = getChartSelection();
    if (selected.length === 0) return;
    exportChartPNG("combined");
  };
  window.pinSelectedCharts = function() {
    var selected = getChartSelection();
    if (selected.length === 0) return;
    var chartContainer = document.getElementById("tk-combined-chart");
    var chartSvg = chartContainer ? chartContainer.innerHTML : "";
    var insightEditor = document.getElementById("overview-insight-editor");
    var insightText = insightEditor ? insightEditor.innerHTML : "";
    var pinObj = {
      id: "pin-" + Date.now() + "-" + Math.random().toString(36).substr(2, 5),
      metricId: "overview-charts-" + selected.join("-"),
      metricTitle: "Overview: " + selected.length + " metrics (" + ((typeof getCurrentSegment === "function") ? getCurrentSegment() : "Total") + ")",
      visibleSegments: [(typeof getCurrentSegment === "function") ? getCurrentSegment() : "Total"],
      tableHtml: "",
      chartSvg: chartSvg,
      chartVisible: true,
      insightText: insightText,
      timestamp: Date.now(),
      order: typeof pinnedViews !== "undefined" ? pinnedViews.length : 0
    };
    if (typeof pinnedViews !== "undefined") {
      pinnedViews.push(pinObj);
      if (typeof renderPinnedCards === "function") renderPinnedCards();
      if (typeof updatePinBadge === "function") updatePinBadge();
      if (typeof savePinnedData === "function") savePinnedData();
    }
  };
  window.onOverviewSegmentChanged = function() {
    rebuildCombinedChart();
  };
  document.addEventListener("DOMContentLoaded", function() {
    document.addEventListener("mouseover", function(e) {
      if (e.target.classList && e.target.classList.contains("tk-chart-point")) {
        var segment = e.target.getAttribute("data-segment");
        var wave = e.target.getAttribute("data-wave");
        var value = e.target.getAttribute("data-value");
        e.target.setAttribute("title", segment + " | " + wave + ": " + value);
      }
    });
  });
})();
(function() {
  "use strict";
  window.exportCSV = function() {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var rows = [];
    var headerRows = table.querySelectorAll("thead tr");
    headerRows.forEach(function(tr) {
      var cells = [];
      tr.querySelectorAll("th").forEach(function(th) {
        if (th.classList.contains("segment-hidden")) return;
        var colspan = parseInt(th.getAttribute("colspan") || "1", 10);
        var text = th.textContent.trim();
        cells.push(csvEscape(text));
        for (var c = 1; c < colspan; c++) {
          cells.push("");
        }
      });
      rows.push(cells.join(","));
    });
    var bodyRows = table.querySelectorAll("tbody tr");
    bodyRows.forEach(function(tr) {
      if (tr.classList.contains("tk-change-row") && !tr.classList.contains("visible")) return;
      if (tr.classList.contains("row-hidden-user")) return;
      if (tr.classList.contains("row-filtered")) return;
      if (tr.classList.contains("section-hidden")) return;
      if (tr.style.display === "none") return;
      if (tr.classList.contains("tk-section-row")) {
        if (tr.classList.contains("section-collapsed")) return;
        var secText = tr.querySelector("td").textContent.trim();
        rows.push(csvEscape(secText));
        return;
      }
      var cells = [];
      tr.querySelectorAll("td").forEach(function(td) {
        if (td.classList.contains("segment-hidden")) return;
        var text = "";
        var label = td.querySelector(".tk-metric-label");
        if (label) {
          text = label.textContent.trim();
        } else {
          text = td.textContent.trim();
        }
        cells.push(csvEscape(text));
      });
      rows.push(cells.join(","));
    });
    var csv = rows.join("\n");
    downloadBlob(csv, "tracking_crosstab.csv", "text/csv;charset=utf-8");
  };
  window.exportExcel = function() {
    var table = document.getElementById("tk-crosstab-table");
    if (!table) return;
    var xml = '<?xml version="1.0"?>\n';
    xml += '<?mso-application progid="Excel.Sheet"?>\n';
    xml += '<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n';
    xml += ' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">\n';
    xml += '<Styles>\n';
    xml += '<Style ss:ID="Default"><Font ss:FontName="Calibri" ss:Size="11"/></Style>\n';
    xml += '<Style ss:ID="Header"><Font ss:FontName="Calibri" ss:Size="11" ss:Bold="1"/><Interior ss:Color="#D9E2F3" ss:Pattern="Solid"/></Style>\n';
    xml += '<Style ss:ID="Section"><Font ss:FontName="Calibri" ss:Size="11" ss:Bold="1"/><Interior ss:Color="#E2EFDA" ss:Pattern="Solid"/></Style>\n';
    xml += '<Style ss:ID="Change"><Font ss:FontName="Calibri" ss:Size="10" ss:Color="#666666"/><Interior ss:Color="#F5F5F5" ss:Pattern="Solid"/></Style>\n';
    xml += '<Style ss:ID="SigUp"><Font ss:FontName="Calibri" ss:Size="10" ss:Color="#008000" ss:Bold="1"/><Interior ss:Color="#F5F5F5" ss:Pattern="Solid"/></Style>\n';
    xml += '<Style ss:ID="SigDown"><Font ss:FontName="Calibri" ss:Size="10" ss:Color="#C00000" ss:Bold="1"/><Interior ss:Color="#F5F5F5" ss:Pattern="Solid"/></Style>\n';
    xml += '</Styles>\n';
    xml += '<Worksheet ss:Name="Tracking Crosstab">\n<Table>\n';
    var headerRows = table.querySelectorAll("thead tr");
    headerRows.forEach(function(tr) {
      xml += '<Row>\n';
      tr.querySelectorAll("th").forEach(function(th) {
        if (th.classList.contains("segment-hidden")) return;
        var colspan = th.getAttribute("colspan");
        var text = th.textContent.trim();
        var mergeAttr = colspan && parseInt(colspan) > 1 ? ' ss:MergeAcross="' + (parseInt(colspan) - 1) + '"' : '';
        xml += '<Cell ss:StyleID="Header"' + mergeAttr + '><Data ss:Type="String">' + xmlEscape(text) + '</Data></Cell>\n';
      });
      xml += '</Row>\n';
    });
    var bodyRows = table.querySelectorAll("tbody tr");
    bodyRows.forEach(function(tr) {
      if (tr.classList.contains("tk-change-row") && !tr.classList.contains("visible")) return;
      if (tr.classList.contains("row-hidden-user")) return;
      if (tr.classList.contains("row-filtered")) return;
      if (tr.classList.contains("section-hidden")) return;
      if (tr.style.display === "none") return;
      if (tr.classList.contains("tk-section-row") && tr.classList.contains("section-collapsed")) return;
      xml += '<Row>\n';
      if (tr.classList.contains("tk-section-row")) {
        var secText = tr.querySelector("td").textContent.trim();
        var totalCols = tr.querySelector("td").getAttribute("colspan") || "1";
        xml += '<Cell ss:StyleID="Section" ss:MergeAcross="' + (parseInt(totalCols) - 1) + '"><Data ss:Type="String">' + xmlEscape(secText) + '</Data></Cell>\n';
      } else {
        var isChange = tr.classList.contains("tk-change-row");
        tr.querySelectorAll("td").forEach(function(td) {
          if (td.classList.contains("segment-hidden")) return;
          var text = "";
          var label = td.querySelector(".tk-metric-label");
          if (label) {
            text = label.textContent.trim();
          } else {
            text = td.textContent.trim();
          }
          var style = "Default";
          if (isChange) {
            var sigUp = td.querySelector(".sig-up");
            var sigDown = td.querySelector(".sig-down");
            if (sigUp) style = "SigUp";
            else if (sigDown) style = "SigDown";
            else style = "Change";
          }
          var numVal = parseFloat(text.replace(/[+%pp<e2><86><91><e2><86><93><e2><86><92>]/g, "").trim());
          if (!isNaN(numVal) && text.match(/^[+\-]?\d/)) {
            xml += '<Cell ss:StyleID="' + style + '"><Data ss:Type="String">' + xmlEscape(text) + '</Data></Cell>\n';
          } else {
            xml += '<Cell ss:StyleID="' + style + '"><Data ss:Type="String">' + xmlEscape(text) + '</Data></Cell>\n';
          }
        });
      }
      xml += '</Row>\n';
    });
    xml += '</Table>\n</Worksheet>\n</Workbook>';
    downloadBlob(xml, "tracking_crosstab.xls", "application/vnd.ms-excel");
  };
  function csvEscape(text) {
    if (!text) return "";
    text = text.replace(/"/g, '""');
    if (text.indexOf(",") !== -1 || text.indexOf('"') !== -1 || text.indexOf("\n") !== -1) {
      text = '"' + text + '"';
    }
    return text;
  }
  function xmlEscape(text) {
    if (!text) return "";
    return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
  }
  function downloadBlob(content, filename, mimeType) {
    var blob = new Blob([content], { type: mimeType });
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
  window.csvEscape = csvEscape;
  window.xmlEscape = xmlEscape;
  window.downloadBlob = downloadBlob;
})();
(function() {
  "use strict";
  window.exportSlidePNG = function(metricId, mode) {
    mode = mode || "chart";
    var container = document.querySelector('.tk-chart-container[data-metric-id="' + metricId + '"]');
    if (!container) {
      var mvPanel = document.getElementById("mv-" + metricId);
      if (mvPanel) {
        container = mvPanel.querySelector(".mv-chart-area");
      }
    }
    if (!container && mode !== "table") return;
    var metricRow = document.querySelector('#tk-crosstab-table .tk-metric-row[data-metric-id="' + metricId + '"]');
    if (!metricRow) {
      metricRow = document.querySelector('.tk-metric-row[data-metric-id="' + metricId + '"]');
    }
    var title = "Metric";
    if (metricRow) {
      var labelEl = metricRow.querySelector(".tk-metric-label");
      if (labelEl) title = labelEl.textContent;
    }
    if (title === "Metric") {
      var mvPanel = document.getElementById("mv-" + metricId);
      if (mvPanel) {
        var mvTitle = mvPanel.querySelector(".mv-metric-title");
        if (mvTitle) title = mvTitle.textContent.trim();
      }
    }
    var slideW = 1280;
    var slideH = 720;
    var scale = 3;
    var canvas = document.createElement("canvas");
    canvas.width = slideW * scale;
    canvas.height = slideH * scale;
    var ctx = canvas.getContext("2d");
    ctx.scale(scale, scale);
    ctx.fillStyle = "#ffffff";
    ctx.fillRect(0, 0, slideW, slideH);
    var brandColour = getComputedStyle(document.documentElement).getPropertyValue("--brand").trim() || "#323367";
    ctx.fillStyle = brandColour;
    ctx.fillRect(0, 0, slideW, 60);
    ctx.fillStyle = "#ffffff";
    ctx.font = "bold 22px -apple-system, sans-serif";
    ctx.fillText(title, 30, 40);
    ctx.font = "14px -apple-system, sans-serif";
    ctx.fillStyle = "rgba(255,255,255,0.8)";
    ctx.fillText("Tracking Report", slideW - 200, 40);
    if (mode === "chart" || mode === "chart_table") {
      var svg = container ? container.querySelector(".tk-line-chart") : null;
      if (svg) {
        var svgData = new XMLSerializer().serializeToString(svg);
        var svgBlob = new Blob([svgData], { type: "image/svg+xml;charset=utf-8" });
        var svgUrl = URL.createObjectURL(svgBlob);
        var img = new Image();
        img.onload = function() {
          var chartY = mode === "chart_table" ? 80 : 80;
          var chartH = mode === "chart_table" ? 300 : 580;
          var aspectRatio = img.width / img.height;
          var drawW = Math.min(slideW - 60, chartH * aspectRatio);
          var drawH = drawW / aspectRatio;
          ctx.drawImage(img, 30, chartY, drawW, drawH);
          if (mode === "chart_table") {
            drawTableOnCanvas(ctx, metricId, metricRow, 30, 400, slideW - 60, 280);
          }
          downloadCanvas(canvas, "slide_" + metricId + ".png");
          URL.revokeObjectURL(svgUrl);
        };
        img.src = svgUrl;
      }
    } else if (mode === "table") {
      drawTableOnCanvas(ctx, metricId, metricRow, 30, 80, slideW - 60, 580);
      downloadCanvas(canvas, "slide_" + metricId + "_table.png");
    }
  };
  function drawTableOnCanvas(ctx, metricId, metricRow, x, y, w, h) {
    var panel = document.getElementById("mv-" + metricId);
    var domTable = panel ? panel.querySelector(".mv-metric-table") : null;
    if (domTable) {
      drawTableFromDOM(ctx, domTable, metricId, x, y, w, h);
      return;
    }
    var chartAttr = metricRow ? metricRow.getAttribute("data-chart") : null;
    if (!chartAttr) {
      drawPlaceholder(ctx, x, y, w, h, "No data available for this metric");
      return;
    }
    var chartData;
    try { chartData = JSON.parse(chartAttr); } catch (e) {
      drawPlaceholder(ctx, x, y, w, h, "Unable to parse metric data");
      return;
    }
    if (!chartData || !chartData.series || !chartData.wave_labels) {
      drawPlaceholder(ctx, x, y, w, h, "Incomplete metric data");
      return;
    }
    drawTableFromJSON(ctx, chartData, x, y, w, h);
  }
  function drawTableFromDOM(ctx, domTable, metricId, x, y, w, h) {
    var waveLabels = [];
    var headerRow = domTable.querySelector("thead tr.tk-wave-header-row");
    if (headerRow) {
      headerRow.querySelectorAll("th").forEach(function(th) {
        if (th.classList.contains("segment-hidden")) return;
        if (th.classList.contains("wave-hidden")) return;
        if (th.style.display === "none") return;
        waveLabels.push(th.textContent.trim());
      });
    }
    var labelHeader = waveLabels.length > 0 ? waveLabels.shift() : "Segment";
    var nWaves = waveLabels.length;
    if (nWaves === 0) {
      drawPlaceholder(ctx, x, y, w, h, "No visible wave columns");
      return;
    }
    var visibleRows = [];
    domTable.querySelectorAll("tbody tr").forEach(function(tr) {
      if (tr.classList.contains("segment-hidden")) return;
      if (tr.style.display === "none") return;
      if (tr.classList.contains("tk-change-row") && !tr.classList.contains("visible")) return;
      var rowInfo = { label: "", values: [], colour: null, isBase: false, isChange: false, isTotal: false };
      if (tr.classList.contains("tk-base-row")) {
        rowInfo.isBase = true;
        var baseLabelEl = tr.querySelector(".tk-base-label");
        rowInfo.label = baseLabelEl ? baseLabelEl.textContent.trim() : "Base (n=)";
        tr.querySelectorAll("td.tk-base-cell").forEach(function(td) {
          if (td.classList.contains("segment-hidden")) return;
          if (td.classList.contains("wave-hidden")) return;
          if (td.style.display === "none") return;
          rowInfo.values.push(td.textContent.trim());
        });
        visibleRows.push(rowInfo);
        return;
      }
      if (tr.classList.contains("tk-change-row")) {
        rowInfo.isChange = true;
        var changeLabelEl = tr.querySelector(".tk-change-label");
        rowInfo.label = changeLabelEl ? changeLabelEl.textContent.trim() : "Change";
        tr.querySelectorAll("td.tk-change-cell").forEach(function(td) {
          if (td.classList.contains("segment-hidden")) return;
          if (td.classList.contains("wave-hidden")) return;
          if (td.style.display === "none") return;
          rowInfo.values.push(td.textContent.trim());
        });
        visibleRows.push(rowInfo);
        return;
      }
      if (tr.classList.contains("tk-metric-row")) {
        var segName = tr.getAttribute("data-segment") || "";
        var labelEl = tr.querySelector(".tk-metric-label");
        rowInfo.label = labelEl ? labelEl.textContent.trim() : segName;
        rowInfo.isTotal = segName === "Total";
        var dot = tr.querySelector(".tk-seg-dot");
        if (dot) {
          rowInfo.colour = dot.style.background || dot.style.backgroundColor || null;
        }
        tr.querySelectorAll("td.tk-value-cell").forEach(function(td) {
          if (td.classList.contains("segment-hidden")) return;
          if (td.classList.contains("wave-hidden")) return;
          if (td.style.display === "none") return;
          var valSpan = td.querySelector(".tk-val");
          rowInfo.values.push(valSpan ? valSpan.textContent.trim() : td.textContent.trim());
        });
        visibleRows.push(rowInfo);
      }
    });
    if (visibleRows.length === 0) {
      drawPlaceholder(ctx, x, y, w, h, "No visible data rows");
      return;
    }
    var COLOURS = [
      "#323367", "#CC9900", "#2E8B57", "#CD5C5C", "#4682B4",
      "#9370DB", "#D2691E", "#20B2AA", "#8B4513", "#6A5ACD"
    ];
    var rowH = 26;
    var headerH = 32;
    var labelColW = Math.min(260, w * 0.28);
    var dataColW = (w - labelColW) / nWaves;
    var maxRows = Math.floor((h - headerH) / rowH);
    var displayRows = visibleRows.slice(0, maxRows);
    ctx.fillStyle = "#fafafa";
    ctx.fillRect(x, y, w, h);
    ctx.fillStyle = "#f0f0f5";
    ctx.fillRect(x, y, w, headerH);
    ctx.fillStyle = "#555";
    ctx.font = "bold 12px -apple-system, sans-serif";
    ctx.textAlign = "left";
    ctx.fillText(labelHeader, x + 10, y + 20);
    ctx.textAlign = "center";
    for (var wi = 0; wi < nWaves; wi++) {
      var colX = x + labelColW + wi * dataColW + dataColW / 2;
      ctx.fillText(waveLabels[wi], colX, y + 20);
    }
    ctx.strokeStyle = "#ccc";
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(x, y + headerH);
    ctx.lineTo(x + w, y + headerH);
    ctx.stroke();
    var colourIdx = 0;
    for (var ri = 0; ri < displayRows.length; ri++) {
      var row = displayRows[ri];
      var rowY = y + headerH + ri * rowH;
      if (row.isBase) {
        ctx.fillStyle = "#f8f9fa";
      } else if (row.isChange) {
        ctx.fillStyle = "#fafafa";
      } else if (ri % 2 === 0) {
        ctx.fillStyle = "#ffffff";
      } else {
        ctx.fillStyle = "#f8f9fa";
      }
      ctx.fillRect(x, rowY, w, rowH);
      ctx.strokeStyle = "#eee";
      ctx.beginPath();
      ctx.moveTo(x, rowY + rowH);
      ctx.lineTo(x + w, rowY + rowH);
      ctx.stroke();
      if (!row.isBase && !row.isChange) {
        var dotColour = row.colour || COLOURS[colourIdx % COLOURS.length];
        ctx.fillStyle = dotColour;
        ctx.beginPath();
        ctx.arc(x + 14, rowY + rowH / 2, 4, 0, Math.PI * 2);
        ctx.fill();
        colourIdx++;
        ctx.fillStyle = "#333";
        ctx.font = row.isTotal ? "bold 12px -apple-system, sans-serif" : "12px -apple-system, sans-serif";
        ctx.textAlign = "left";
        ctx.fillText(row.label, x + 24, rowY + rowH / 2 + 4);
      } else {
        ctx.fillStyle = row.isBase ? "#666" : "#888";
        ctx.font = row.isBase ? "bold 11px -apple-system, sans-serif" : "11px -apple-system, sans-serif";
        ctx.textAlign = "left";
        ctx.fillText(row.label, x + 10, rowY + rowH / 2 + 4);
      }
      ctx.font = row.isChange ? "11px -apple-system, sans-serif" : "12px -apple-system, sans-serif";
      ctx.textAlign = "center";
      for (var vi = 0; vi < row.values.length && vi < nWaves; vi++) {
        var colCx = x + labelColW + vi * dataColW + dataColW / 2;
        var cellText = row.values[vi] || "\u2014";
        ctx.fillStyle = row.isChange ? "#888" : (row.isBase ? "#666" : "#222");
        ctx.fillText(cellText, colCx, rowY + rowH / 2 + 4);
      }
    }
    ctx.strokeStyle = "#ddd";
    ctx.lineWidth = 1;
    ctx.strokeRect(x, y, w, headerH + displayRows.length * rowH);
    ctx.textAlign = "left";
  }
  function drawTableFromJSON(ctx, chartData, x, y, w, h) {
    var waveLabels = chartData.wave_labels;
    var nWaves = waveLabels.length;
    var segmentNames = Object.keys(chartData.series);
    var isPct = chartData.is_percentage;
    var COLOURS = [
      "#323367", "#CC9900", "#2E8B57", "#CD5C5C", "#4682B4",
      "#9370DB", "#D2691E", "#20B2AA", "#8B4513", "#6A5ACD"
    ];
    var rowH = 26;
    var headerH = 32;
    var labelColW = Math.min(260, w * 0.28);
    var dataColW = (w - labelColW) / nWaves;
    var maxRows = Math.floor((h - headerH) / rowH);
    var visibleSegments = segmentNames.slice(0, maxRows);
    ctx.fillStyle = "#fafafa";
    ctx.fillRect(x, y, w, h);
    ctx.fillStyle = "#f0f0f5";
    ctx.fillRect(x, y, w, headerH);
    ctx.fillStyle = "#555";
    ctx.font = "bold 12px -apple-system, sans-serif";
    ctx.textAlign = "left";
    ctx.fillText("Segment", x + 10, y + 20);
    ctx.textAlign = "center";
    for (var wi = 0; wi < nWaves; wi++) {
      var colX = x + labelColW + wi * dataColW + dataColW / 2;
      ctx.fillText(String(waveLabels[wi]), colX, y + 20);
    }
    ctx.strokeStyle = "#ccc";
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(x, y + headerH);
    ctx.lineTo(x + w, y + headerH);
    ctx.stroke();
    ctx.textAlign = "left";
    for (var si = 0; si < visibleSegments.length; si++) {
      var segName = visibleSegments[si];
      var series = chartData.series[segName];
      if (!series) continue;
      var rowY = y + headerH + si * rowH;
      if (si % 2 === 0) {
        ctx.fillStyle = "#ffffff";
      } else {
        ctx.fillStyle = "#f8f9fa";
      }
      ctx.fillRect(x, rowY, w, rowH);
      ctx.strokeStyle = "#eee";
      ctx.beginPath();
      ctx.moveTo(x, rowY + rowH);
      ctx.lineTo(x + w, rowY + rowH);
      ctx.stroke();
      var dotColour = COLOURS[si % COLOURS.length];
      ctx.fillStyle = dotColour;
      ctx.beginPath();
      ctx.arc(x + 14, rowY + rowH / 2, 4, 0, Math.PI * 2);
      ctx.fill();
      var displayName = segName;
      var underscoreIdx = segName.indexOf("_");
      if (underscoreIdx > 0 && segName !== "Total") {
        displayName = segName.substring(underscoreIdx + 1);
      }
      ctx.fillStyle = "#333";
      ctx.font = segName === "Total" ? "bold 12px -apple-system, sans-serif" : "12px -apple-system, sans-serif";
      ctx.textAlign = "left";
      ctx.fillText(displayName, x + 24, rowY + rowH / 2 + 4);
      ctx.font = "12px -apple-system, sans-serif";
      ctx.textAlign = "center";
      for (var vi = 0; vi < nWaves; vi++) {
        var val = series.values[vi];
        var colCx = x + labelColW + vi * dataColW + dataColW / 2;
        if (val === null || val === undefined || isNaN(val)) {
          ctx.fillStyle = "#bbb";
          ctx.fillText("\u2014", colCx, rowY + rowH / 2 + 4);
        } else {
          ctx.fillStyle = "#222";
          var formatted;
          if (isPct) {
            formatted = Math.round(val) + "%";
          } else if (chartData.is_nps) {
            formatted = (val >= 0 ? "+" : "") + val.toFixed(1);
          } else {
            formatted = val.toFixed(2);
          }
          ctx.fillText(formatted, colCx, rowY + rowH / 2 + 4);
        }
      }
      if (series.n) {
        ctx.font = "9px -apple-system, sans-serif";
        ctx.fillStyle = "#999";
        for (var ni = 0; ni < nWaves; ni++) {
          var nVal = series.n[ni];
          if (nVal !== null && nVal !== undefined && !isNaN(nVal)) {
            var nColCx = x + labelColW + ni * dataColW + dataColW / 2;
            ctx.fillText("n=" + nVal, nColCx, rowY + rowH / 2 + 14);
          }
        }
      }
    }
    ctx.strokeStyle = "#ddd";
    ctx.lineWidth = 1;
    ctx.strokeRect(x, y, w, headerH + visibleSegments.length * rowH);
    ctx.textAlign = "left";
  }
  function drawPlaceholder(ctx, x, y, w, h, message) {
    ctx.fillStyle = "#f8f8f8";
    ctx.fillRect(x, y, w, h);
    ctx.strokeStyle = "#e0e0e0";
    ctx.lineWidth = 1;
    ctx.strokeRect(x, y, w, h);
    ctx.fillStyle = "#888";
    ctx.font = "14px -apple-system, sans-serif";
    ctx.textAlign = "center";
    ctx.fillText(message, x + w / 2, y + h / 2);
    ctx.textAlign = "left";
  }
  function downloadCanvas(canvas, filename) {
    canvas.toBlob(function(blob) {
      var url = URL.createObjectURL(blob);
      var a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }, "image/png");
  }
  window.printReport = function() {
    var changeRows = document.querySelectorAll(".tk-change-row");
    changeRows.forEach(function(r) { r.classList.add("visible"); });
    window.print();
  };
})();</script>
</body>
</html>
