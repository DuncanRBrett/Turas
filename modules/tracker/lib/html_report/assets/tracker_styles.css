/* === TURAS TRACKER HTML REPORT v2.1 === */
:root {
  --brand: BRAND_COLOUR;
  --accent: ACCENT_COLOUR;
  /* Shared Turas design tokens (aligned with Turas Tabs --ct-* prefix) */
  --ct-brand: BRAND_COLOUR;
  --ct-accent: ACCENT_COLOUR;
  --ct-text-primary: #1e293b;
  --ct-text-secondary: #64748b;
  --ct-bg-surface: #ffffff;
  --ct-bg-muted: #f8f9fa;
  --ct-border: #e2e8f0;
  /* Module variables */
  --bg: #f8f7f5;
  --card: #ffffff;
  --text: #1e293b;
  --text-muted: #64748b;
  --border: #e2e8f0;
  --section-bg: #f8f9fa;
  --change-bg: #fafafa;
  --sidebar-w: 280px;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: var(--text); font-size: 14px; line-height: 1.5; }

/* Header — dark gradient matching Turas Tabs */
.tk-header { background: linear-gradient(135deg, #1a2744 0%, #2a3f5f 100%); padding: 24px 32px; border-bottom: 3px solid var(--brand); color: #fff; }
.tk-header-inner { max-width: 1400px; margin: 0 auto; }
.tk-header-top { display: flex; align-items: center; justify-content: space-between; }
.tk-header-brand { display: flex; align-items: center; gap: 16px; }
.tk-header-logo-wrap { width: 72px; height: 72px; border-radius: 12px; background: transparent; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.tk-header-logo { height: 56px; width: 56px; object-fit: contain; }
.tk-brand-name { color: #fff; font-size: 28px; font-weight: 700; line-height: 1.2; letter-spacing: -0.3px; }
.tk-brand-subtitle { color: rgba(255,255,255,0.50); font-size: 12px; font-weight: 400; margin-top: 2px; }
.tk-help-btn { width: 28px; height: 28px; border-radius: 50%; border: 1.5px solid rgba(255,255,255,0.5); background: transparent; color: rgba(255,255,255,0.8); font-size: 14px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; }
.tk-help-btn:hover { border-color: #fff; color: #fff; }
.tk-header-project { color: #fff; font-size: 22px; font-weight: 700; letter-spacing: -0.3px; margin-top: 16px; line-height: 1.2; }
.tk-header-prepared { color: rgba(255,255,255,0.65); font-size: 13px; font-weight: 400; margin-top: 4px; }
.tk-header-prepared strong { font-weight: 600; }
.tk-badge-bar { display: inline-flex; align-items: center; margin-top: 12px; border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; background: rgba(255,255,255,0.05); }
.tk-badge-item { display: inline-flex; align-items: center; padding: 4px 12px; font-size: 12px; font-weight: 600; color: rgba(255,255,255,0.85); }
.tk-badge-item strong { color: #fff; font-weight: 700; margin-right: 4px; }
.tk-badge-sep { width: 1px; height: 16px; background: rgba(255,255,255,0.20); flex-shrink: 0; }

/* ---- REPORT TABS ---- */
.report-tabs { display: flex; align-items: center; gap: 0; background: var(--card); border-bottom: 2px solid var(--border); padding: 0 24px; }
.report-tab { padding: 12px 24px; border: none; background: transparent; color: var(--text); font-size: 14px; font-weight: 600; cursor: pointer; font-family: inherit; border-bottom: 3px solid transparent; transition: all 0.15s; }
.report-tab:hover:not(.active) { background: #f8f8f8; color: var(--brand); }
.report-tab.active { color: var(--brand); border-bottom-color: var(--brand); }
.pin-count-badge { display: inline-block; margin-left: 6px; padding: 1px 7px; border-radius: 10px; background: var(--brand); color: #fff; font-size: 11px; font-weight: 700; }
.tk-tab-actions { display: flex; gap: 8px; align-items: center; padding: 6px 0; }

/* ---- TAB PANELS ---- */
.tk-tab-panels { min-height: calc(100vh - 180px); }
.tab-panel { display: none; }
.tab-panel.active { display: block; }

/* ---- SUMMARY TAB ---- */
.summary-tab-content { max-width: 900px; margin: 0 auto; padding: 32px 24px; }
.summary-stats-row { display: flex; gap: 16px; margin-bottom: 32px; flex-wrap: wrap; }
.summary-stat-card { flex: 1; min-width: 140px; background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 20px 16px; text-align: center; }
.stat-number { font-size: 28px; font-weight: 700; color: var(--brand); }
.stat-label { font-size: 13px; color: var(--text-muted); margin-top: 4px; }
.summary-insight-box { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 20px 24px; margin-bottom: 20px; position: relative; }
.summary-insight-title { font-size: 16px; font-weight: 700; color: var(--brand); margin-bottom: 12px; }
.summary-editor { min-height: 80px; }
.summary-section-controls { float: right; display: flex; gap: 6px; }

/* Teal action buttons (Pin to Views, Export Slide) — consistent with Turas Tabs dashboard */
.turas-action-btn { display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px; font-size: 12px; font-weight: 600; color: var(--brand); background: rgba(13,138,138,0.06); border: 1px solid rgba(13,138,138,0.2); border-radius: 6px; cursor: pointer; transition: all 0.15s; font-family: inherit; white-space: nowrap; }
.turas-action-btn:hover { background: rgba(13,138,138,0.12); border-color: var(--brand); }

/* ---- METRICS BY SEGMENT TAB ---- */
.metrics-tab-layout { display: flex; min-height: calc(100vh - 180px); }
.mv-sidebar { width: var(--sidebar-w); flex-shrink: 0; padding: 16px 0 0 0; }
.mv-sidebar-inner { position: sticky; top: 20px; }
.mv-sidebar-search { padding: 0 14px 12px; }
.tk-search-input { width: 100%; padding: 10px 14px; border: 1px solid var(--border); border-radius: 6px; font-size: 13px; background: var(--card); outline: none; transition: border-color 0.15s; font-family: inherit; }
.tk-search-input:focus { border-color: var(--brand); }
.mv-sidebar-nav-wrap { background: var(--card); border-radius: 8px; border: 1px solid var(--border); overflow: hidden; }
.mv-sidebar-nav-header { padding: 10px 14px; border-bottom: 1px solid var(--border); font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
.mv-sidebar-nav-scroll { max-height: 500px; overflow-y: auto; }
.mv-sidebar-nav { padding: 0; }
.mv-nav-section { padding: 10px 14px 4px; font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
.tk-metric-nav-item { display: block; padding: 10px 14px; font-size: 12px; color: var(--text); text-decoration: none; cursor: pointer; border-left: 3px solid transparent; border-bottom: 1px solid var(--border); transition: all 0.15s ease; line-height: 1.35; }
.tk-metric-nav-item:last-child { border-bottom: none; }
.tk-metric-nav-item:hover { background: #f8fafc; }
.tk-metric-nav-item.active { border-left-color: var(--brand); background: #e6f5f5; font-weight: 600; color: #1a2744; }
/* Metric type filter */
.mv-type-filter { display: flex; gap: 4px; padding: 8px 12px; border-bottom: 1px solid var(--border); flex-wrap: wrap; }
.mv-type-chip { padding: 3px 10px; border: 1.5px solid var(--border); background: var(--card); border-radius: 12px; font-size: 11px; font-weight: 600; cursor: pointer; transition: all 0.15s; color: var(--text-muted); font-family: inherit; }
.mv-type-chip:hover { border-color: var(--brand); }
.mv-type-chip.active { border-color: var(--brand); color: var(--brand); background: #e6f5f5; }
.mv-global-controls { padding: 10px 16px; border-bottom: 1px solid var(--border); }
.mv-content { flex: 1; padding: 24px; overflow-x: auto; }

/* Metric panel */
.tk-metric-panel { display: none; }
.tk-metric-panel.active { display: block; }
.mv-metric-title { font-size: 16px; font-weight: 700; color: var(--text); margin-bottom: 4px; }
.mv-metric-subtitle { font-size: 13px; font-weight: 400; color: var(--text-muted); }

/* Segment chips */
.mv-segment-chips { display: flex; gap: 8px; margin: 16px 0 8px; flex-wrap: wrap; }
.tk-segment-chip { padding: 6px 16px; border: 2px solid var(--border); background: var(--card); border-radius: 20px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.15s; color: var(--text-muted); font-family: inherit; }
.tk-segment-chip.active { border-color: var(--chip-color, var(--brand)); color: var(--chip-color, var(--brand)); background: #f0fafa; }
.tk-segment-chip:hover { border-color: var(--chip-color, var(--brand)); }

/* Hierarchical segment groups */
.mv-segment-grouped { display: flex; gap: 12px; align-items: flex-start; flex-wrap: wrap; }
.mv-segment-group { display: flex; flex-direction: column; gap: 4px; }
.mv-segment-group-header { padding: 5px 14px; border: 2px solid var(--border); background: var(--ct-bg-muted); border-radius: 6px; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); cursor: pointer; transition: all 0.15s; font-family: inherit; }
.mv-segment-group-header:hover { border-color: var(--brand); color: var(--brand); }
.mv-segment-group-header.active { background: #e6f5f5; border-color: var(--brand); color: var(--brand); }
.mv-segment-group-header .chevron { display: inline-block; font-size: 9px; margin-left: 4px; transition: transform 0.15s; }
.mv-segment-group.expanded .mv-segment-group-header .chevron { transform: rotate(90deg); }
.mv-segment-group-chips { display: none; gap: 6px; flex-wrap: wrap; padding-left: 4px; }
.mv-segment-group.expanded .mv-segment-group-chips { display: flex; }

/* Wave chips */
.mv-wave-chips { display: flex; gap: 6px; margin: 0 0 12px; flex-wrap: wrap; align-items: center; }
.mv-wave-chips-label { font-size: 12px; font-weight: 600; color: var(--text-muted); margin-right: 4px; }
.tk-wave-chip { padding: 4px 12px; border: 1.5px solid var(--border); background: var(--card); border-radius: 14px; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.15s; color: var(--text-muted); font-family: inherit; }
.tk-wave-chip.active { border-color: #4682B4; color: #4682B4; background: #f0f6ff; font-weight: 600; }
.tk-wave-chip:not(.active) { opacity: 0.5; background: #f0f0f0; text-decoration: line-through; }
.tk-wave-chip:hover { border-color: #4682B4; }

/* Metric controls */
.mv-controls { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; margin-bottom: 16px; }
.mv-control-group { display: flex; align-items: center; gap: 8px; }
.mv-pin-btn { margin-left: auto; }
.mv-pin-btn.pinned { background: var(--brand); color: #fff; border-color: var(--brand); }

/* Metric table area */
.mv-table-area { margin-bottom: 16px; }
.mv-chart-area { margin-top: 12px; margin-bottom: 16px; }

/* ---- SEGMENT OVERVIEW TAB ---- */
.tk-layout { display: flex; min-height: calc(100vh - 180px); }
.tk-sidebar { width: var(--sidebar-w); flex-shrink: 0; padding: 16px 0 0 14px; }
.tk-sidebar-inner { position: sticky; top: 20px; }
.tk-sidebar-nav-card { background: var(--card); border-radius: 8px; border: 1px solid var(--border); overflow: hidden; }
.tk-sidebar-nav-scroll { max-height: 500px; overflow-y: auto; }
.tk-sidebar-nav { padding: 0; }
.tk-sidebar-section { padding: 10px 14px 4px; font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; cursor: pointer; transition: color 0.15s ease; }
.tk-sidebar-section:hover { color: var(--brand); }
.tk-sidebar-section.active { color: var(--brand); }
.tk-sidebar-item { display: block; padding: 10px 14px; font-size: 12px; color: var(--text); text-decoration: none; cursor: pointer; border-left: 3px solid transparent; border-bottom: 1px solid var(--border); transition: all 0.15s ease; }
.tk-sidebar-item:last-child { border-bottom: none; }
.tk-sidebar-item:hover { background: #f8fafc; }
.tk-sidebar-item.active { border-left-color: var(--brand); background: #e6f5f5; font-weight: 600; color: #1a2744; }
.tk-sidebar-item.hidden { display: none; }
.tk-content { flex: 1; padding: 20px 24px; overflow-x: auto; }

/* Segment selector dropdown (retained for possible future use) */
.tk-segment-selector { display: none; }

/* Segment header row removed from HTML (single-row header used instead) */

/* Segment sidebar items */
.tk-seg-sidebar-item { display: flex; align-items: center; gap: 8px; }
/* Overview actions bar (pin + export + insight) */
.overview-actions-bar { display: flex; gap: 8px; margin-bottom: 12px; padding: 10px 0; }
.tk-sidebar-header { padding: 10px 14px; font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid var(--border); }

/* Summary metrics table */
.summary-metrics-table-wrap { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 24px; margin-bottom: 20px; overflow-x: auto; }
.summary-metrics-table { font-size: 13px; color: #1e293b; }
.summary-metrics-table .tk-section-cell { font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: #888; padding: 12px 16px 4px; border: none; background: none; }
.summary-type-filter { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 12px; }
.summary-type-chip { padding: 5px 14px; border-radius: 16px; border: 1px solid var(--border); background: var(--card); font-size: 12px; cursor: pointer; color: var(--text-muted); transition: all 0.15s; }
.summary-type-chip:hover { border-color: var(--brand); color: var(--brand); }
.summary-type-chip.active { background: var(--brand); color: #fff; border-color: var(--brand); }
.summary-actions { display: flex; gap: 8px; margin-bottom: 12px; }

/* Controls */
.tk-controls { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; margin-bottom: 16px; padding: 10px 16px; background: var(--card); border-radius: 8px; border: 1px solid var(--border); }
.tk-control-group { display: flex; align-items: center; gap: 8px; }
.tk-control-label { font-size: 12px; color: var(--text-muted); font-weight: 600; }
.tk-toggle { display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 12px; color: var(--text-muted); }
.tk-toggle input[type="checkbox"] { width: 16px; height: 16px; accent-color: var(--brand); }
.tk-toggle-label { user-select: none; }
.tk-btn { padding: 6px 14px; border: 1px solid var(--border); background: var(--card); border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.15s; font-family: inherit; }
.tk-btn:hover { background: #f0f0f0; }
.tk-btn-view { border-radius: 0; }
.tk-btn-view:first-child { border-radius: 6px 0 0 6px; }
.tk-btn-view:last-child { border-radius: 0 6px 6px 0; }
.tk-btn-active { background: var(--brand); color: #fff; border-color: var(--brand); }
.tk-btn-sm { padding: 4px 10px; font-size: 11px; }
.tk-btn-export { background: #f8f8f8; }
.tk-select { padding: 6px 10px; border: 1px solid var(--border); border-radius: 6px; font-size: 12px; background: var(--card); }
.tk-export-group { margin-left: auto; }

/* Export button (shared Turas design — matches Turas Tabs .export-btn) */
.export-btn { display: inline-flex; align-items: center; gap: 4px; padding: 6px 14px; border: 1px solid var(--border); border-radius: 4px; background: #ffffff; color: var(--text-muted); font-size: 11px; font-weight: 600; cursor: pointer; font-family: inherit; transition: all 0.15s; white-space: nowrap; }
.export-btn:hover { background: #f8fafc; color: var(--text); }

/* Header action buttons (dark background variant) */
.tk-header-actions { display: flex; align-items: center; gap: 8px; }
.tk-header .export-btn { border-color: rgba(255,255,255,0.3); color: rgba(255,255,255,0.85); background: rgba(255,255,255,0.08); }
.tk-header .export-btn:hover { border-color: rgba(255,255,255,0.6); color: #fff; background: rgba(255,255,255,0.15); }

/* Low base warning */
.tk-low-base { color: #dc2626; font-weight: 700; }
.tk-low-base-dim { opacity: 0.45; }

/* Segment showing label */
.tk-segment-showing { font-size: 14px; color: var(--text); margin-bottom: 8px; padding: 4px 0; }
.tk-segment-showing strong { color: var(--brand); }

/* Segment indicator row (coloured bar with segment name label) */
.tk-segment-indicator-row { }
.tk-segment-indicator { padding: 4px 8px; border: none; }

/* ---- TABLE STYLES ---- */
.tk-table-wrapper { overflow-x: auto; border-radius: 8px; border: 1px solid var(--border); background: var(--card); }
.tk-table { width: 100%; border-collapse: collapse; color: #1e293b; font-size: 13px; }
.tk-table td, .tk-table th { color: #1e293b; }
.tk-th { padding: 8px 10px; text-align: center; font-size: 11px; font-weight: 600; color: #64748b; border-bottom: 2px solid var(--border); white-space: nowrap; background: var(--ct-bg-muted); }
.tk-td { padding: 6px 10px; text-align: center; border-bottom: 1px solid #f0f0f0; font-size: 13px; color: #1e293b; }
.tk-label-col { text-align: left; min-width: 180px; max-width: 320px; }
.tk-sticky-col { position: sticky; left: 0; z-index: 2; background: var(--card); }
.tk-segment-header { font-size: 12px; letter-spacing: 0.3px; }
.tk-wave-header { font-size: 12px; color: #64748b; background: var(--ct-bg-muted); }
.tk-value-cell { font-variant-numeric: tabular-nums; color: #1e293b; font-size: 13px; }
.tk-val { font-variant-numeric: tabular-nums; color: #1e293b; font-size: 13px; }

/* Section rows (collapsible) */
.tk-section-row { background: none; }
.tk-section-cell { padding: 14px 16px 8px; font-size: 13px; font-weight: 700; color: var(--brand); text-transform: uppercase; letter-spacing: 0.5px; background: var(--section-bg); border-bottom: 2px solid var(--border); cursor: pointer; user-select: none; }
.tk-section-cell:hover { background: #eef0f2; }
.section-chevron { display: inline-block; font-size: 10px; transition: transform 0.15s; margin-right: 4px; }
.section-collapsed .section-chevron { transform: rotate(-90deg); }
tr.section-hidden { display: none !important; }

/* Metric rows */
.tk-metric-row { transition: background 0.15s; }
.tk-metric-row:hover { background: #f8fafa; }
.tk-metric-label { font-weight: 600; margin-right: 8px; }
.tk-sparkline-wrap { display: inline-block; vertical-align: middle; margin-left: 4px; }

/* Change rows */
.tk-change-row { display: none; background: var(--change-bg); }
.tk-change-row.visible { display: table-row; }
.tk-change-label { font-size: 11px; color: var(--text-muted); font-style: italic; padding-left: 24px; }
.tk-change-cell { font-size: 12px; }

/* Significance styling */
.change-val { font-size: 12px; white-space: nowrap; }
.sig-up { color: #1a7a3a; font-weight: 600; }
.sig-down { color: #c0392b; font-weight: 600; }
.not-sig { color: #888; }
.sig-flat { color: #888; }
.sig-na { color: #bbb; }

/* Significance toggle */
body.hide-significance .sig-up { color: inherit; font-weight: normal; }
body.hide-significance .sig-down { color: inherit; font-weight: normal; }
body.hide-significance .sig-arrow { display: none; }

/* Base row */
.tk-base-row { border-top: 2px solid var(--border); }
.tk-base-label { font-size: 11px; color: var(--text-muted); font-weight: 600; }
.tk-base-cell { font-size: 11px; color: var(--text-muted); }

/* n= frequency count (hidden by default, toggled) */
.tk-freq { display: none; font-size: 10px; color: #94a3b8; margin-top: 1px; }
.show-freq .tk-freq { display: block; }

/* Segment colour dot */
.tk-seg-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 6px; vertical-align: middle; }

/* Sortable column headers */
.tk-sortable { cursor: pointer; user-select: none; }
.tk-sortable:hover { background: #f0fafa; }
.tk-sortable.sort-asc::after { content: " \25B2"; font-size: 9px; color: var(--brand); }
.tk-sortable.sort-desc::after { content: " \25BC"; font-size: 9px; color: var(--brand); }

/* Wave column hide */
.wave-hidden { display: none !important; }

/* Sparklines */
.tk-sparkline { vertical-align: middle; }
body.hide-sparklines .tk-sparkline-wrap { display: none; }

/* Charts — additive selection */
.tk-chart-panel { padding: 16px 0; }
.tk-chart-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; padding: 8px 0; }
.tk-chart-count { font-size: 14px; font-weight: 600; color: var(--text); }
.tk-chart-header-actions { display: flex; gap: 8px; }
.tk-chart-container { margin-bottom: 32px; padding: 20px; background: var(--card); border-radius: 8px; border: 1px solid var(--border); }
.tk-chart-title { font-size: 15px; font-weight: 600; margin-bottom: 12px; color: var(--text); display: flex; align-items: center; gap: 8px; }
.tk-chart-remove-btn { background: none; border: 1px solid var(--border); border-radius: 50%; width: 22px; height: 22px; font-size: 14px; cursor: pointer; color: var(--text-muted); line-height: 1; }
.tk-chart-remove-btn:hover { background: #fee; color: #dc2626; border-color: #dc2626; }
.tk-chart-actions { margin-top: 12px; text-align: right; }
.tk-line-chart { max-width: 100%; height: auto; }
.tk-chart-point { cursor: pointer; }
.tk-add-chart-btn { background: none; border: 1px solid var(--border); border-radius: 4px; padding: 2px 6px; font-size: 11px; cursor: pointer; color: var(--text-muted); margin-left: 6px; transition: all 0.15s; }
.tk-add-chart-btn:hover { border-color: var(--brand); color: var(--brand); }
.tk-add-chart-btn.in-chart { background: var(--brand); color: #fff; border-color: var(--brand); }

/* Row filtered (type/text filter) */
.row-filtered { display: none !important; }

/* Latest wave highlight */
.tk-latest-wave { background: rgba(30,41,59,0.03); }

/* Sticky table headers */
.tk-table thead { position: sticky; top: 0; z-index: 10; }
.tk-table thead th { background: var(--card); }

/* Overview search input */
.tk-overview-search { width: 140px; padding: 5px 10px; border: 1px solid var(--border); border-radius: 6px; font-size: 12px; font-family: inherit; }
.tk-overview-type-filter { display: flex; gap: 4px; }

/* Segment column visibility */
.segment-hidden { display: none !important; }

/* Selected segment chip (for chart label focus) */
.tk-segment-chip.selected { box-shadow: 0 0 0 2px var(--chip-color, var(--brand)); }

/* Row hide eye icon (grey out instead of hide — click again to restore) */
.tk-row-hide-btn { background: none; border: none; cursor: pointer; font-size: 14px; padding: 0 4px; opacity: 0.3; transition: opacity 0.15s; line-height: 1; }
.tk-row-hide-btn:hover { opacity: 1; }
.tk-row-hide-btn.row-greyed { opacity: 1; color: #c0392b; }
.tk-metric-row.row-hidden-user { opacity: 0.25; }
.tk-metric-row.row-hidden-user td { background: #f5f5f5 !important; }
.tk-change-row.row-hidden-user { opacity: 0.25; }
.tk-change-row.row-hidden-user td { background: #f5f5f5 !important; }

/* Pinned toolbar */
.pinned-toolbar { display: flex; gap: 8px; padding: 16px 0; margin-bottom: 16px; border-bottom: 1px solid var(--border); flex-wrap: wrap; }
.pinned-toolbar .tk-btn { font-size: 13px; padding: 8px 16px; }

/* ---- INSIGHT STYLES ---- */
.insight-area { margin-top: 16px; }
.insight-toggle { padding: 6px 14px; border: 1px dashed #cbd5e1; border-radius: 6px; background: transparent; color: #94a3b8; font-size: 12px; font-weight: 500; cursor: pointer; width: 100%; text-align: left; font-family: inherit; }
.insight-toggle:hover { border-color: var(--brand); color: var(--brand); }
.insight-container { border: 1px solid var(--border); border-radius: 8px; background: #f8fafa; padding: 12px 16px; position: relative; }
.insight-editor { border-left: 3px solid var(--brand); background: #fefefe; padding: 12px 16px; font-size: 13px; line-height: 1.6; border-radius: 0 6px 6px 0; min-height: 50px; outline: none; color: var(--text); }
.insight-editor:empty::before { content: attr(data-placeholder); color: #aab; font-style: italic; }
.insight-dismiss { position: absolute; top: 8px; right: 8px; background: none; border: none; font-size: 20px; cursor: pointer; color: var(--text-muted); line-height: 1; }
.insight-dismiss:hover { color: #c0392b; }

/* ---- SECTION DIVIDERS (Pinned Views) ---- */
.section-divider { display: flex; align-items: center; gap: 12px; padding: 12px 0; margin: 8px 0; border-bottom: 2px solid var(--brand); }
.section-divider-title { font-size: 16px; font-weight: 600; color: var(--brand); flex: 1; outline: none; min-width: 100px; }
.section-divider-title:focus { border-bottom: 1px dashed var(--border); }
.section-divider-actions { display: flex; gap: 4px; }

/* ---- PINNED VIEWS ---- */
.pinned-tab-content { padding: 24px; max-width: 1000px; margin: 0 auto; }
.pinned-empty-state { text-align: center; padding: 60px 20px; color: var(--text-muted); font-size: 15px; }
.pinned-card { background: var(--card); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 20px; overflow: hidden; }
.pinned-card-header { display: flex; justify-content: space-between; align-items: center; padding: 14px 20px; border-bottom: 1px solid var(--border); background: var(--ct-bg-muted); }
.pinned-card-title { font-size: 15px; font-weight: 700; color: var(--text); margin: 0; }
.pinned-card-actions { display: flex; gap: 6px; }
.pinned-card-chart { padding: 16px 20px; border-bottom: 1px solid var(--border); text-align: center; }
.pinned-card-chart svg { max-width: 100%; height: auto; }
.pinned-card-body { padding: 24px 28px; overflow-x: auto; }
.pinned-card-body .tk-table-wrapper { border: none; margin: 8px 0; }
.pinned-card-png { max-width: 100%; height: auto; border-radius: 4px; }
.pinned-card-insight { padding: 12px 20px; border-bottom: 1px solid var(--border); background: #f8fafa; border-left: 3px solid var(--brand); font-size: 13px; color: var(--text); }
.pinned-card-insight-area { padding: 8px 20px; border-bottom: 1px solid var(--border); }
.pinned-card-insight-editor { border-left: 3px solid var(--brand); background: #fefefe; padding: 8px 12px; font-size: 13px; line-height: 1.6; border-radius: 0 6px 6px 0; min-height: 36px; outline: none; color: var(--text); }
.pinned-card-insight-editor:empty::before { content: attr(data-placeholder); color: #aab; font-style: italic; }
.pinned-insight-toggle { padding: 4px 10px; border: 1px dashed #cbd5e1; border-radius: 4px; background: transparent; color: #94a3b8; font-size: 11px; cursor: pointer; width: 100%; text-align: left; font-family: inherit; }
.pinned-insight-toggle:hover { border-color: var(--brand); color: var(--brand); }
.pinned-card-meta { padding: 8px 20px; font-size: 11px; color: var(--text-muted); border-top: 1px solid #f0f0f0; }

/* ---- HELP OVERLAY ---- */
.tk-help-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center; }
.tk-help-content { background: var(--card); border-radius: 12px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; padding: 32px; position: relative; }
.tk-help-close { position: absolute; top: 12px; right: 16px; background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-muted); }
.tk-help-body h3 { margin: 16px 0 6px; font-size: 14px; color: var(--brand); }
.tk-help-body p { color: var(--text-muted); font-size: 13px; }
.tk-help-body ul { margin-left: 20px; color: var(--text-muted); font-size: 13px; }

/* Footer */
.tk-footer { padding: 16px 24px; border-top: 1px solid var(--border); background: var(--card); display: flex; justify-content: space-between; font-size: 12px; color: var(--text-muted); }
.tk-footer-sep { margin: 0 6px; opacity: 0.4; }
.tk-footer-credit { font-style: italic; }

/* Print styles */
@media print {
  .tk-sidebar, .mv-sidebar, .tk-controls, .mv-controls, .tk-segment-tabs,
  .tk-chart-actions, .tk-help-overlay, .report-tabs, .mv-segment-chips,
  .insight-toggle, .insight-dismiss, .mv-pin-btn, .pinned-card-actions,
  .pinned-toolbar, .tk-segment-selector, .tk-row-hide-btn,
  .tk-tab-actions, .export-btn, .turas-action-btn { display: none !important; }
  .tk-layout, .metrics-tab-layout { display: block; }
  .tk-content, .mv-content { padding: 0; }
  .tk-table-wrapper { border: none; overflow: visible; }
  .tk-sticky-col { position: static; }
  .tk-change-row.visible { display: table-row !important; }
  .tab-panel { display: block !important; page-break-before: always; }
  .tab-panel:first-child { page-break-before: auto; }
  .tk-header { padding: 8px 16px; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  .tk-footer { position: fixed; bottom: 0; }
}

/* Print pinned views only (activated by JS class on body) */
@media print {
  body.print-pinned-only .tk-header, body.print-pinned-only .report-tabs,
  body.print-pinned-only .tab-panel:not(#tab-pinned),
  body.print-pinned-only .tk-footer { display: none !important; }
  body.print-pinned-only #tab-pinned { display: block !important; page-break-before: auto; }
  body.print-pinned-only .pinned-card { page-break-inside: avoid; margin-bottom: 24px; }
  body.print-pinned-only .pinned-card-chart svg { max-width: 100%; height: auto; }
}
